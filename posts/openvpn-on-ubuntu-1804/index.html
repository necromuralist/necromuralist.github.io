<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="How to set up OpenVPN on Ubuntu 18.04 using Network Settings.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>OpenVPN on Ubuntu 18.04 | The Cloistered Monkey</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://necromuralist.github.io/posts/openvpn-on-ubuntu-1804/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/latest.js?config=TeX-MML-AM_CHTML">
</script><meta name="author" content="Cloistered Monkey">
<link rel="prev" href="../tcpdump-on-an-external-hard-drive/" title="TCPDump On an External Hard Drive" type="text/html">
<link rel="next" href="../the-linux-ipv6-router-advertisement-daemon-radvd/" title="The Linux IPv6 Router Advertisement Daemon (radvd)" type="text/html">
<meta property="og:site_name" content="The Cloistered Monkey">
<meta property="og:title" content="OpenVPN on Ubuntu 18.04">
<meta property="og:url" content="https://necromuralist.github.io/posts/openvpn-on-ubuntu-1804/">
<meta property="og:description" content="How to set up OpenVPN on Ubuntu 18.04 using Network Settings.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-07-10T18:11:39-07:00">
<meta property="article:tag" content="howto ubuntu">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-light bg-light
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="https://necromuralist.github.io/">

            <span id="blog-title">The Cloistered Monkey</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="../../categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="../../rss.xml" class="nav-link">RSS feed</a>
            </li>
<li class="nav-item dropdown">
<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Projects</a>
            <div class="dropdown-menu">
                    <a href="https://necromuralist.github.io/In-Too-Deep/" class="dropdown-item">In Too Deep (Neural Networks)</a>
                    <a href="../../machine-learning-projects/" class="dropdown-item">Machine Learning</a>
                    <a href="https://necromuralist.github.io/student_intervention/" class="dropdown-item">Student Intervention Project</a>
                    <a href="https://necromuralist.github.io/boston_housing/" class="dropdown-item">Boston Housing Project</a>
                    <a href="https://necromuralist.github.io/data_science/" class="dropdown-item">Data Science With Python</a>
            </div>

                
            </li>
</ul>
<!-- Google custom search --><form method="get" action="https://www.google.com/search" class="navbar-form navbar-right" role="search">
<div class="form-group">
<input type="text" name="q" class="form-control" placeholder="Search">
</div>
<!-- 
<button type="submit" class="btn btn-primary">
	<span class="glyphicon glyphicon-search"></span>
</button>
-->
<input type="hidden" name="sitesearch" value="https://necromuralist.github.io/">
</form>
<!-- End of custom search -->


            <ul class="navbar-nav navbar-right">
<li class="nav-item">
    <a href="index.org" id="sourcelink" class="nav-link">Source</a>
    </li>


                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">OpenVPN on Ubuntu 18.04</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    <a href="../../authors/cloistered-monkey/">Cloistered Monkey</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2018-07-10T18:11:39-07:00" itemprop="datePublished" title="2018-07-10 18:11">2018-07-10 18:11</time></a>
            </p>
            
        <p class="sourceline"><a href="index.org" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div id="outline-container-orgc512a18" class="outline-2">
<h2 id="orgc512a18">Introduction</h2>
<div class="outline-text-2" id="text-orgc512a18">
<p>
I'm connecting to a remote network using <a href="https://openvpn.net/">OpenVPN</a> served by an ASUS access point. I originally did it at the command line.
</p>

<pre class="example">
sudo openvpn --config client.ovpn
</pre>

<p>
It turns out that this doesn't allow me to access anything outside of the network that I was connecting to. From what I can tell it's a DNS problem, but nothing I found about fixing DNS problems with OpenVPN from the command line worked. Luckily the Network Settings GUI works, but even then, it didn't work out of the box.
</p>
</div>
</div>

<div id="outline-container-org2ebba23" class="outline-2">
<h2 id="org2ebba23">Initial Configuration</h2>
<div class="outline-text-2" id="text-org2ebba23">
<p>
First, not everything you need is installed. Besides the openvpn client itself (which I had installed before trying to run it at the command line) you need some things for the network settings as well.
</p>

<pre class="example">
apt install openvpn network-manager-openvpn network-manager-openvpn-gnome
</pre>

<p>
Now open the network settings.
</p>


<div class="figure">
<p><img src="network_settings_menu.png" alt=" network_settings_menu.png"></p>
</div>


<p>
In the window that pops up click on the + sign to add a connection.
</p>


<div class="figure">
<p><img src="network_settings.png" alt=" network_settings.png"></p>
</div>

<p>
In the window that then pops up click on <code>Import from file...</code> (I'm assuming you are using a config file).
</p>


<div class="figure">
<p><img src="import_from_file.png" alt=" import_from_file.png"></p>
</div>

<p>
Navigate to the config file, and double-click on it. In the dialog that pops up enter whatever extra information you need. In my case it was the username and password.
</p>


<div class="figure">
<p><img src="vpn_dialog.png" alt=" vpn_dialog.png"></p>
</div>

<p>
Click on the green 'Add' button and you should now have an entry for your VPN connection in the network settings. Click on the on switch (initially labeled 'Off') and if you're lucky it will connect.
</p>


<div class="figure">
<p><img src="start_vpn.png" alt=" start_vpn.png"></p>
</div>

<p>
After you click on the switch it will look like this, but read on just in case it didn't.
</p>


<div class="figure">
<p><img src="opened_vpn.png" alt=" opened_vpn.png"></p>
</div>
</div>
</div>
<div id="outline-container-org28946ca" class="outline-2">
<h2 id="org28946ca">Fixing the Password Problem</h2>
<div class="outline-text-2" id="text-org28946ca">
<p>
Unfortunately for me it didn't connect. In <code>/var/log/syslog</code> I could see entries like this:
</p>

<pre class="example">
gnome-shell[2805]: Invalid VPN service type (cannot find authentication binary)
</pre>

<p>
I don't know if the message is directly telling you this (it doesn't seem to), but it turns out that for some reason the Network Settings doesn't save your password. Look in <code>/etc/NetworkManager/system-connections/</code> for a file that matches the name you gave your vpn in the settings. In my case it was just called 'client'. Open it as root in an editor.
</p>

<pre class="example">
sudo emacs /etc/NetworkManager/system-connections/client
</pre>

<p>
Then change this line in the <code>[vpn]</code> section:
</p>

<pre class="example">
password-flags=1
</pre>

<p>
to
</p>

<pre class="example">
password-flags=0
</pre>

<p>
Then add this section.
</p>

<pre class="example">
[vpn-secrets]
password="your-password"
</pre>

<p>
Where <code>"your-password"</code> is your vpn password. <i>The quotation marks around your password are required.</i>
</p>
</div>
</div>

<div id="outline-container-orgea5d832" class="outline-2">
<h2 id="orgea5d832">Now Really Connect</h2>
<div class="outline-text-2" id="text-orgea5d832">
<p>
First restart the network manager.
</p>

<pre class="example">
sudo service network-manager restart
</pre>

<p>
Now re-open the network settings and click on the switch again. With any luck this time it will stay on and you can check by going to one of the devices on your VPN network.
</p>


<div class="figure">
<p><img src="switch_on.png" alt=" switch_on.png"></p>
</div>
</div>
</div>

<div id="outline-container-org5130688" class="outline-2">
<h2 id="org5130688">Sources</h2>
<div class="outline-text-2" id="text-org5130688">
<ul class="org-ul">
<li>Network Manager Dependencies: <a href="https://askubuntu.com/questions/579159/unable-to-load-vpn-connection-editor-in-ubuntu-14-04-lts">https://askubuntu.com/questions/579159/unable-to-load-vpn-connection-editor-in-ubuntu-14-04-lts</a>
</li>
<li>Add VPN Password: <a href="https://askubuntu.com/questions/976719/unable-to-connect-point-to-point-tunneling-protocol-pptp-vpn-in-ubuntu-17-10">https://askubuntu.com/questions/976719/unable-to-connect-point-to-point-tunneling-protocol-pptp-vpn-in-ubuntu-17-10</a>
</li>
</ul>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/howto-ubuntu/" rel="tag">howto ubuntu</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../tcpdump-on-an-external-hard-drive/" rel="prev" title="TCPDump On an External Hard Drive">Previous post</a>
            </li>
            <li class="next">
                <a href="../the-linux-ipv6-router-advertisement-daemon-radvd/" rel="next" title="The Linux IPv6 Router Advertisement Daemon (radvd)">Next post</a>
            </li>
        </ul></nav></aside></article><!--End of body content--><footer id="footer">
            Contents © 2018         <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


        <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
