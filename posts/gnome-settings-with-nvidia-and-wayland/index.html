<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Fixing Ubuntu Settings with Wayland" name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Fixing NVidia With Wayland on Ubuntu 24.04 (Noble Numbat) | The Cloistered Monkey</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/posts/gnome-settings-with-nvidia-and-wayland/" rel="canonical"><!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]-->
<link href="../../apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="../../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../../site.webmanifest" rel="manifest">
<meta content="Cloistered Monkey" name="author">
<link href="../protonpass-finding-the-suggested-password/" rel="prev" title="ProtonPass: Finding the Suggested Password" type="text/html">
<meta content="The Cloistered Monkey" property="og:site_name">
<meta content="Fixing NVidia With Wayland on Ubuntu 24.04 (Noble Numbat)" property="og:title">
<meta content="https://necromuralist.github.io/posts/gnome-settings-with-nvidia-and-wayland/" property="og:url">
<meta content="Fixing Ubuntu Settings with Wayland" property="og:description">
<meta content="article" property="og:type">
<meta content="2025-05-03T09:48:54-07:00" property="article:published_time">
<meta content="nvidia" property="article:tag">
<meta content="ubuntu" property="article:tag">
<meta content="wayland" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="../../"><span id="blog-title">The Cloistered Monkey</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="../../pages/">Pages</a></li>
<li class="nav-item"><a class="nav-link" href="../../archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="../../categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="../../rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Projects</a>
<div class="dropdown-menu"><a class="dropdown-item" href="https://necromuralist.github.io/Ape-Iron/">Ape Iron</a> <a class="dropdown-item" href="https://necromuralist.github.io/Beach-Pig-Thigh/">Beach Pig Rump & Thigh</a> <a class="dropdown-item" href="https://necromuralist.github.io/Bowling-For-Data/">Bowling For Data</a> <a class="dropdown-item" href="https://necromuralist.github.io/Give-The-Fish/">Give the Fish</a> <a class="dropdown-item" href="https://necromuralist.github.io/Neurotic-Networking/">Neurotic Networking</a> <a class="dropdown-item" href="https://necromuralist.github.io/Terribilis-Ludum/">Terribilis Ludum</a> <a class="dropdown-item" href="https://necromuralist.github.io/Visions-Voices-Data/">Visions, Voices, Data</a></div>
</li>
</ul>
<!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Search" type="text"></div>
<!-- 
<button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-search"></span>
</button>
-->
<input name="sitesearch" type="hidden" value="https://necromuralist.github.io/"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href=".">Fixing NVidia With Wayland on Ubuntu 24.04 (Noble Numbat)</a></h1>
<div class="metadata">
<p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author"><a class="u-url" href="../../authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2025-05-03T09:48:54-07:00" itemprop="datePublished" title="2025-05-03 09:48">2025-05-03 09:48</time></a></p>
<p class="sourceline"><a class="sourcelink" href="index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org99559d1">The Problem</a></li>
<li><a href="#orgbce7d85">The Problems</a>
<ul>
<li><a href="#org4cbaae8">WayDroid and X11</a></li>
<li><a href="#org99d1384">The Next Problem - Sleep and Logging out</a></li>
<li><a href="#org5e2c9d7">No Settings</a></li>
</ul>
</li>
<li><a href="#orgf624236">Conclusion</a></li>
<li><a href="#org1ca5bfb">Links</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org99559d1">
<h2 id="org99559d1">The Problem</h2>
<div class="outline-text-2" id="text-org99559d1">
<p>Switching from X11 to Wayland (on <b>Ubuntu 24.04 (Noble Numbat)</b>) initially prevented launching the Settings so I went on a hunt to fix it (and here are my notes).</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgbce7d85">
<h2 id="orgbce7d85">The Problems</h2>
<div class="outline-text-2" id="text-orgbce7d85"></div>
<div class="outline-3" id="outline-container-org4cbaae8">
<h3 id="org4cbaae8">WayDroid and X11</h3>
<div class="outline-text-3" id="text-org4cbaae8">
<p>I was poking around and saw that there was a project to run Android on PCs (among other things) called <a href="https://waydro.id/">Waydroid</a> so I installed it, but whenever I tried to enter the Waydroid shell</p>
<div class="highlight">
<pre><span></span>sudo waydroid shell
</pre></div>
<p>I got an error saying that the <i>waydroid session is stopped</i>. This isn't a post about waydroid so I'll skip the troubleshooting I did, but ultimately I found an <i>AskUbuntu</i> post from someone who ran into the same problem and found from one of <a href="https://askubuntu.com/questions/1475593/how-do-i-resolve-the-waydroid-session-is-stopped-problem/#comment2597386_1478124">the comments</a> that:</p>
<blockquote>
<p>it turns out that waydroid is not compatible with X11.</p>
</blockquote>
<p>Maybe it's called <i>Waydroid</i> because it needs <i>Wayland</i>? Anyway I checked if I was using <i>Wayland</i>:</p>
<div class="highlight">
<pre><span></span><span class="k">echo</span> <span class="nv">$XDG_SESSION_TYPE</span>
</pre></div>
<p>Which didn't show that I was (I can't remember if it showed X11 or was just empty, but it wasn't anything like "Wayland" anyway). It turned out I had chosen "Ubuntu" at the login screen, not "Ubuntu Wayland" so I logged out, switched to Wayland and then logged in. This seemed to fix the initial WayDroid problem (I got the GUI running but I still haven't finished the installation) but then another problem came up.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org99d1384">
<h3 id="org99d1384">The Next Problem - Sleep and Logging out</h3>
<div class="outline-text-3" id="text-org99d1384">
<p>Having switched to Wayland I decided I needed a break. While I was away my computer went to the lock screen, as it usually does, but when I opened it back up I found that instead of just locking the screen it had actually logged me out, killing all the applications I left open and closing an encrypted mount point I had open. More searching ensued.</p>
<p>Once again, someone posted a question on <a href="https://askubuntu.com/questions/1482786/ubuntu-23-04-logs-me-out-arbitrarily-while-going-to-sleep-mode"><i>AskUbuntu</i></a> that seemed to be about the same problem, the suggested answer being to disable the Screen Lock, which didn't really seem to be a good answer, but it was <i>an</i> answer, which was one more than I started with so I decided to give it a try. But then the next problem appeared.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org5e2c9d7">
<h3 id="org5e2c9d7">No Settings</h3>
<div class="outline-text-3" id="text-org5e2c9d7">
<p>When I tried to launch the settings an icon came up in the launcher like normal but the settings wouldn't come up. Okay. I'm skipping some of the intermediate searches but eventually I tried running the settings in the terminal to look for the errors.</p>
<div class="highlight">
<pre><span></span>gnome-control-center 
</pre></div>
<p>This gave an error which included "failed to create dri2 screen" so I went on a search again and found <a href="https://askubuntu.com/questions/1514352/ubuntu-24-04-with-nvidia-driver-libegl-warning-egl-failed-to-create-dri2-scre">another AskUbuntu post</a> with <a href="https://askubuntu.com/a/1516567">a suggested answer</a> - install a package:</p>
<div class="highlight">
<pre><span></span>sudo apt install libnvidia-egl-wayland1
</pre></div>
<p>After logging out and logging back in the settings worked <i>and</i> the lock screen no longer logged me out so this seems to have been the fix (for these problems, there's still some weird things going on but nothing I can't live with yet.)</p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgf624236">
<h2 id="orgf624236">Conclusion</h2>
<div class="outline-text-2" id="text-orgf624236">
<p>There's an <a href="https://bugs.launchpad.net/ubuntu/+source/nvidia-graphics-drivers-535/+bug/2063827">open bug on Launchpad</a> (<i>Gnome apps segfault in Nvidia (535) Wayland sessions on Noble, but 550 works</i>) which looks like it might be related to the problem I ran into. It says that upgrading the NVidia driver to 550 fixes the Gnome Settings problem but the upgrade then introduces some other errors so installing <code>libnvidia-egl-wayland1</code> looks like the right fix. The bug was opened on April 26, 2024 so I would imagine it would effect more people, making this a high priority. Perhaps Wayland isn't widely used, at least not among nvidia users. I'm typing this in emacs and portions of the buffer are messed up, making it dangerous to use (insofar as I can't tell if the text actually exists in the document in the same place where it appears on the screen) so I'll probably go back to X11 until they get this stuff worked out, but at least it's working a little better than it was this morning.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org1ca5bfb">
<h2 id="org1ca5bfb">Links</h2>
<div class="outline-text-2" id="text-org1ca5bfb">
<ul class="org-ul">
<li><a href="https://waydro.id/">Waydroid</a> : The start of the problem</li>
<li><a href="https://askubuntu.com/questions/1475593/how-do-i-resolve-the-waydroid-session-is-stopped-problem/">Ask Ubuntu - how do I resolve the "waydroid session is stopped" problem?</a>: The First Problem</li>
<li><a href="https://askubuntu.com/questions/1482786/ubuntu-23-04-logs-me-out-arbitrarily-while-going-to-sleep-mode">Ask Ubuntu - "Ubuntu 23.04 logs me out arbitrarily while going to sleep mode"</a>: The second problem.</li>
<li><a href="https://askubuntu.com/questions/1514352/ubuntu-24-04-with-nvidia-driver-libegl-warning-egl-failed-to-create-dri2-scre">Ask Ubuntu- Ubuntu 24.04 with Nvidia driver "libEGL warning: egl: failed to create dri2 screen"</a>: The solution post.</li>
<li><a href="https://bugs.launchpad.net/ubuntu/+source/nvidia-graphics-drivers-535/+bug/2063827">Launchpad - Gnome apps segfault in Nvidia (535) Wayland sessions on Noble, but 550 works</a> : Possibly related bug.</li>
<li><a href="https://gist.github.com/1999AZZAR/5c881fdaeb841fc4476259bfcc69b98c">GitHub Gist - waydroid on x11.md</a> : Possible way around Wayland for Waydroid. Also has other useful notes for Waydroid.</li>
</ul>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="../../categories/nvidia/" rel="tag">nvidia</a></li>
<li><a class="tag p-category" href="../../categories/ubuntu/" rel="tag">ubuntu</a></li>
<li><a class="tag p-category" href="../../categories/wayland/" rel="tag">wayland</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="../protonpass-finding-the-suggested-password/" rel="prev" title="ProtonPass: Finding the Suggested Password">Previous post</a></li>
</ul>
</nav>
</aside>
</article>
<!--End of body content-->
<footer id="footer">Scribbled by the <a href="mailto:cloisteredmonkey.jmark@slmail.me">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a>
<div id="license" xmlns:cc="http://creativecommons.org/ns#">This work is licensed under <a href="http://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" rel="license noopener noreferrer" style="display:inline-block;" target="_blank">CC BY 4.0 <img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"></a></div>
</footer>
</div>
</div>
<script src="../../assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script>
</body>
</html>
