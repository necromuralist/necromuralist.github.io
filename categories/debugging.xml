<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>The Cloistered Monkey (Posts about debugging)</title><link>https://necromuralist.github.io/</link><description></description><atom:link href="https://necromuralist.github.io/categories/debugging.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2023 &lt;a href="mailto:cloisteredmonkey.jmark@slmail.me"&gt;Cloistered Monkey&lt;/a&gt; </copyright><lastBuildDate>Tue, 24 Jan 2023 03:48:37 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>PuDB Remote</title><link>https://necromuralist.github.io/posts/pudb-remote/</link><dc:creator>Cloistered Monkey</dc:creator><description>&lt;div id="table-of-contents"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/pudb-remote/#org724cd7d"&gt;In the Beginning&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/pudb-remote/#orgcda43b5"&gt;Short Version&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/pudb-remote/#org1c0e96f"&gt;Okay, So Now Why Would You Do This?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/pudb-remote/#orgd21e824"&gt;Dead Ends&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/pudb-remote/#orgdf8a889"&gt;Another Screen&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/pudb-remote/#org3ad59ea"&gt;&lt;code&gt;term_size&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/pudb-remote/#orgc3b9c53"&gt;Telnet&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/pudb-remote/#org9ac8f3e"&gt;But It's Not Fixed?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org724cd7d" class="outline-2"&gt;
&lt;h2 id="org724cd7d"&gt;In the Beginning&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org724cd7d"&gt;
&lt;p&gt;
This is a post on using &lt;a href="https://documen.tician.de/pudb/index.html"&gt;PuDB&lt;/a&gt; via telnet.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-orgcda43b5" class="outline-2"&gt;
&lt;h2 id="orgcda43b5"&gt;Short Version&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgcda43b5"&gt;
&lt;p&gt;
In case I forgot what to do and just want to read this to remember.
&lt;/p&gt;

&lt;ol class="org-ol"&gt;
&lt;li&gt;In the screen where you are going to run telnet, run &lt;code&gt;tput cols&lt;/code&gt; and &lt;code&gt;tput lines&lt;/code&gt; to find out the number of columns and lines that the screen is using.&lt;/li&gt;
&lt;li&gt;In the code where you want the break, instead of the usual &lt;code&gt;import pudb; pudb.set_trace()&lt;/code&gt; use:&lt;/li&gt;
&lt;/ol&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pudb.remote&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;set_trace&lt;/span&gt;
&lt;span class="n"&gt;set_trace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;term_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lines&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
When the code hits the breakpoint it will start up a telnet service and you can log into it from the other screen:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;telnet 127.0.0.1 6899
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-org1c0e96f" class="outline-2"&gt;
&lt;h2 id="org1c0e96f"&gt;Okay, So Now Why Would You Do This?&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org1c0e96f"&gt;
&lt;p&gt;
I was trying to build one of my sites that uses &lt;a href="https://nikola.readthedocs.io/en/latest/"&gt;nikola&lt;/a&gt; and this strange error came out saying that one of the shortcodes was getting the "site" argument multiple times. I had no idea what was going on and nikola doesn't pre-define the arguments to the shortcode-plugins (it parses the text and then passes the arguments along using the &lt;code&gt;*args&lt;/code&gt; &lt;code&gt;**kwargs&lt;/code&gt; convention) which makes it flexible, but figuring out a problem with the arguments is pretty tough, so I decided to turn to my old standby &lt;code&gt;PuDB&lt;/code&gt;, which I've been using for so many years now, and is my favorite of the python debuggers I've tried.
&lt;/p&gt;

&lt;p&gt;
I did my usual thing and found the line in the &lt;code&gt;nikola&lt;/code&gt; code that was raising the error and inserted a breakpoint further up in the code.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;"lancelot"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pudb&lt;/span&gt;
    &lt;span class="n"&gt;pudb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_trace&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
I figured the problem was with my shortcode, named &lt;code&gt;lancelot&lt;/code&gt;, and the conditional allowed me to skip all the other shortcodes being used. But then, when I ran the build (&lt;code&gt;nikola build -v2&lt;/code&gt;)… disaster.
&lt;/p&gt;

&lt;p&gt;
&lt;img src="https://necromuralist.github.io/posts/pudb-remote/pudb-broken.png" alt="nil"&gt;
&lt;/p&gt;

&lt;p&gt;
For some reason it wouldn't use the entire screen, making it impossible (or at least really hard) to read some of the variables that I wanted to check - and even worse, when I tried to open up the ipython terminal in it I got an error message.
&lt;/p&gt;

&lt;p&gt;
&lt;img src="https://necromuralist.github.io/posts/pudb-remote/pudb-ui-exception.png" alt="nil"&gt;
&lt;/p&gt;

&lt;p&gt;
The error-message is one of those error-after-the-error messages that you sometimes run into. It was trying to notify me of an error by popping up some kind of dialog but then the dialog wouldn't open so it told me about the dialog error and didn't get around to telling me what the original error was. In any case, something was broken, so I had to resort to desperate measures - I went to read the documentation.
&lt;/p&gt;

&lt;p&gt;
Surprisingly, &lt;a href="https://documen.tician.de/pudb/index.html"&gt;there actually is some&lt;/a&gt; (there wasn't really much when I first started using it).
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-orgd21e824" class="outline-2"&gt;
&lt;h2 id="orgd21e824"&gt;Dead Ends&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgd21e824"&gt;
&lt;p&gt;
The first couple of things I tried seemed promising, but they didn't work.
&lt;/p&gt;
&lt;/div&gt;

&lt;div id="outline-container-orgdf8a889" class="outline-3"&gt;
&lt;h3 id="orgdf8a889"&gt;Another Screen&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-orgdf8a889"&gt;
&lt;p&gt;
There wasn't anything about re-sizing the window, but it did mention that you can have the output come out in a different terminal from the one where you run the code, so I gave it a go. I made a different screen and got its file-path using the &lt;code&gt;tty&lt;/code&gt; command (&lt;code&gt;/dev/pts/6&lt;/code&gt; in this case). Then I set an environment variable to hold the file-path in the screen where I was running the code (&lt;code&gt;set -x PUDB_TTY /dev/pts/6&lt;/code&gt;). This caused &lt;code&gt;PuDB&lt;/code&gt; to pipe the output to the next screen - and it &lt;i&gt;did&lt;/i&gt; work to send the first PuDB output to the other screen, and it &lt;i&gt;did&lt;/i&gt; use the whole window, but then it quit instead of letting me use the debugger. Not &lt;i&gt;quite&lt;/i&gt; what I wanted, so I unset the environment variable and moved on.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org3ad59ea" class="outline-3"&gt;
&lt;h3 id="org3ad59ea"&gt;&lt;code&gt;term_size&lt;/code&gt;&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org3ad59ea"&gt;
&lt;p&gt;
The documentation also showed how to use &lt;code&gt;PuDB&lt;/code&gt; as a remote debugger, and in the example they passed in the argument &lt;code&gt;term_size&lt;/code&gt; to &lt;code&gt;set_trace&lt;/code&gt; so I thought, since the functions have the same name, that the &lt;code&gt;set_trace&lt;/code&gt; I was using would take the same arguments. So I tried it.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pudb&lt;/span&gt;
&lt;span class="n"&gt;pudb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_trace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;term_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;236&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;61&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Using the values that I had gotten from &lt;a href="https://linux.die.net/man/1/tput"&gt;tput&lt;/a&gt;  using &lt;code&gt;tput cols&lt;/code&gt; and &lt;code&gt;tput lines&lt;/code&gt;. But that just raised an &lt;code&gt;ArgumentError&lt;/code&gt;. The functions have the same name, but not the same arguments.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-orgc3b9c53" class="outline-2"&gt;
&lt;h2 id="orgc3b9c53"&gt;Telnet&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgc3b9c53"&gt;
&lt;p&gt;
So then I decided to try their remote version. It doesn't really make sense to me that it would work better than the regular version, but I didn't see any other choice. So instead of the usual code to insert a breakpoint I used:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pudb.remote&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;set_trace&lt;/span&gt;
&lt;span class="n"&gt;set_trace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;term_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;236&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;61&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
When I ran the build it stopped and told me to telnet into the localhost address at port 6899.
&lt;/p&gt;

&lt;p&gt;
&lt;img src="https://necromuralist.github.io/posts/pudb-remote/please-telnet.png" alt="nil"&gt;
&lt;/p&gt;

&lt;p&gt;
So I changed into the other screen and ran telnet.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;telnet 127.0.0.1 6899
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
And what do you know.
&lt;/p&gt;

&lt;p&gt;
&lt;img src="https://necromuralist.github.io/posts/pudb-remote/pudb-fixed.png" alt="nil"&gt;
&lt;/p&gt;

&lt;p&gt;
This turns out to not be a complete fix. Hitting &lt;code&gt;!&lt;/code&gt; to get to the &lt;code&gt;ipython&lt;/code&gt; terminal froze &lt;code&gt;PuDB&lt;/code&gt;, but this was enough for me to inspect the variables and realize that I just needed to move one of the parameters in the definition of my shortcode method and it worked.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-org9ac8f3e" class="outline-2"&gt;
&lt;h2 id="org9ac8f3e"&gt;But It's Not Fixed?&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org9ac8f3e"&gt;
&lt;p&gt;
Well, if this were a more intense debug I really would want the &lt;code&gt;ipython~/~ptipython&lt;/code&gt; terminal, but since this is the first time I've tried to run &lt;code&gt;PuDB&lt;/code&gt; under &lt;code&gt;KUbuntu's&lt;/code&gt; &lt;code&gt;Konsole&lt;/code&gt; instead of the &lt;code&gt;GNOME&lt;/code&gt; terminal I'm hoping that just switching back to the other terminal will be enough - I'll have to test that once I'm more motivated.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>debugging</category><category>pudb</category><category>python</category><guid>https://necromuralist.github.io/posts/pudb-remote/</guid><pubDate>Thu, 18 Nov 2021 02:29:13 GMT</pubDate></item></channel></rss>