<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="A note on Linear Regression and binary data.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Linear Regression and Binary Data | The Cloistered Monkey</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://necromuralist.github.io/posts/linear-regression-and-binary-data/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="manifest" href="../../site.webmanifest">
<meta name="author" content="Cloistered Monkey">
<link rel="prev" href="../bibliography/an-introduction-to-statistical-learning/" title="An Introduction To Statistical Learning" type="text/html">
<link rel="next" href="../bibliography/isl-credit-data-set/" title="ISL Credit Data Set" type="text/html">
<meta property="og:site_name" content="The Cloistered Monkey">
<meta property="og:title" content="Linear Regression and Binary Data">
<meta property="og:url" content="https://necromuralist.github.io/posts/linear-regression-and-binary-data/">
<meta property="og:description" content="A note on Linear Regression and binary data.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-08-01T17:31:46-07:00">
<meta property="article:tag" content="categorical data">
<meta property="article:tag" content="data">
<meta property="article:tag" content="dummy variables">
<meta property="article:tag" content="linear regression">
<meta property="article:tag" content="slipnote">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-light
bg-light
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="../../">

            <span id="blog-title">The Cloistered Monkey</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../pages/" class="nav-link">Pages</a>
                </li>
<li class="nav-item">
<a href="../../archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="../../categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="../../rss.xml" class="nav-link">RSS feed</a>
            </li>
<li class="nav-item dropdown">
<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Projects</a>
            <div class="dropdown-menu">
                    <a href="https://necromuralist.github.io/Bowling-For-Data/" class="dropdown-item">Bowling For Data</a>
                    <a href="https://necromuralist.github.io/Anechoic-Echolalia/" class="dropdown-item">Anechoic Echolalia</a>
                    <a href="https://necromuralist.github.io/Ape-Iron/" class="dropdown-item">Ape Iron</a>
                    <a href="https://necromuralist.github.io/Neurotic-Networking/" class="dropdown-item">Neurotic Networking</a>
                    <a href="https://necromuralist.github.io/student_intervention/" class="dropdown-item">Student Intervention Project</a>
                    <a href="https://necromuralist.github.io/boston_housing/" class="dropdown-item">Boston Housing Project</a>
                    <a href="https://necromuralist.github.io/data_science/" class="dropdown-item">Data Science With Python</a>
                    <a href="https://necromuralist.github.io/Visions-Voices-Data/" class="dropdown-item">Visions, Voices, Data</a>
            </div>

                
            </li>
</ul>
<!-- Google custom search --><form method="get" action="https://www.google.com/search" class="navbar-form navbar-right" role="search">
<div class="form-group">
<input type="text" name="q" class="form-control" placeholder="Search">
</div>
<!-- 
<button type="submit" class="btn btn-primary">
	<span class="glyphicon glyphicon-search"></span>
</button>
-->
<input type="hidden" name="sitesearch" value="https://necromuralist.github.io/">
</form>
<!-- End of custom search -->


            <ul class="navbar-nav navbar-right">
<li class="nav-item">
    <a href="index.org" id="sourcelink" class="nav-link">Source</a>
    </li>


                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Linear Regression and Binary Data</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/cloistered-monkey/">Cloistered Monkey</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2020-08-01T17:31:46-07:00" itemprop="datePublished" title="2020-08-01 17:31">2020-08-01 17:31</time></a>
            </p>
            
        <p class="sourceline"><a href="index.org" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li>
<a href="#org796ab6f">Beginning</a>
<ul>
<li><a href="#org13814cb">Set Up</a></li>
</ul>
</li>
<li>
<a href="#org0e17b0c">Middle</a>
<ul>
<li><a href="#org2d80dd0">The Data</a></li>
<li><a href="#orgb8bcd7d">Encode the Gender</a></li>
<li><a href="#orgd03882c">Fit the Regression</a></li>
</ul>
</li>
<li><a href="#org107a32c">End</a></li>
<li><a href="#org8767d83">Sources</a></li>
</ul>
</div>
</div>
<div id="outline-container-org796ab6f" class="outline-2">
<h2 id="org796ab6f">Beginning</h2>
<div class="outline-text-2" id="text-org796ab6f">
<p>
I'm going to look at binary classification (two classes) and linear regression. In particular I'm going to use the <a href="../bibliography/isl-credit-data-set/">Credit Card Balance</a> data set <a href="../bibliography/an-introduction-to-statistical-learning/">(James et al., 2013)</a> to look at how to interpret the linear model once we encode gender.
</p>
</div>
<div id="outline-container-org13814cb" class="outline-3">
<h3 id="org13814cb">Set Up</h3>
<div class="outline-text-3" id="text-org13814cb">
</div>
<div id="outline-container-org042787b" class="outline-4">
<h4 id="org042787b">Imports</h4>
<div class="outline-text-4" id="text-org042787b">
<p>
First, some importing.
</p>
Traceback (most recent call last):
  File "/home/hades/.local/bin/pygmentize", line 5, in <module>
    from pygments.cmdline import main
ModuleNotFoundError: No module named 'pygments'
</module>
</div>
</div>
<div id="outline-container-org76ba17e" class="outline-4">
<h4 id="org76ba17e">The Environment</h4>
<div class="outline-text-4" id="text-org76ba17e">
<p>
This loads the path to files.
</p>
Traceback (most recent call last):
  File "/home/hades/.local/bin/pygmentize", line 5, in <module>
    from pygments.cmdline import main
ModuleNotFoundError: No module named 'pygments'
</module>
</div>
</div>
<div id="outline-container-org8c6ee8c" class="outline-4">
<h4 id="org8c6ee8c">Plotting</h4>
<div class="outline-text-4" id="text-org8c6ee8c">
<p>
This just sets up some convenience values for plotting.
</p>
Traceback (most recent call last):
  File "/home/hades/.local/bin/pygmentize", line 5, in <module>
    from pygments.cmdline import main
ModuleNotFoundError: No module named 'pygments'
</module>
</div>
</div>
<div id="outline-container-orga7e3322" class="outline-4">
<h4 id="orga7e3322">The Data</h4>
<div class="outline-text-4" id="text-orga7e3322">
<p>
I downloaded the data from the <a href="https://faculty.marshall.usc.edu/gareth-james/ISL/data.html">ISL Data Set page</a> previously so I'll load it here.
</p>
Traceback (most recent call last):
  File "/home/hades/.local/bin/pygmentize", line 5, in <module>
    from pygments.cmdline import main
ModuleNotFoundError: No module named 'pygments'

<p>
I passed in the <code>index_col</code> argument because the first column is a index column with no header, so it just looks goofy if you don't. There are several columns but I only want <code>Gender</code> and <code>Balance</code> (the credit card balance).
</p>

Traceback (most recent call last):
  File "/home/hades/.local/bin/pygmentize", line 5, in <module>
    from pygments.cmdline import main
ModuleNotFoundError: No module named 'pygments'
</module></module>
</div>
</div>
</div>
</div>
<div id="outline-container-org0e17b0c" class="outline-2">
<h2 id="org0e17b0c">Middle</h2>
<div class="outline-text-2" id="text-org0e17b0c">
</div>
<div id="outline-container-org2d80dd0" class="outline-3">
<h3 id="org2d80dd0">The Data</h3>
<div class="outline-text-3" id="text-org2d80dd0">
<p>
Now that we have the data we can take a quick look at what's there.
</p>
Traceback (most recent call last):
  File "/home/hades/.local/bin/pygmentize", line 5, in <module>
    from pygments.cmdline import main
ModuleNotFoundError: No module named 'pygments'

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">Gender</th>
<th scope="col" class="org-right">Count</th>
<th scope="col" class="org-right">Percent (%)</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">Female</td>
<td class="org-right">207</td>
<td class="org-right">51.75</td>
</tr>
<tr>
<td class="org-left">Male</td>
<td class="org-right">193</td>
<td class="org-right">48.25</td>
</tr>
</tbody>
</table>
<p>
Our two classes are "Female" and "Male" and they are roughly, but not quite, equal in number. Now I'll look at the balance.
</p>

Traceback (most recent call last):
  File "/home/hades/.local/bin/pygmentize", line 5, in <module>
    from pygments.cmdline import main
ModuleNotFoundError: No module named 'pygments'

Traceback (most recent call last):
  File "/home/hades/.local/bin/pygmentize", line 5, in <module>
    from pygments.cmdline import main
ModuleNotFoundError: No module named 'pygments'

<object type="text/html" data="balance_distributions.html" style="width:100%" height="800">
  <p>Figure Missing</p>
</object>

<p>
It looks like there are two populations for each gender. The larger one for both genders is centered near 0 and then both genders have a secondary population that carries a balance.
</p>
</module></module></module>
</div>
</div>

<div id="outline-container-orgb8bcd7d" class="outline-3">
<h3 id="orgb8bcd7d">Encode the Gender</h3>
<div class="outline-text-3" id="text-orgb8bcd7d">
<p>
Since the <code>Gender</code> data is categorical we need to create a <i>dummy variable</i> to encode it. So what I'm going to do is encode males as 0 and females as 1 (because of the nature of binary encoding, we could swap the numbers and it would still work).
</p>

Traceback (most recent call last):
  File "/home/hades/.local/bin/pygmentize", line 5, in <module>
    from pygments.cmdline import main
ModuleNotFoundError: No module named 'pygments'

Traceback (most recent call last):
  File "/home/hades/.local/bin/pygmentize", line 5, in <module>
    from pygments.cmdline import main
ModuleNotFoundError: No module named 'pygments'

<pre class="example">
1    207
0    193
Name: gender, dtype: int64
</pre>
</module></module>
</div>
</div>

<div id="outline-container-orgd03882c" class="outline-3">
<h3 id="orgd03882c">Fit the Regression</h3>
<div class="outline-text-3" id="text-orgd03882c">
<p>
Now I'll fit the model with <a href="https://www.statsmodels.org/stable/index.html">statsmodels</a>, which uses r-style arguments (I think it supports regular python arguments too).
</p>

Traceback (most recent call last):
  File "/home/hades/.local/bin/pygmentize", line 5, in <module>
    from pygments.cmdline import main
ModuleNotFoundError: No module named 'pygments'

<pre class="example" id="org9560b20">
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                Balance   R-squared:                       0.000
Model:                            OLS   Adj. R-squared:                 -0.002
Method:                 Least Squares   F-statistic:                    0.1836
Date:                Sun, 02 Aug 2020   Prob (F-statistic):              0.669
Time:                        16:55:01   Log-Likelihood:                -3019.3
No. Observations:                 400   AIC:                             6043.
Df Residuals:                     398   BIC:                             6051.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept    509.8031     33.128     15.389      0.000     444.675     574.931
gender        19.7331     46.051      0.429      0.669     -70.801     110.267
==============================================================================
Omnibus:                       28.438   Durbin-Watson:                   1.940
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               27.346
Skew:                           0.583   Prob(JB):                     1.15e-06
Kurtosis:                       2.471   Cond. No.                         2.66
==============================================================================

Warnings:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre>

<p>
The model is something like this:
</p>

<p>
\[
 balance = \beta_0 + \beta_1 \times gender
\]
</p>

<p>
Since we encoded Male as 0 and Female as 1, when the gender is Male the second term drops out and all you have is \(\beta_0\), while for females you have have the full equation. How do you interpret the \(\beta\)s? 
</p>

<ul class="org-ul">
<li>\(\beta_0\) is the average balance that males carry</li>
<li>\(\beta_0 + \beta_1\) is the average balance that females carry</li>
<li>\(\beta_1\) is the difference between the average balances</li>
</ul>
<p>
We can check this by comparing the <code>coef</code> entry in the summary table that I printed. The <code>Intercept</code> is \(\beta_0\) and <code>gender</code> is \(\beta_1\)
</p>

Traceback (most recent call last):
  File "/home/hades/.local/bin/pygmentize", line 5, in <module>
    from pygments.cmdline import main
ModuleNotFoundError: No module named 'pygments'

<pre class="example">
Average Male Balance: 509.8031
Average Female Balance: 529.5362
Average difference: 19.73312
</pre>


Traceback (most recent call last):
  File "/home/hades/.local/bin/pygmentize", line 5, in <module>
    from pygments.cmdline import main
ModuleNotFoundError: No module named 'pygments'

Traceback (most recent call last):
  File "/home/hades/.local/bin/pygmentize", line 5, in <module>
    from pygments.cmdline import main
ModuleNotFoundError: No module named 'pygments'

Traceback (most recent call last):
  File "/home/hades/.local/bin/pygmentize", line 5, in <module>
    from pygments.cmdline import main
ModuleNotFoundError: No module named 'pygments'

<object type="text/html" data="Gender Model.html" style="width:100%" height="800">
  <p>Figure Missing</p>
</object>

<p>
I didn't set up a hypothesis test, but if you look at the p-value (the <code>P&gt;|t|</code> column in the summary) for <code>gender</code> you can see that it's much larger than 0.05 or whatever level you would normally choose, so it's probable that <code>gender</code> isn't significant, so the average balance for both genders is really the same, given the deviation, but this is just about interpreting the coefficients, not deciding the validity of this particular model.
</p>
</module></module></module></module></module>
</div>
</div>
</div>

<div id="outline-container-org107a32c" class="outline-2">
<h2 id="org107a32c">End</h2>
<div class="outline-text-2" id="text-org107a32c">
<p>
So there you have it. If you have the specialized case of binary categorical data you can convert the category to <i>dummy variables</i> and then fit a linear regression to it. If you encode the values as <i>0</i> and <i>1</i> then the <i>y-intercept</i> will give you the average output value for the category set to 0 and the <i>slope</i> will give you the difference between the average outputs for the categories. If you use different dummy variables the meanings will change slightly, although you will still be inferring things about the averages. Why is this interesting - predicting the mean for each category?
</p>

<p>
Logistic regression also relies on dummy variables for categorical encodings and this shows a preliminary step that helps us:
</p>
<ul class="org-ul">
<li>encode the dummy variables</li>
<li>build a linear model using statsmodels</li>
<li>view summary information about the model</li>
</ul>
<p>
I didn't emphasize it, but the p-value for the f-statistic might be valuable when deciding whether the categorical data is different enough to use as a feature.
</p>
</div>
</div>
<div id="outline-container-org8767d83" class="outline-2">
<h2 id="org8767d83">Sources</h2>
<div class="outline-text-2" id="text-org8767d83">
<ul class="org-ul">
<li><a href="../bibliography/an-introduction-to-statistical-learning/">An Introduction To Statistical Learning</a></li>
<li><a href="../bibliography/isl-credit-data-set/">ISL Credit Data Set</a></li>
</ul>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/categorical-data/" rel="tag">categorical data</a></li>
            <li><a class="tag p-category" href="../../categories/data/" rel="tag">data</a></li>
            <li><a class="tag p-category" href="../../categories/dummy-variables/" rel="tag">dummy variables</a></li>
            <li><a class="tag p-category" href="../../categories/linear-regression/" rel="tag">linear regression</a></li>
            <li><a class="tag p-category" href="../../categories/slipnote/" rel="tag">slipnote</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../bibliography/an-introduction-to-statistical-learning/" rel="prev" title="An Introduction To Statistical Learning">Previous post</a>
            </li>
            <li class="next">
                <a href="../bibliography/isl-credit-data-set/" rel="next" title="ISL Credit Data Set">Next post</a>
            </li>
        </ul></nav></aside><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script></article><!--End of body content--><footer id="footer">
            Contents © 2023         <a href="mailto:cloisteredmonkey.jmark@slmail.me">Cloistered Monkey</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
            
        </footer>
</div>
</div>


        <script src="../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
