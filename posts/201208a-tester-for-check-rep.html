<html><body><div class="document" id="a-tester-for-the-check-rep"><pre class="code python literal-block"><span class="kn">from</span> <span class="nn">unittest</span> <span class="kn">import</span> <span class="n">TestCase</span><br><span class="kn">import</span> <span class="nn">sys</span><br><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span><br><br><span class="kn">from</span> <span class="nn">nose.tools</span> <span class="kn">import</span> <span class="n">raises</span><br><br><span class="kn">from</span> <span class="nn">softwaretesting</span> <span class="kn">import</span> <span class="n">fixedsizequeue</span><br><br><br><span class="n">MAXINT</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxint</span><br><span class="n">MININT</span> <span class="o">=</span> <span class="o">-</span><span class="n">sys</span><span class="o">.</span><span class="n">maxint</span> <span class="o">-</span> <span class="mi">1</span><br><br><br><span class="k">class</span> <span class="nc">TestFixedCheckRep</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span><br>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">randint</span><span class="p">(</span><span class="n">MININT</span><span class="p">,</span> <span class="n">MAXINT</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)]</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="n">fixedsizequeue</span><span class="o">.</span><span class="n">FixedsizeQueue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span><br>        <span class="k">return</span><br><br>    <span class="k">def</span> <span class="nf">check_fail_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span><br>        <span class="sd">"""<br>        Checks if the check_rep fails then resets the q<br>        """</span><br>        <span class="k">print</span><span class="p">(</span><span class="s">"Testing: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="p">))</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">check_representation</span><span class="p">)</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span><br>        <span class="k">print</span><span class="p">(</span><span class="s">"Passed: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="p">))</span><br>        <span class="k">return</span><br><br>    <span class="k">def</span> <span class="nf">test_okay</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span><br>        <span class="sd">"""<br>        The enqueue takes a single integer and returns True if added.<br>        """</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">check_representation</span><span class="p">()</span><br>        <span class="k">return</span><br><br>    <span class="nd">@raises</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">)</span><br>    <span class="k">def</span> <span class="nf">test_enqueue_wraparound_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span><br>        <span class="sd">"""<br>        The tail should wrap around when it fills<br>        """</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span><br>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span><br>            <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">enqueue</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">tail</span> <span class="o">=</span> <span class="mi">1</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">check_representation</span><span class="p">()</span><br>        <span class="k">return</span><br><br>    <span class="nd">@raises</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">)</span><br>    <span class="k">def</span> <span class="nf">test_dequeue_wraparound_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span><br>        <span class="sd">"""<br>        After emptying the queue, the head should be 0<br>        """</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span><br>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span><br>            <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">enqueue</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><br>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span><br>            <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">dequeue</span><span class="p">()</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="mi">1</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">check_representation</span><span class="p">()</span><br>        <span class="k">return</span><br><br>    <span class="k">def</span> <span class="nf">test_negative_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span><br>        <span class="sd">"""<br>        The properties of the queue should never become negative.<br>        """</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span><br>        <span class="n">value</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">check_representation</span><span class="p">()</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="n">value</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">check_fail_reset</span><span class="p">()</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">tail</span> <span class="o">=</span> <span class="n">value</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">check_fail_reset</span><span class="p">()</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="n">value</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">check_fail_reset</span><span class="p">()</span><br><br><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">value</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">check_fail_reset</span><span class="p">()</span><br><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">value</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">check_fail_reset</span><span class="p">()</span><br>        <span class="k">return</span><br><br>    <span class="k">def</span> <span class="nf">test_negative_offset_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">check_representation</span><span class="p">()</span><br>        <span class="n">value</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">head</span> <span class="o">+=</span> <span class="n">value</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">size</span> <span class="o">-=</span> <span class="n">value</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">check_fail_reset</span><span class="p">()</span><br><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">head</span> <span class="o">-=</span> <span class="n">value</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">size</span> <span class="o">+=</span> <span class="n">value</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">check_fail_reset</span><span class="p">()</span><br>        <span class="k">return</span><br><span class="c"># end class TestCheckRep</span><br></pre></div></body></html>