<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>The Cloistered Monkey (Posts about Ubuntu)</title><link>https://necromuralist.github.io/</link><description></description><atom:link href="https://necromuralist.github.io/categories/cat_ubuntu.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents Â© 2025 &lt;a href="mailto:cloisteredmonkey.jmark@slmail.me"&gt;Cloistered Monkey&lt;/a&gt; 
&lt;div id="license"xmlns:cc="http://creativecommons.org/ns#" &gt;This work is licensed under
&lt;a href="http://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;"&gt;CC BY 4.0
&lt;img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"&gt;
&lt;img src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"&gt;&lt;/a&gt;
&lt;/div&gt;
</copyright><lastBuildDate>Fri, 30 May 2025 20:35:45 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Fixing NVidia With Wayland on Ubuntu 24.04 (Noble Numbat)</title><link>https://necromuralist.github.io/posts/gnome-settings-with-nvidia-and-wayland/</link><dc:creator>Cloistered Monkey</dc:creator><description>&lt;div id="table-of-contents" role="doc-toc"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents" role="doc-toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/gnome-settings-with-nvidia-and-wayland/#org99559d1"&gt;The Problem&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/gnome-settings-with-nvidia-and-wayland/#orgbce7d85"&gt;The Problems&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/gnome-settings-with-nvidia-and-wayland/#org4cbaae8"&gt;WayDroid and X11&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/gnome-settings-with-nvidia-and-wayland/#org99d1384"&gt;The Next Problem - Sleep and Logging out&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/gnome-settings-with-nvidia-and-wayland/#org5e2c9d7"&gt;No Settings&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/gnome-settings-with-nvidia-and-wayland/#orgf624236"&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/gnome-settings-with-nvidia-and-wayland/#org1ca5bfb"&gt;Links&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org99559d1" class="outline-2"&gt;
&lt;h2 id="org99559d1"&gt;The Problem&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org99559d1"&gt;
&lt;p&gt;
Switching from X11 to Wayland (on &lt;b&gt;&lt;b&gt;Ubuntu 24.04 (Noble Numbat)&lt;/b&gt;&lt;/b&gt;) initially prevented launching the Settings so I went on a hunt to fix it (and here are my notes).
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgbce7d85" class="outline-2"&gt;
&lt;h2 id="orgbce7d85"&gt;The Problems&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgbce7d85"&gt;
&lt;/div&gt;
&lt;div id="outline-container-org4cbaae8" class="outline-3"&gt;
&lt;h3 id="org4cbaae8"&gt;WayDroid and X11&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org4cbaae8"&gt;
&lt;p&gt;
I was poking around and saw that there was a project to run Android on PCs (among other things) called &lt;a href="https://waydro.id/"&gt;Waydroid&lt;/a&gt; so I installed it, but whenever I tried to enter the Waydroid shell
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo waydroid shell
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
I got an error saying  that the &lt;i&gt;waydroid session is stopped&lt;/i&gt;. This isn't a post about waydroid so I'll skip the troubleshooting I did, but ultimately I found an &lt;i&gt;AskUbuntu&lt;/i&gt; post from someone who ran into the same problem and found from one of &lt;a href="https://askubuntu.com/questions/1475593/how-do-i-resolve-the-waydroid-session-is-stopped-problem/#comment2597386_1478124"&gt;the comments&lt;/a&gt; that:
&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;
it turns out that waydroid is not compatible with X11.
&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;
Maybe it's called &lt;i&gt;Waydroid&lt;/i&gt; because it needs &lt;i&gt;Wayland&lt;/i&gt;? Anyway I checked if I was using &lt;i&gt;Wayland&lt;/i&gt;:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;echo&lt;/span&gt; &lt;span class="nv"&gt;$XDG_SESSION_TYPE&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Which didn't show that I was (I can't remember if it showed X11 or was just empty, but it wasn't anything like "Wayland" anyway). It turned out I had chosen "Ubuntu" at the login screen, not "Ubuntu Wayland" so I logged out, switched to Wayland and then logged in. This seemed to fix the initial WayDroid problem (I got the GUI running but I still haven't finished the installation) but then another problem came up.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org99d1384" class="outline-3"&gt;
&lt;h3 id="org99d1384"&gt;The Next Problem - Sleep and Logging out&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org99d1384"&gt;
&lt;p&gt;
Having switched to Wayland I decided I needed a break. While I was away my computer went to the lock screen, as it usually does, but when I opened it back up I found that instead of just locking the screen it had actually logged me out, killing all the applications I left open and closing an encrypted mount point I had open. More searching ensued.
&lt;/p&gt;

&lt;p&gt;
Once again, someone posted a question on &lt;a href="https://askubuntu.com/questions/1482786/ubuntu-23-04-logs-me-out-arbitrarily-while-going-to-sleep-mode"&gt;&lt;i&gt;AskUbuntu&lt;/i&gt;&lt;/a&gt; that seemed to be about the same problem, the suggested answer being to disable the Screen Lock, which didn't really seem to be a good answer, but it was &lt;i&gt;an&lt;/i&gt; answer, which was one more than I started with so I decided to give it a try. But then the next problem appeared.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org5e2c9d7" class="outline-3"&gt;
&lt;h3 id="org5e2c9d7"&gt;No Settings&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org5e2c9d7"&gt;
&lt;p&gt;
When I tried to launch the settings an icon came up in the launcher like normal but the settings wouldn't come up. Okay. I'm skipping some of the intermediate searches but eventually I tried running the settings in the terminal to look for the errors.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;gnome-control-center 
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
This gave an error which included "failed to create dri2 screen" so I went on a search again and found &lt;a href="https://askubuntu.com/questions/1514352/ubuntu-24-04-with-nvidia-driver-libegl-warning-egl-failed-to-create-dri2-scre"&gt;another AskUbuntu post&lt;/a&gt; with &lt;a href="https://askubuntu.com/a/1516567"&gt;a suggested answer&lt;/a&gt; - install a package:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt install libnvidia-egl-wayland1
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
After logging out and logging back in the settings worked &lt;i&gt;and&lt;/i&gt; the lock screen no longer logged me out so this seems to have been the fix (for these problems, there's still some weird things going on but nothing I can't live with yet.)
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgf624236" class="outline-2"&gt;
&lt;h2 id="orgf624236"&gt;Conclusion&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgf624236"&gt;
&lt;p&gt;
There's an &lt;a href="https://bugs.launchpad.net/ubuntu/+source/nvidia-graphics-drivers-535/+bug/2063827"&gt;open bug on Launchpad&lt;/a&gt; (&lt;i&gt;Gnome apps segfault in Nvidia (535) Wayland sessions on Noble, but 550 works&lt;/i&gt;) which looks like it might be related to the problem I ran into. It says that upgrading the NVidia driver to 550 fixes the Gnome Settings problem but the upgrade then introduces some other errors so installing &lt;code&gt;libnvidia-egl-wayland1&lt;/code&gt; looks like the right fix. The bug was opened on April 26, 2024 so I would imagine it would effect more people, making this a high priority. Perhaps Wayland isn't widely used, at least not among nvidia users. I'm typing this in emacs and portions of the buffer are messed up, making it dangerous to use (insofar as I can't tell if the text actually exists in the document in the same place where it appears on the screen) so I'll probably go back to X11 until they get this stuff worked out, but at least it's working a little better than it was this morning.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org1ca5bfb" class="outline-2"&gt;
&lt;h2 id="org1ca5bfb"&gt;Links&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org1ca5bfb"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;a href="https://waydro.id/"&gt;Waydroid&lt;/a&gt; : The start of the problem&lt;/li&gt;
&lt;li&gt;&lt;a href="https://askubuntu.com/questions/1475593/how-do-i-resolve-the-waydroid-session-is-stopped-problem/"&gt;Ask Ubuntu - how do I resolve the "waydroid session is stopped" problem?&lt;/a&gt;: The First Problem&lt;/li&gt;
&lt;li&gt;&lt;a href="https://askubuntu.com/questions/1482786/ubuntu-23-04-logs-me-out-arbitrarily-while-going-to-sleep-mode"&gt;Ask Ubuntu - "Ubuntu 23.04 logs me out arbitrarily while going to sleep mode"&lt;/a&gt;: The second problem.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://askubuntu.com/questions/1514352/ubuntu-24-04-with-nvidia-driver-libegl-warning-egl-failed-to-create-dri2-scre"&gt;Ask Ubuntu- Ubuntu 24.04 with Nvidia driver "libEGL warning: egl: failed to create dri2 screen"&lt;/a&gt;: The solution post.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://bugs.launchpad.net/ubuntu/+source/nvidia-graphics-drivers-535/+bug/2063827"&gt;Launchpad - Gnome apps segfault in Nvidia (535) Wayland sessions on Noble, but 550 works &lt;/a&gt; : Possibly related bug.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://gist.github.com/1999AZZAR/5c881fdaeb841fc4476259bfcc69b98c"&gt;GitHub Gist - waydroid on x11.md&lt;/a&gt; : Possible way around Wayland for Waydroid. Also has other useful notes for Waydroid.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>nvidia</category><category>ubuntu</category><category>wayland</category><guid>https://necromuralist.github.io/posts/gnome-settings-with-nvidia-and-wayland/</guid><pubDate>Sat, 03 May 2025 16:48:54 GMT</pubDate></item><item><title>Noble Numbat and the Broken Virtual Environments</title><link>https://necromuralist.github.io/posts/noble-numbat-and-the-broken-virtual-environments/</link><dc:creator>Cloistered Monkey</dc:creator><description>&lt;div id="table-of-contents" role="doc-toc"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents" role="doc-toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/noble-numbat-and-the-broken-virtual-environments/#org40429aa"&gt;What is this about?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/noble-numbat-and-the-broken-virtual-environments/#org052aae9"&gt;What Happened&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/noble-numbat-and-the-broken-virtual-environments/#org63adcfe"&gt;Short Version&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/noble-numbat-and-the-broken-virtual-environments/#org46a1c07"&gt;The First Hint (pipx)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/noble-numbat-and-the-broken-virtual-environments/#org16f65f6"&gt;The Broken Virtual Environments&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/noble-numbat-and-the-broken-virtual-environments/#org6dab3cd"&gt;Then a Nikola Error&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/noble-numbat-and-the-broken-virtual-environments/#orgf9d15a8"&gt;An Ape-Iron Problem (no distutils)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/noble-numbat-and-the-broken-virtual-environments/#org5b4d613"&gt;Links&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org40429aa" class="outline-2"&gt;
&lt;h2 id="org40429aa"&gt;What is this about?&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org40429aa"&gt;
&lt;p&gt;
These are notes I made when I was fixing some errors that occurred after updating Ubuntu to 24.04. It's been over a year so I don't really remember writing this, but, here it is. The fixes are specific to &lt;a href="https://github.com/justinmayer/virtualfish"&gt;virtualfish&lt;/a&gt;, &lt;a href="https://github.com/pypa/pipx"&gt;pipx&lt;/a&gt;, and &lt;a href="https://getnikola.com/"&gt;nikola&lt;/a&gt;.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org052aae9" class="outline-2"&gt;
&lt;h2 id="org052aae9"&gt;What Happened&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org052aae9"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;I updated Ubuntu&lt;/li&gt;
&lt;li&gt;Something raised an obscure error when I changed into one of my git repositories&lt;/li&gt;
&lt;li&gt;It turned out that the upgrade broke the python virtual environment&lt;/li&gt;
&lt;li&gt;Re-setting-up using the newer version of python that came with the upgrade fixed things.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org63adcfe" class="outline-2"&gt;
&lt;h2 id="org63adcfe"&gt;Short Version&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org63adcfe"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Upgrading to Ubuntu 24.04 made python changes that broke all my virtual enviroments&lt;/li&gt;
&lt;li&gt;Reinstalled &lt;code&gt;pipx&lt;/code&gt; using apt&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vf ls --details&lt;/code&gt; shows the python versions for all (virtualfish created) virtual environments (and which are broken)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vf upgrade --rebuild&lt;/code&gt; will upgrade the currently active virtual environment (may take more than one run to get past errors)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pipx reinstall-all&lt;/code&gt; fixed the missing &lt;code&gt;nikola&lt;/code&gt; and &lt;code&gt;pygmentize&lt;/code&gt; errors (and probably others)&lt;/li&gt;
&lt;li&gt;fixing &lt;code&gt;pygments&lt;/code&gt; doesn't fix the errors in posts that were alread built so do a &lt;code&gt;nikola clean&lt;/code&gt; and &lt;code&gt;nikola build&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pip install setuptools --upgrade&lt;/code&gt; in the environment re-setup &lt;code&gt;distutils&lt;/code&gt; which was removed from python 3.12 (which Ubuntu Installed)&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org46a1c07" class="outline-2"&gt;
&lt;h2 id="org46a1c07"&gt;The First Hint (pipx)&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org46a1c07"&gt;
&lt;p&gt;
I don't remember exactly what cued me in to what was going wrong, but somewhere in trying to figure out what was wrong I found that running &lt;a href="https://github.com/frostming/legit"&gt;legit&lt;/a&gt; after updating to Ubuntu 24.04 returned an error saying that &lt;code&gt;legit&lt;/code&gt; wasn't found. It took a while to figure out where &lt;code&gt;legit&lt;/code&gt; was supposed to be coming from, but it turned out I had installed it with &lt;a href="https://pipx.pypa.io/latest/installation/"&gt;pipx&lt;/a&gt; and had to re-install it to get it working.
&lt;/p&gt;

&lt;p&gt;
I don't remember exactly what I did anymore, but based on the command history it looks like:
&lt;/p&gt;

&lt;ol class="org-ol"&gt;
&lt;li&gt;Re-install &lt;code&gt;pipx&lt;/code&gt; (I purged the original installation that had been installed using &lt;code&gt;pip&lt;/code&gt; and instead used &lt;code&gt;apt&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;Re-install &lt;code&gt;legit&lt;/code&gt; using the updated &lt;code&gt;pipx&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;
So, was &lt;code&gt;pipx&lt;/code&gt; the problem? Well, partly.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org16f65f6" class="outline-2"&gt;
&lt;h2 id="org16f65f6"&gt;The Broken Virtual Environments&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org16f65f6"&gt;
&lt;p&gt;
The next problem came when I tried to build the HTML for this site.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;nikola build
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Traceback&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;most&lt;/span&gt; &lt;span class="n"&gt;recent&lt;/span&gt; &lt;span class="n"&gt;call&lt;/span&gt; &lt;span class="n"&gt;last&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="n"&gt;File&lt;/span&gt; &lt;span class="s2"&gt;"/home/hades/.virtualenvs/necromuralist.github.io/bin/nikola"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;module&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;nikola.__main__&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;main&lt;/span&gt;
&lt;span class="ne"&gt;ModuleNotFoundError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;No&lt;/span&gt; &lt;span class="n"&gt;module&lt;/span&gt; &lt;span class="n"&gt;named&lt;/span&gt; &lt;span class="s1"&gt;'nikola'&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
For some reason the &lt;code&gt;nikola&lt;/code&gt; executable was missing. Since I was in a virtual environment I tried to re-install nikola but using &lt;code&gt;pip&lt;/code&gt; gave another error.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip --version
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Traceback&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;most&lt;/span&gt; &lt;span class="n"&gt;recent&lt;/span&gt; &lt;span class="n"&gt;call&lt;/span&gt; &lt;span class="n"&gt;last&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="n"&gt;File&lt;/span&gt; &lt;span class="s2"&gt;"/home/hades/.virtualenvs/necromuralist.github.io/bin/pip"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;module&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;pip._internal.cli.main&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;main&lt;/span&gt;
&lt;span class="ne"&gt;ModuleNotFoundError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;No&lt;/span&gt; &lt;span class="n"&gt;module&lt;/span&gt; &lt;span class="n"&gt;named&lt;/span&gt; &lt;span class="s1"&gt;'pip'&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
So, not only was &lt;code&gt;nikola&lt;/code&gt; missing but so was &lt;code&gt;pip&lt;/code&gt;, which I thought was a part of the python installationâ¦ I looked at what was in the virtualenvironment -
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ls ~/.virtualenvs/necromuralist.github.io/lib
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
And saw that it had this python version:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python3.11/
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
But when I checked the version of the python I was using it gave this.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python --version
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Python 3.12.3
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
So it looked like the ubuntu update created a bit of a mismatch. It turns out that &lt;a href="https://virtualfish.readthedocs.io/en/latest/"&gt;virtualfish&lt;/a&gt; has a command to list what virtual environments you have set up (&lt;code&gt;vf ls&lt;/code&gt;) and if you pass it the &lt;code&gt;--details=&lt;/code&gt; option it will show you the python version the environment is using.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;vf ls --details
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
It listed all my environments but in particular it showed this for the environment for this site's repository.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;necromuralist.github.io &lt;span class="o"&gt;(&lt;/span&gt;broken&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
&lt;code&gt;virtualfish&lt;/code&gt; also has a command to upgrade the currently active environment so I tried running it.
&lt;/p&gt;

&lt;p&gt;
Running this with the &lt;i&gt;necromuralist&lt;/i&gt; environment active:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;vf upgrade --rebuild
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Gave this error.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Collecting &lt;span class="nv"&gt;PyYAML&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;6.0
  Downloading PyYAML-6.0.tar.gz &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;124&lt;/span&gt; kB&lt;span class="o"&gt;)&lt;/span&gt;
     ââââââââââââââââââââââââââââââââââââââââ 125.0/125.0 kB 3.5 MB/s eta 0:00:00
  Installing build dependencies ... done
  Getting requirements to build wheel ... error
  error: subprocess-exited-with-error

  Ã Getting requirements to build wheel did &lt;span class="k"&gt;not&lt;/span&gt; run successfully.
  â &lt;span class="k"&gt;exit&lt;/span&gt; code: 1
  â°â&amp;gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;54&lt;/span&gt; lines of output&lt;span class="o"&gt;]&lt;/span&gt;
      running egg_info
      writing lib/PyYAML.egg-info/PKG-INFO
      writing dependency_links to lib/PyYAML.egg-info/dependency_links.txt
      writing top-level names to lib/PyYAML.egg-info/top_level.txt
      Traceback &lt;span class="o"&gt;(&lt;/span&gt;most recent call last&lt;span class="o"&gt;)&lt;/span&gt;:
        File &lt;span class="s2"&gt;"/home/hades/.virtualenvs/necromuralist.github.io/lib/python3.12/site-packages/pip/_vendor/pyproject_hooks/_in_process/_in_process.py"&lt;/span&gt;, line 353, &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;module&amp;gt;
          main&lt;span class="o"&gt;()&lt;/span&gt;
        File &lt;span class="s2"&gt;"/home/hades/.virtualenvs/necromuralist.github.io/lib/python3.12/site-packages/pip/_vendor/pyproject_hooks/_in_process/_in_process.py"&lt;/span&gt;, line 335, &lt;span class="k"&gt;in&lt;/span&gt; main
          json_out&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'return_val'&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; hook&lt;span class="o"&gt;(&lt;/span&gt;**hook_input&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'kwargs'&lt;/span&gt;&lt;span class="o"&gt;])&lt;/span&gt;
                                   &lt;span class="o"&gt;^^^^^^^^^^^^^^^^^^^^^^^^^^^^&lt;/span&gt;
        File &lt;span class="s2"&gt;"/home/hades/.virtualenvs/necromuralist.github.io/lib/python3.12/site-packages/pip/_vendor/pyproject_hooks/_in_process/_in_process.py"&lt;/span&gt;, line 118, &lt;span class="k"&gt;in&lt;/span&gt; get_requires_for_build_wheel
          &lt;span class="k"&gt;return&lt;/span&gt; hook&lt;span class="o"&gt;(&lt;/span&gt;config_settings&lt;span class="o"&gt;)&lt;/span&gt;
                 &lt;span class="o"&gt;^^^^^^^^^^^^^^^^^^^^^&lt;/span&gt;
        File &lt;span class="s2"&gt;"/tmp/pip-build-env-1ai8jd66/overlay/lib/python3.12/site-packages/setuptools/build_meta.py"&lt;/span&gt;, line 325, &lt;span class="k"&gt;in&lt;/span&gt; get_requires_for_build_wheel
          &lt;span class="k"&gt;return&lt;/span&gt; self._get_build_requires&lt;span class="o"&gt;(&lt;/span&gt;config_settings, &lt;span class="nv"&gt;requirements&lt;/span&gt;&lt;span class="o"&gt;=[&lt;/span&gt;&lt;span class="s1"&gt;'wheel'&lt;/span&gt;&lt;span class="o"&gt;])&lt;/span&gt;
                 &lt;span class="o"&gt;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&lt;/span&gt;
        File &lt;span class="s2"&gt;"/tmp/pip-build-env-1ai8jd66/overlay/lib/python3.12/site-packages/setuptools/build_meta.py"&lt;/span&gt;, line 295, &lt;span class="k"&gt;in&lt;/span&gt; _get_build_requires
          self.run_setup&lt;span class="o"&gt;()&lt;/span&gt;
        File &lt;span class="s2"&gt;"/tmp/pip-build-env-1ai8jd66/overlay/lib/python3.12/site-packages/setuptools/build_meta.py"&lt;/span&gt;, line 311, &lt;span class="k"&gt;in&lt;/span&gt; run_setup
          &lt;span class="nb"&gt;exec&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;code, locals&lt;span class="o"&gt;())&lt;/span&gt;
        File &lt;span class="s2"&gt;"&amp;lt;string&amp;gt;"&lt;/span&gt;, line 288, &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;module&amp;gt;
        File &lt;span class="s2"&gt;"/tmp/pip-build-env-1ai8jd66/overlay/lib/python3.12/site-packages/setuptools/__init__.py"&lt;/span&gt;, line 103, &lt;span class="k"&gt;in&lt;/span&gt; setup
          &lt;span class="k"&gt;return&lt;/span&gt; distutils.core.setup&lt;span class="o"&gt;(&lt;/span&gt;**attrs&lt;span class="o"&gt;)&lt;/span&gt;
                 &lt;span class="o"&gt;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&lt;/span&gt;
        File &lt;span class="s2"&gt;"/tmp/pip-build-env-1ai8jd66/overlay/lib/python3.12/site-packages/setuptools/_distutils/core.py"&lt;/span&gt;, line 184, &lt;span class="k"&gt;in&lt;/span&gt; setup
          &lt;span class="k"&gt;return&lt;/span&gt; run_commands&lt;span class="o"&gt;(&lt;/span&gt;dist&lt;span class="o"&gt;)&lt;/span&gt;
                 &lt;span class="o"&gt;^^^^^^^^^^^^^^^^^^&lt;/span&gt;
        File &lt;span class="s2"&gt;"/tmp/pip-build-env-1ai8jd66/overlay/lib/python3.12/site-packages/setuptools/_distutils/core.py"&lt;/span&gt;, line 200, &lt;span class="k"&gt;in&lt;/span&gt; run_commands
          dist.run_commands&lt;span class="o"&gt;()&lt;/span&gt;
        File &lt;span class="s2"&gt;"/tmp/pip-build-env-1ai8jd66/overlay/lib/python3.12/site-packages/setuptools/_distutils/dist.py"&lt;/span&gt;, line 969, &lt;span class="k"&gt;in&lt;/span&gt; run_commands
          self.run_command&lt;span class="o"&gt;(&lt;/span&gt;cmd&lt;span class="o"&gt;)&lt;/span&gt;
        File &lt;span class="s2"&gt;"/tmp/pip-build-env-1ai8jd66/overlay/lib/python3.12/site-packages/setuptools/dist.py"&lt;/span&gt;, line 968, &lt;span class="k"&gt;in&lt;/span&gt; run_command
          super&lt;span class="o"&gt;()&lt;/span&gt;.run_command&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;command&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
        File &lt;span class="s2"&gt;"/tmp/pip-build-env-1ai8jd66/overlay/lib/python3.12/site-packages/setuptools/_distutils/dist.py"&lt;/span&gt;, line 988, &lt;span class="k"&gt;in&lt;/span&gt; run_command
          cmd_obj.run&lt;span class="o"&gt;()&lt;/span&gt;
        File &lt;span class="s2"&gt;"/tmp/pip-build-env-1ai8jd66/overlay/lib/python3.12/site-packages/setuptools/command/egg_info.py"&lt;/span&gt;, line 321, &lt;span class="k"&gt;in&lt;/span&gt; run
          self.find_sources&lt;span class="o"&gt;()&lt;/span&gt;
        File &lt;span class="s2"&gt;"/tmp/pip-build-env-1ai8jd66/overlay/lib/python3.12/site-packages/setuptools/command/egg_info.py"&lt;/span&gt;, line 329, &lt;span class="k"&gt;in&lt;/span&gt; find_sources
          mm.run&lt;span class="o"&gt;()&lt;/span&gt;
        File &lt;span class="s2"&gt;"/tmp/pip-build-env-1ai8jd66/overlay/lib/python3.12/site-packages/setuptools/command/egg_info.py"&lt;/span&gt;, line 550, &lt;span class="k"&gt;in&lt;/span&gt; run
          self.add_defaults&lt;span class="o"&gt;()&lt;/span&gt;
        File &lt;span class="s2"&gt;"/tmp/pip-build-env-1ai8jd66/overlay/lib/python3.12/site-packages/setuptools/command/egg_info.py"&lt;/span&gt;, line 588, &lt;span class="k"&gt;in&lt;/span&gt; add_defaults
          sdist.add_defaults&lt;span class="o"&gt;(&lt;/span&gt;self&lt;span class="o"&gt;)&lt;/span&gt;
        File &lt;span class="s2"&gt;"/tmp/pip-build-env-1ai8jd66/overlay/lib/python3.12/site-packages/setuptools/command/sdist.py"&lt;/span&gt;, line 102, &lt;span class="k"&gt;in&lt;/span&gt; add_defaults
          super&lt;span class="o"&gt;()&lt;/span&gt;.add_defaults&lt;span class="o"&gt;()&lt;/span&gt;
        File &lt;span class="s2"&gt;"/tmp/pip-build-env-1ai8jd66/overlay/lib/python3.12/site-packages/setuptools/_distutils/command/sdist.py"&lt;/span&gt;, line 250, &lt;span class="k"&gt;in&lt;/span&gt; add_defaults
          self._add_defaults_ext&lt;span class="o"&gt;()&lt;/span&gt;
        File &lt;span class="s2"&gt;"/tmp/pip-build-env-1ai8jd66/overlay/lib/python3.12/site-packages/setuptools/_distutils/command/sdist.py"&lt;/span&gt;, line 335, &lt;span class="k"&gt;in&lt;/span&gt; _add_defaults_ext
          self.filelist.extend&lt;span class="o"&gt;(&lt;/span&gt;build_ext.get_source_files&lt;span class="o"&gt;())&lt;/span&gt;
                               &lt;span class="o"&gt;^^^^^^^^^^^^^^^^^^^^^^^^^^^^&lt;/span&gt;
        File &lt;span class="s2"&gt;"&amp;lt;string&amp;gt;"&lt;/span&gt;, line 204, &lt;span class="k"&gt;in&lt;/span&gt; get_source_files
        File &lt;span class="s2"&gt;"/tmp/pip-build-env-1ai8jd66/overlay/lib/python3.12/site-packages/setuptools/_distutils/cmd.py"&lt;/span&gt;, line 107, &lt;span class="k"&gt;in&lt;/span&gt; __getattr__
          raise AttributeError&lt;span class="o"&gt;(&lt;/span&gt;attr&lt;span class="o"&gt;)&lt;/span&gt;
      AttributeError: cython_sources
      &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt; of output&lt;span class="o"&gt;]&lt;/span&gt;

  note: This error originates from a subprocess, &lt;span class="k"&gt;and&lt;/span&gt; is likely &lt;span class="k"&gt;not&lt;/span&gt; a problem with pip.
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Which looked like I was in trouble, but it turned out that re-running the upgrade fixed it. One of those magic fixes that would be scary if this was a critical site, I suppose, but which is instead, just another bit of python mystery.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org6dab3cd" class="outline-2"&gt;
&lt;h2 id="org6dab3cd"&gt;Then a Nikola Error&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org6dab3cd"&gt;
&lt;p&gt;
So, with the virtual environment updated to the current python, I waded back into building the site.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;nikola build
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
First this produced a &lt;code&gt;nikola&lt;/code&gt; not found error (updating the virtual environment apparently doesn't fix everything). But since the environment itself was fixed pip was now working so I installed it again, but then building the site produced a different error.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;DependencyError - taskid:render_posts:cache/posts/2ac-updating-a-nikola-shortcode-plugin.html  
ERROR: Task &lt;span class="s1"&gt;'render_posts:cache/posts/2ac-updating-a-nikola-shortcode-plugin.html'&lt;/span&gt; saving success: Dependent file &lt;span class="s1"&gt;'/home/hades/.virtualenvs/necromuralist.github.io/lib/python3.11/site-packa&lt;/span&gt;
&lt;span class="s1"&gt;ges/nikola/data/shortcodes/mako/raw.tmpl'&lt;/span&gt; does &lt;span class="k"&gt;not&lt;/span&gt; exist.
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Re-reinstalling nikola and re-running the build made the error go away, but in the output I noticed some disturbing messages that looked like these.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;.  render_pages:output/posts/destroying-tags-with-beautiful-soup/index.html
line &lt;span class="m"&gt;135&lt;/span&gt; column &lt;span class="m"&gt;56&lt;/span&gt; - Error: &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;module&amp;gt; is &lt;span class="k"&gt;not&lt;/span&gt; recognized!
line &lt;span class="m"&gt;144&lt;/span&gt; column &lt;span class="m"&gt;56&lt;/span&gt; - Error: &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;module&amp;gt; is &lt;span class="k"&gt;not&lt;/span&gt; recognized!
line &lt;span class="m"&gt;154&lt;/span&gt; column &lt;span class="m"&gt;56&lt;/span&gt; - Error: &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;module&amp;gt; is &lt;span class="k"&gt;not&lt;/span&gt; recognized!
This document has errors that must be fixed before
using HTML Tidy to generate a tidied up version.
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
There were are a lot of these errors (which didn't cause nikola to quit so I wouldn't have seen them if I wasn't watching the build messages).
&lt;/p&gt;

&lt;p&gt;
This turned out to be because nikola was encountering errors, trapping them and not failing and then embedding the python error messages into the HTML (and the error messages were causing HTML tidy to fail and then raise a different error message).
&lt;/p&gt;

&lt;p&gt;
This is an example of an error message embedded in the HTML nikola created:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Traceback&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;most&lt;/span&gt; &lt;span class="n"&gt;recent&lt;/span&gt; &lt;span class="n"&gt;call&lt;/span&gt; &lt;span class="n"&gt;last&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="n"&gt;File&lt;/span&gt; &lt;span class="s2"&gt;"/home/hades/.local/bin/pygmentize"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;module&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;pygments.cmdline&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;main&lt;/span&gt;
&lt;span class="ne"&gt;ModuleNotFoundError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;No&lt;/span&gt; &lt;span class="n"&gt;module&lt;/span&gt; &lt;span class="n"&gt;named&lt;/span&gt; &lt;span class="s1"&gt;'pygments'&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
The cause for this one was a little more mysterious, but it turned out that I had installed &lt;code&gt;pygmentize&lt;/code&gt; using &lt;code&gt;pipx&lt;/code&gt; so it needed to be updated separately. I decided to use &lt;code&gt;pipx reinstall-all&lt;/code&gt; to get everything updated.
&lt;/p&gt;

&lt;p&gt;
Unfortunately, there were a lot of posts with the &lt;code&gt;pygmentize&lt;/code&gt; errors, and since they aren't registered as errors by nikola, just building the site didn't fix them so I wiped it first and then re-built it.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;nikola clean
nikola build
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
And since there weren't anymore errors I decided to cross my fingers and move on.
&lt;/p&gt;

&lt;div class="notecard" id="org9ea6956"&gt;
&lt;p&gt;
&lt;b&gt;&lt;b&gt;Note to future self:&lt;/b&gt;&lt;/b&gt; This happened again with the update to Ubuntu 25.04 (Plucky Puffin) and the error messages from not cleaning the old build were confusing/misleading enough to cause me to waste time troubleshooting them. A clean build is a &lt;i&gt;really&lt;/i&gt; good idea.
&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgf9d15a8" class="outline-2"&gt;
&lt;h2 id="orgf9d15a8"&gt;An Ape-Iron Problem (no distutils)&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgf9d15a8"&gt;
&lt;p&gt;
The &lt;code&gt;vf ls --details&lt;/code&gt; command I used to check on the virtual environment for this site also showed that all my other virtual environments were broken so I decided to try and fix the &lt;code&gt;Ape-Iron&lt;/code&gt; repository while it was fresh on my mind. First I rebuilt the environment.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;vf upgrade --rebuild Ape-Iron
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
And of course, it gave me errors.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Collecting &lt;span class="nv"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;1.24.3
  Downloading numpy-1.24.3.tar.gz &lt;span class="o"&gt;(&lt;/span&gt;10.9 MB&lt;span class="o"&gt;)&lt;/span&gt;
     ââââââââââââââââââââââââââââââââââââââââ 10.9/10.9 MB 7.7 MB/s eta 0:00:00
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
ERROR: Exception:
Traceback &lt;span class="o"&gt;(&lt;/span&gt;most recent call last&lt;span class="o"&gt;)&lt;/span&gt;:
  File &lt;span class="s2"&gt;"/home/hades/.virtualenvs/Ape-Iron/lib/python3.12/site-packages/pip/_internal/cli/base_command.py"&lt;/span&gt;, line 180, &lt;span class="k"&gt;in&lt;/span&gt; exc_logging_wrapper
&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;File &lt;span class="s2"&gt;"/tmp/pip-build-env-f7h7lvcc/overlay/lib/python3.12/site-packages/setuptools/__init__.py"&lt;/span&gt;, line 10, &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;module&amp;gt;
    import distutils.core
ModuleNotFoundError: No module named &lt;span class="s1"&gt;'distutils'&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
According to &lt;a href="https://stackoverflow.com/a/77233866"&gt;this answer&lt;/a&gt; to a question on &lt;i&gt;StackOverflow&lt;/i&gt; &lt;code&gt;distutils&lt;/code&gt; was removed from python 3.12, which is the default with &lt;i&gt;noble-numbat&lt;/i&gt;. The answer suggests installing &lt;a href="https://github.com/pypa/setuptools"&gt;&lt;code&gt;setuptools&lt;/code&gt;&lt;/a&gt;.
&lt;/p&gt;

&lt;p&gt;
So, I tried that.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install setuptools --upgrade
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Amazingly, the upgrade of Ape-Iron seemed to work.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;vf upgrade --rebuild Ape-Iron
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
At this point I think I just called it a day.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org5b4d613" class="outline-2"&gt;
&lt;h2 id="org5b4d613"&gt;Links&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org5b4d613"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;a href="https://virtualfish.readthedocs.io/en/latest/usage.html#upgrading-virtual-environments"&gt;Upgrading Virtual Environments&lt;/a&gt;: Virtualfish Documentation&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/yaml/pyyaml/issues/601"&gt;AttributeError: cython_sources&lt;/a&gt;: A PyYAML bug report that looks related to the error.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>pipx</category><category>ubuntu</category><category>upgrading</category><category>virtualfish</category><guid>https://necromuralist.github.io/posts/noble-numbat-and-the-broken-virtual-environments/</guid><pubDate>Mon, 27 May 2024 23:21:26 GMT</pubDate></item><item><title>Kernel Panic At the Lunar Lobster</title><link>https://necromuralist.github.io/posts/kernel-panic-at-the-lunar-lobster/</link><dc:creator>Cloistered Monkey</dc:creator><description>&lt;div id="table-of-contents" role="doc-toc"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents" role="doc-toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/kernel-panic-at-the-lunar-lobster/#orgcada2e4"&gt;What Is This About?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/kernel-panic-at-the-lunar-lobster/#org837a1de"&gt;First Get It Working&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/kernel-panic-at-the-lunar-lobster/#org07f2575"&gt;Not a Solution But A Finger Pointing&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/kernel-panic-at-the-lunar-lobster/#org3fe35bb"&gt;Blame It On the Drivers&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/kernel-panic-at-the-lunar-lobster/#org42d9bab"&gt;From Nouveau To Nvidia&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/kernel-panic-at-the-lunar-lobster/#orgb63145e"&gt;And the End&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-orgcada2e4" class="outline-2"&gt;
&lt;h2 id="orgcada2e4"&gt;What Is This About?&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgcada2e4"&gt;
&lt;p&gt;
I got a notification yesterday (May 3, 2023) that there's a new version of Ubuntu out (&lt;i&gt;Lunar Lobster - 23.04&lt;/i&gt;) so I ran &lt;code&gt;do-release-upgrade&lt;/code&gt; while watching a video (&lt;a href="https://en.wikipedia.org/wiki/An_Honest_Liar?useskin=vector"&gt;An Honest Liar&lt;/a&gt;) about James Randi. At the end of the upgrade there was some kind of error message about not being able to configure the Linux headers, which in retrospect should have worried me, but I was distracted so I just dismissed it. Then today when I booted up the computer I got an error message saying &lt;code&gt;Kernel Panic - Not syncing: VFS: Unable to mount root fs on unknown-block (0,0)&lt;/code&gt;. I managed to get it working (eventually) but now that Ubuntu's been around long enough and search engines seem to be choked with outdated answers I thought I'd document what I did in case it happens on another update.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-org837a1de" class="outline-2"&gt;
&lt;h2 id="org837a1de"&gt;First Get It Working&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org837a1de"&gt;
&lt;p&gt;
The first thing I tried was to follow the answers on &lt;a href="https://askubuntu.com/questions/41930/kernel-panic-not-syncing-vfs-unable-to-mount-root-fs-on-unknown-block0-0"&gt;this Stackoverflow page&lt;/a&gt;. The only thing this did was get my computer up and running again - which is, I suppose a big thing, not to be minimized, but there's a lot of stuff on that page and the only relevant parts were:
&lt;/p&gt;

&lt;ol class="org-ol"&gt;
&lt;li&gt;Reboot&lt;/li&gt;
&lt;li&gt;At the menu that comes up choose "Advanced Options for Ubuntu"&lt;/li&gt;
&lt;li&gt;Pick a prior version of the Linux kernel (5.19.26 in my case) and let it finish starting up.&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-org07f2575" class="outline-2"&gt;
&lt;h2 id="org07f2575"&gt;Not a Solution But A Finger Pointing&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org07f2575"&gt;
&lt;p&gt;
The first thing I tried from that page was from &lt;a href="https://askubuntu.com/a/939883"&gt;this answer&lt;/a&gt;:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo dpkg --configure -a
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
This gave me &lt;code&gt;error processing package linux-image-6.2.0-generic (--configure)&lt;/code&gt;. So I searched some more and tried the suggestion from &lt;a href="https://askubuntu.com/a/517882"&gt;this askubuntu answer&lt;/a&gt;:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo dpkg --purge linux-image-6.2.0-20-generic
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
This gives an error along the lines of "&lt;code&gt;dependency problems, not purging&lt;/code&gt;". Oi. So then I tried:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt autoremove
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
This gave me another error:
&lt;/p&gt;

&lt;p&gt;
&lt;img src="https://necromuralist.github.io/posts/kernel-panic-at-the-lunar-lobster/purge-error.webp" alt="Purge Error" loading="lazy"&gt;
&lt;/p&gt;

&lt;p&gt;
This time in the error message it said to check out &lt;code&gt;/var/lib/dkms/nvidia/510.108.03/build/make.log&lt;/code&gt; which turned out not to have any useful information (to me, anyway) but it did tell me that there was something going on with my nvidia drivers that was causing the configuration of the new Linux kernel to fail.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-org3fe35bb" class="outline-2"&gt;
&lt;h2 id="org3fe35bb"&gt;Blame It On the Drivers&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org3fe35bb"&gt;
&lt;p&gt;
&lt;i&gt;"Something going on with my nvidia drivers"&lt;/i&gt; being a little too vague for me to troubleshoot, I decided to go the brute force way and uninstall the nvidia-drivers. This actually proved a little harder than I thought it would be (which seems to always be the case, maybe I'm too optimistic about this kind of stuff). Every time I tried to run
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt remove nvidia-driver-510
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
&lt;code&gt;apt&lt;/code&gt; would try and configure the Linux kernel and run into the same error that I had before and exit without uninstalling the driver. Some kind of chicken and the egg thing. So then I tried &lt;code&gt;dpkg&lt;/code&gt; instead of &lt;code&gt;apt&lt;/code&gt; first:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo dpkg --purge nvidia-driver-510
sudo apt autoremove
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
&lt;code&gt;dpkg&lt;/code&gt; managed to uninstall the driver and running &lt;code&gt;apt autoremove&lt;/code&gt; not only cleaned out the unused packages but also triggered the kernel configuration and this timeâ¦ no errors.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-org42d9bab" class="outline-2"&gt;
&lt;h2 id="org42d9bab"&gt;From Nouveau To Nvidia&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org42d9bab"&gt;
&lt;p&gt;
After a reboot it started up okay and this time &lt;code&gt;uname -r&lt;/code&gt; showed that I was using the newer kernel (&lt;code&gt;6.2.0-20-generic&lt;/code&gt;). Yay. But now when I tried to re-install the nvidia drivers neither &lt;code&gt;ubuntu-drivers&lt;/code&gt; nor &lt;code&gt;apt&lt;/code&gt; seemed to know that they existed. It turns out that updating the ubuntu installation removes the proprietary drivers from the apt sources. So I launched the "Software &amp;amp; Updates" GUI.
&lt;/p&gt;

&lt;p&gt;
&lt;img src="https://necromuralist.github.io/posts/kernel-panic-at-the-lunar-lobster/software-updates.webp" alt="Software &amp;amp; Updates" loading="lazy"&gt;
&lt;/p&gt;

&lt;p&gt;
And checked the "Proprietary drivers for devices (restricted)" button.
&lt;/p&gt;

&lt;p&gt;
&lt;img src="https://necromuralist.github.io/posts/kernel-panic-at-the-lunar-lobster/proprietary-drivers.webp" alt="Proprietary Drivers" loading="lazy"&gt;
&lt;/p&gt;

&lt;p&gt;
I chose to update the apt listing when I closed the GUI and then installed the drivers at the command line:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo ubuntu-drivers install
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
And then, after another reboot, now it works (I checked with &lt;code&gt;nvidia-smi&lt;/code&gt;).
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-orgb63145e" class="outline-2"&gt;
&lt;h2 id="orgb63145e"&gt;And the End&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgb63145e"&gt;
&lt;p&gt;
I haven't run any tests other than using the system but this seems to have fixed the problem. Well, the problem with the kernel, updating also broke all my python virtual environments, but, oh, well, better than a kernel panic, I suppose.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>nvidia</category><category>ubuntu</category><guid>https://necromuralist.github.io/posts/kernel-panic-at-the-lunar-lobster/</guid><pubDate>Wed, 03 May 2023 23:20:07 GMT</pubDate></item><item><title>Using Systemd To Enable Wake-On-Lan</title><link>https://necromuralist.github.io/posts/using-systemd-to-enable-wake-on-lan/</link><dc:creator>Cloistered Monkey</dc:creator><description>&lt;div id="table-of-contents" role="doc-toc"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents" role="doc-toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/using-systemd-to-enable-wake-on-lan/#orgd42d165"&gt;What is this about?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/using-systemd-to-enable-wake-on-lan/#orgc8a5bf1"&gt;So, how do you do it?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/using-systemd-to-enable-wake-on-lan/#org25850e5"&gt;So, That Fixed It?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/using-systemd-to-enable-wake-on-lan/#org263d19a"&gt;Where did you find out about this?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgd42d165" class="outline-2"&gt;
&lt;h2 id="orgd42d165"&gt;What is this about?&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgd42d165"&gt;
&lt;p&gt;
I made a previous post (&lt;a href="https://necromuralist.github.io/posts/enabling-wake-on-lan/"&gt;Enabling Wake-On-LAN (In Ubuntu 20.10)&lt;/a&gt;) about enabling Wake-On-LAN on my server, but it didn't seem to work after a re-boot. I looked in the logs using &lt;a href="https://www.commandlinux.com/man-page/man1/journalctl.1.html"&gt;journalctl&lt;/a&gt; and noticed that the &lt;code&gt;wol.service&lt;/code&gt; that I set up didn't get enabled after the re-boot. I thought about it and I remembered that when I was working with bluetooth and set up a service for it I had to make it wait for the bluetooth service to start first or it wouldn't work and realized that there was nothing in the &lt;code&gt;wol.service&lt;/code&gt; file to tell it to wait so I went poking around and found what I hope to be a fix.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgc8a5bf1" class="outline-2"&gt;
&lt;h2 id="orgc8a5bf1"&gt;So, how do you do it?&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgc8a5bf1"&gt;
&lt;p&gt;
We need to update the &lt;code&gt;/etc/systemd/system/wol.service&lt;/code&gt; that I created in that earlier post. Previously it looked like this:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[Unit]&lt;/span&gt;
&lt;span class="na"&gt;Description&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;Enable Wake On Lan&lt;/span&gt;

&lt;span class="k"&gt;[Service]&lt;/span&gt;
&lt;span class="na"&gt;Type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;oneshot&lt;/span&gt;
&lt;span class="na"&gt;ExecStart&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;/sbin/ethtool --change enp4s0 wol g&lt;/span&gt;

&lt;span class="k"&gt;[Install]&lt;/span&gt;
&lt;span class="na"&gt;WantedBy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;basic.target&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
We need to update the &lt;code&gt;[Unit]&lt;/code&gt; section by adding
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="na"&gt;Requires&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;network.target&lt;/span&gt;
&lt;span class="na"&gt;After&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;network.target&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
To let systemd know that we don't want this to run until after the network service has run. I also changed the &lt;code&gt;WantedBy&lt;/code&gt;  to &lt;code&gt;multi-user.target&lt;/code&gt;. So the updated file looks like this:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[Unit]&lt;/span&gt;
&lt;span class="na"&gt;Description&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;Enable Wake On Lan&lt;/span&gt;
&lt;span class="na"&gt;Requires&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;network.target&lt;/span&gt;
&lt;span class="na"&gt;After&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;network.target&lt;/span&gt;

&lt;span class="k"&gt;[Service]&lt;/span&gt;
&lt;span class="na"&gt;Type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;oneshot&lt;/span&gt;
&lt;span class="na"&gt;ExecStart&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;/sbin/ethtool --change enp4s0 wol g&lt;/span&gt;

&lt;span class="k"&gt;[Install]&lt;/span&gt;
&lt;span class="na"&gt;WantedBy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;multi-user.target&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Now reload the daemon and re-enable it.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo systemctl daemon-reload
sudo systemctl enable wol.service
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
To make sure I didn't introduce any errors I ran it once.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo systemctl start wol
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Then I rebooted it.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo reboot now
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
This time in journalctl I saw this:
&lt;/p&gt;

&lt;pre class="example" id="org42bca8e"&gt;
Dec 07 00:02:17 erebus systemd[1]: Finished Enable Wake On Lan.
Dec 07 00:02:17 erebus systemd[1]: wol.service: Succeeded.
&lt;/pre&gt;

&lt;p&gt;
And running &lt;code&gt;ethtool&lt;/code&gt; showed that it was enabled.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Wake-on: g
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org25850e5" class="outline-2"&gt;
&lt;h2 id="org25850e5"&gt;So, That Fixed It?&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org25850e5"&gt;
&lt;p&gt;
Well, insofar as it's working now, yes. But since I change more than one thing I don't really know exactly what did it (was it one of the three lines I changed or all of them?). Anyway, since it works I'll let it lie for now.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org263d19a" class="outline-2"&gt;
&lt;h2 id="org263d19a"&gt;Where did you find out about this?&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org263d19a"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;The Arch wiki has a page on &lt;a href="https://wiki.archlinux.org/index.php/Wake-on-LAN"&gt;Wake-On-LAN&lt;/a&gt; that tells you many different ways to set it up â I copied the systemd file almost exactly. It has quite a bit of useful information (too much maybe), but not all the commands will work out of the box on Ubuntu (because it's Arch).&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>how-to</category><category>networking</category><category>systemd</category><category>ubuntu</category><guid>https://necromuralist.github.io/posts/using-systemd-to-enable-wake-on-lan/</guid><pubDate>Sun, 06 Dec 2020 23:10:53 GMT</pubDate></item><item><title>Enabling Wake-On-LAN (In Ubuntu 20.10)</title><link>https://necromuralist.github.io/posts/enabling-wake-on-lan/</link><dc:creator>Cloistered Monkey</dc:creator><description>&lt;div id="table-of-contents" role="doc-toc"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents" role="doc-toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/enabling-wake-on-lan/#orgfc17bdf"&gt;Beginning&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/enabling-wake-on-lan/#org1a76fce"&gt;Middle&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/enabling-wake-on-lan/#org5a312a4"&gt;Ethtool&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/enabling-wake-on-lan/#orgeace4b9"&gt;Checking the Interface&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/enabling-wake-on-lan/#orgeccb60d"&gt;Turn It On Temporarily&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/enabling-wake-on-lan/#org0d0ab69"&gt;Test It Out&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/enabling-wake-on-lan/#orge9ce366"&gt;Take Two&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/enabling-wake-on-lan/#orgdcfa6d6"&gt;Making It Permanent&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/enabling-wake-on-lan/#org2d468bd"&gt;End&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;p&gt;
&lt;b&gt;&lt;b&gt;Note:&lt;/b&gt;&lt;/b&gt; The systemd configuration here isn't quite right, but since this post is kind of long and convoluted I made a standalone update about the systemd configuration file in &lt;a href="https://necromuralist.github.io/posts/using-systemd-to-enable-wake-on-lan/"&gt;this post&lt;/a&gt;.
&lt;/p&gt;

&lt;div id="outline-container-orgfc17bdf" class="outline-2"&gt;
&lt;h2 id="orgfc17bdf"&gt;Beginning&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgfc17bdf"&gt;
&lt;p&gt;
These are my notes on getting &lt;a href="https://en.wikipedia.org/wiki/Wake-on-LAN"&gt;Wake-On-LAN&lt;/a&gt; working in Ubuntu 20.10. I have a server that I use to run most of the computation on when I use emacs/jupyter but I have it in a corner upstairs and although it's only a little walk, I find that the fact that I have to stop what I'm doing and go upstairs to push that little button on the front makes me lazy and so it ends up running more than it has to so I thought I'd enable Wake-On-LAN so I can suspend it and wake it up whenever I need to. I'm only going to use suspend (&lt;a href="https://en.wikipedia.org/wiki/Advanced_Configuration_and_Power_Interface"&gt;APM&lt;/a&gt; S3). When I tried to use hibernate (S4) it ended up shutting down my machine (S5). Interestingly, my BIOS menu has an option to enable waking up from shutdown, but since my disk is encrypted, and I didn't set up a separate SSH server, I have to go enter the passphrase to unlock the disk before the operating system can boot up, so it kind of defeats its own purpose.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org1a76fce" class="outline-2"&gt;
&lt;h2 id="org1a76fce"&gt;Middle&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org1a76fce"&gt;
&lt;/div&gt;
&lt;div id="outline-container-org5a312a4" class="outline-3"&gt;
&lt;h3 id="org5a312a4"&gt;Ethtool&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org5a312a4"&gt;
&lt;p&gt;
The command I used to set up Wake-On-LAN on the remote machine is called &lt;a href="https://en.wikipedia.org/wiki/Ethtool"&gt;ethtool&lt;/a&gt;. It's in the Ubuntu repositories but wasn't installed on my machine so I had to add it.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt install ethtool
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgeace4b9" class="outline-3"&gt;
&lt;h3 id="orgeace4b9"&gt;Checking the Interface&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-orgeace4b9"&gt;
&lt;p&gt;
From what I've read, not all ethernet interfaces support Wake-On-LAN (although I've never seen one that doesn't) so a quick check might be useful. First, find the name of your ethernet interface.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ip a
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
My machine shows four interfaces so I'll just show the output for the interface I'm interested in rather than the whole output for the command.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;2: enp4s0: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 38:d5:47:79:ab:0b brd ff:ff:ff:ff:ff:ff
    inet 192.168.86.97/24 brd 192.168.86.255 scope global dynamic noprefixroute enp4s0
       valid_lft 84752sec preferred_lft 84752sec
    inet6 fe80::685d:374d:a577:f787/64 scope link noprefixroute 
       valid_lft forever preferred_lft forever
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Ethtool uses the name of the interface, in this case it's &lt;code&gt;enp4s0&lt;/code&gt;, so we'll need to note that. Additionally, the machine that I used to wake up the machine needs the MAC address (&lt;code&gt;38:d5:47:79:ab:0b&lt;/code&gt;) so it'd be useful to write that down someplace. I'm waking it up from the LAN so the IP address isn't so important, and to be able to SSH into it I need to know it anyway, so it's really those two pieces of information that I need. Now to check if it supports Wake-On-LAN.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo ethtool enp4s0
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Ethtool will give you some information if you don't run it as root but for Wake-On-LAN you need to run it as root. The important lines in the output is near the bottom and it looks something like this if it supports Wake-On-LAN.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Supports Wake-on: pumbg
Wake-on: d
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
The man-page for &lt;code&gt;ethtool&lt;/code&gt; tell you what that cryptic &lt;code&gt;pumbg&lt;/code&gt; means - the letters are different options that this interface supports for Wake-On-LAN. In this case they are:
&lt;/p&gt;

&lt;table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides"&gt;


&lt;colgroup&gt;
&lt;col class="org-left"&gt;

&lt;col class="org-left"&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th scope="col" class="org-left"&gt;Option&lt;/th&gt;
&lt;th scope="col" class="org-left"&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td class="org-left"&gt;p&lt;/td&gt;
&lt;td class="org-left"&gt;Wake on PHY activity&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td class="org-left"&gt;u&lt;/td&gt;
&lt;td class="org-left"&gt;Wake on unicast messages&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td class="org-left"&gt;m&lt;/td&gt;
&lt;td class="org-left"&gt;Wake on multicast messages&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td class="org-left"&gt;b&lt;/td&gt;
&lt;td class="org-left"&gt;Wake on broadcast messages&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td class="org-left"&gt;g&lt;/td&gt;
&lt;td class="org-left"&gt;Wake on MagicPacket messages&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;
There's an additional option which is what the interface was set on â &lt;code&gt;d&lt;/code&gt; â as you can see in the last line of the output. This means &lt;i&gt;Disable (wake on nothing).  This option clears all previous options.&lt;/i&gt; I don't have many devices on my network, so I don't know that there's a lot of broadcasts, multicasts, etc. that would be waking it up all the time, but since one feature of Wake-On-LAN is that it only wakes the machine when it gets the "Magic Packet", only the &lt;code&gt;g&lt;/code&gt; and &lt;code&gt;d&lt;/code&gt; options matter. Now that I knew it was supported, it was time to try it out.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-orgeccb60d" class="outline-3"&gt;
&lt;h3 id="orgeccb60d"&gt;Turn It On Temporarily&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-orgeccb60d"&gt;
&lt;p&gt;
The &lt;code&gt;ethtool&lt;/code&gt; will turn on Wake-On-LAN, but (supposedly) everytime you reboot the machine it will reset to disabled. I haven't really tested this out, but I'll document how to make it permanent later, anyway.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo ethtool --change enp4s0 wol g
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
So, as you might guess, we changed the Wake-On-LAN setting to listen for MagicPacket messages. You can check using the ethtool again.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo ethtool enp4s0
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
The &lt;code&gt;Wake-on&lt;/code&gt; line should have changed to:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Wake-on: g
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Now to suspend the machine so we can test it out.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo systemctl suspend
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org0d0ab69" class="outline-3"&gt;
&lt;h3 id="org0d0ab69"&gt;Test It Out&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org0d0ab69"&gt;
&lt;p&gt;
Now, on my local machine I needed to install &lt;a href="https://github.com/jpoliv/wakeonlan"&gt;wakeonlan&lt;/a&gt;. There's a surprising number of programs to send the Magic Packet, but this just happened to be the one I used.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt install wakeonlan
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
The default way to use &lt;code&gt;wakeonlan&lt;/code&gt; is apparently to just pass it the MAC address of the computer to wake up, and it will send the Magic Packet out as a broadcast, so that's what I did.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;wakeonlan 38:d5:47:79:ab:0b
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
And then I pinged the machine and I waited. And I waited. And I waitedâ¦ Eventually I went upstairs and saw that it was still sleeping so I pushed the power button to wake it up and went back downstairs.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orge9ce366" class="outline-3"&gt;
&lt;h3 id="orge9ce366"&gt;Take Two&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-orge9ce366"&gt;
&lt;p&gt;
Something wasn't right so I SSHd into the server and started up &lt;a href="https://www.tcpdump.org/"&gt;tcpdump&lt;/a&gt; to see if the packets were going through.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo tcpdump -i enp4s0 '(udp and port 7) or (udp and port 9)'
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Which gave me this output:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on enp4s0, link-type EN10MB (Ethernet), capture size 262144 bytes
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
And then I sent the Magic Packet again.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;wakeonlan 38:d5:47:79:ab:0b
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
â¦And nothing happened. For some reason the packets weren't getting picked up by the machine. Luckily, &lt;code&gt;wakeonlan&lt;/code&gt; lets you pass in an IP address as an option. The man page recommends using a broadcast address, but I have the IP addresses of my machines on the LAN reserved on my router/access-point so I just passed in the full address (I did try the LAN broadcast and it worked too).
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;wakeonlan -i erebus 38:d5:47:79:ab:0b
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
I have my machine's IP address aliased in my &lt;code&gt;/etc/hosts&lt;/code&gt; file so &lt;code&gt;erebus&lt;/code&gt; is just an alias for the machine's IP address. The subnet broadcast version looked like this.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;wakeonlan -i 192.168.86.255 38:d5:47:79:ab:0b
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
The output from &lt;code&gt;tcpdump&lt;/code&gt; for the first packet looked like this.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on enp4s0, link-type EN10MB (Ethernet), capture size 262144 bytes
20:47:11.689587 IP 192.168.86.141.34805 &amp;gt; erebus.discard: UDP, length 102
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
So, something was different. I suspended the machine again and sent the Magic Packet and this time it worked. Go figure.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-orgdcfa6d6" class="outline-3"&gt;
&lt;h3 id="orgdcfa6d6"&gt;Making It Permanent&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-orgdcfa6d6"&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgefa6863" class="outline-4"&gt;
&lt;h4 id="orgefa6863"&gt;Set It Up&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-orgefa6863"&gt;
&lt;p&gt;
The reasons that I said earlier that the Wake-On-LAN setting "supposedly" is temporary is that:
&lt;/p&gt;
&lt;ol class="org-ol"&gt;
&lt;li&gt;I haven't really re-booted that machine to test it out (I have rebooted, but I haven't disable the &lt;a href="https://en.wikipedia.org/wiki/Systemd"&gt;systemd&lt;/a&gt; service that I'm documenting here).&lt;/li&gt;
&lt;li&gt;The machine that I'm typing this on had Wake-On-LAN enabled and it doesn't have a &lt;code&gt;systemd&lt;/code&gt; service enabled.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;
But, really, I don't remember even enabling Wake-On-LAN on this machine so maybe it just was the default and I didn't realise itâ¦ another thing I should look into one of these days. Anyway, to make a service that always enables Wake-On-LAN the first step is to find the path to &lt;code&gt;ethtool&lt;/code&gt;.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;which ethtool
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
In my case the path was &lt;code&gt;/sbin/ethtool&lt;/code&gt;, so once you know this you can create a file at &lt;code&gt;/etc/systemd/system/wol.service&lt;/code&gt; (I think you can use another systemd sub-folder, and you can name the file anything you want, within reason, but this one seems to work well enough). In this file you put settings that look something like this:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[Unit]&lt;/span&gt;
&lt;span class="na"&gt;Description&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;Enable Wake On Lan&lt;/span&gt;

&lt;span class="k"&gt;[Service]&lt;/span&gt;
&lt;span class="na"&gt;Type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;oneshot&lt;/span&gt;
&lt;span class="na"&gt;ExecStart&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;/sbin/ethtool --change enp4s0 wol g&lt;/span&gt;

&lt;span class="k"&gt;[Install]&lt;/span&gt;
&lt;span class="na"&gt;WantedBy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;basic.target&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
The only thing specific to my machine is &lt;code&gt;enp4s0&lt;/code&gt;, the name of the ethernet interface, although it's possible that the path to the &lt;code&gt;ethtool&lt;/code&gt; executable might be different tooâ¦ but it should be the same on Ubuntu 20.10, anyway.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-org034b6e1" class="outline-4"&gt;
&lt;h4 id="org034b6e1"&gt;Enable The Service&lt;/h4&gt;
&lt;div class="outline-text-4" id="text-org034b6e1"&gt;
&lt;p&gt;
To enable it you can do this:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo systemctl daemon-reload
sudo systemctl enable wol.service
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Where &lt;code&gt;wol.service&lt;/code&gt; is the name of the file you created with the settings. You can check its status if you want.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;systemctl status wol
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
And that's that.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org2d468bd" class="outline-2"&gt;
&lt;h2 id="org2d468bd"&gt;End&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org2d468bd"&gt;
&lt;p&gt;
So, that's how I got one machine working with Wake-On-LAN. Hopefully I won't have to look so hard the next time. Here's the pages that I stole this from.
&lt;/p&gt;

&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;a href="https://www.techrepublic.com/article/how-to-enable-wake-on-lan-in-ubuntu-server-18-04/"&gt;TechRepublic&lt;/a&gt; on using &lt;code&gt;ethtool&lt;/code&gt; and setting up a &lt;code&gt;systemd&lt;/code&gt; service for this (don't use the systemd file here, though).&lt;/li&gt;
&lt;li&gt;&lt;a href="https://askubuntu.com/questions/1792/how-can-i-suspend-hibernate-from-command-line"&gt;Stack Overflow&lt;/a&gt; on how to suspend and hibernate from the command-line&lt;/li&gt;
&lt;li&gt;&lt;a href="https://askubuntu.com/questions/3369/what-is-the-difference-between-hibernate-and-suspend"&gt;Stack Overflow&lt;/a&gt; on what the difference is between suspend and hibernate&lt;/li&gt;
&lt;li&gt;&lt;a href="https://unix.stackexchange.com/questions/318137/wake-on-lan-not-working-on-ubuntu-16-04"&gt;Stack Overflow&lt;/a&gt; on using &lt;code&gt;tcpdump&lt;/code&gt; to look for the Magic Packets on the remote machine&lt;/li&gt;
&lt;li&gt;&lt;a href="https://stackoverflow.com/questions/2177687/open-file-via-ssh-and-sudo-with-emacs"&gt;Stack Overflow&lt;/a&gt; on editing remote files as root with emacs (not documented here, but maybe later)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://stackoverflow.com/questions/95631/open-a-file-with-su-sudo-inside-emacs"&gt;Stack Overflow&lt;/a&gt; on editing a local file as root with emacs (not used here, but I can never remember the syntax)&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>networking</category><category>ubuntu</category><guid>https://necromuralist.github.io/posts/enabling-wake-on-lan/</guid><pubDate>Sun, 29 Nov 2020 01:57:35 GMT</pubDate></item><item><title>Changing the First Day of the Week in Ubuntu 20.04</title><link>https://necromuralist.github.io/posts/changing-the-first-day-of-the-week-in-ubuntu-2004/</link><dc:creator>Cloistered Monkey</dc:creator><description>&lt;div id="outline-container-org2c9c49c" class="outline-2"&gt;
&lt;h2 id="org2c9c49c"&gt;Beginning&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org2c9c49c"&gt;
&lt;p&gt;
I like to have my calendars set up with Monday as the first day of the week, but being that I live in the United States most calendars default to starting the week on Sunday - including the Gnome calendar applet - and while searching pulls up quite a number of pages about how to do it, no one of them quite worked for me so I'm documenting what did work. 
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-org74bb130" class="outline-2"&gt;
&lt;h2 id="org74bb130"&gt;Making the Changes&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org74bb130"&gt;
&lt;p&gt;
First, over at &lt;a href="http://www.beginninglinux.com/home/gnome/change-first-day-of-week-to-monday-on-ubuntu-gnome-calendar"&gt;Beginning Linux&lt;/a&gt; they mentioned that you can find out which file to edit using the &lt;a href="https://man7.org/linux/man-pages/man1/locale.1.html"&gt;locale&lt;/a&gt; command.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# run this in the shell&lt;/span&gt;
locale&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;LANG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre class="example"&gt;
LANG=en_US.UTF-8
&lt;/pre&gt;


&lt;p&gt;
The second line above (&lt;code&gt;LANG=en_US.UTF-8&lt;/code&gt;) is the output of the command and what we need to note here is that &lt;code&gt;en_US.UTF-8&lt;/code&gt; means that there's a file in &lt;code&gt;/usr/share/i18n/locales/&lt;/code&gt; named &lt;code&gt;en_US&lt;/code&gt; that's being used for my configuration so I made a copy of that file (in case I messed something up) and the opened it up in emacs (any changes you make in this directory have to be done as root). 
&lt;/p&gt;

&lt;p&gt;
Now, what that Beginning Linux post and most other posts say to do is to change the line &lt;code&gt;first_weekday 1&lt;/code&gt; (meaning start on Sunday) to &lt;code&gt;first_weekday 2&lt;/code&gt; (start on Monday). The problem with this is that the &lt;code&gt;en_US&lt;/code&gt; file no longer has that line in it, so you have to add it. Not a big deal, I thought, so I added it as the last line in the file and re-generated the configuration using the &lt;a href="http://manpages.ubuntu.com/manpages/focal/man8/locale-gen.8.html"&gt;locale-gen&lt;/a&gt; command.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;locale-gen
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Which gave me errors like this:
&lt;/p&gt;

&lt;pre class="example" id="orgee925e0"&gt;
Generating locales (this might take a while)...
  en_AG.UTF-8...failed to set locale!
en_US:180: syntax error: not inside a locale definition section
 done
&lt;/pre&gt;

&lt;p&gt;
It turns out that the file is actually broken into sections and you can't just stick the line any old place, you have to stick it in the right block. If you look in one of the other files that has the line (pick one by grepping &lt;code&gt;first_weekday&lt;/code&gt;) you'll see that the block we want starts with  &lt;code&gt;LC_TIME&lt;/code&gt; and ends with &lt;code&gt;END LC_TIME&lt;/code&gt; so I put the line in at the end of the block like so:
&lt;/p&gt;

&lt;pre class="example" id="orge623e75"&gt;
% Define the first day of the week to be displayed in a calendar.
% This weekday is relative to the date defined in the &amp;lt;week&amp;gt; keyword.

first_weekday 2
END LC_TIME
&lt;/pre&gt;

&lt;p&gt;
I copied the comments from one of the Ukranian settings files. I picked Ukranian because I thought UK stood for United Kingdom, but it turns out they use GB to indicate Great Britain instead - anyway, it works. The comment suggests that you might also be able to change the &lt;code&gt;week&lt;/code&gt; definition instead of adding this line, but here's what that line looks like.
&lt;/p&gt;

&lt;pre class="example" id="org74a0b49"&gt;
week 7;19971130;1
&lt;/pre&gt;

&lt;p&gt;
It seems safer to stick with the &lt;code&gt;first_weekday&lt;/code&gt;.
&lt;/p&gt;

&lt;p&gt;
Next I re-ran the locale-gen command.
&lt;/p&gt;

&lt;pre class="example" id="org1070348"&gt;
sudo locale-gen
&lt;/pre&gt;

&lt;p&gt;
And this time it ran without errors. 
&lt;/p&gt;

&lt;p&gt;
So, all fixed, then, right? Well, not quite, because this doesn't update the GUI. There are, once again, many pages telling you how to reload the GUI without logging out, but some, like the Beginning Linux page use names of processes or commands that don't seem to exist any more, or, in one case caused the GUI to raise an error message so I decided it wasn't really worth it to mess with the GUI like that when all you have to do is log out and back in - or not care about it until the next time you log in. 
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgc04e7db" class="outline-2"&gt;
&lt;h2 id="orgc04e7db"&gt;The End&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgc04e7db"&gt;
&lt;p&gt;
Part of the motivation for writing this is that it took me more time searching for what worked than it did to make the actual change so maybe next time I'll remember that I wrote this down if I ever have to do this again, which I'm sure I will.
&lt;/p&gt;

&lt;p&gt;
As a final note I should mention that the accepted answer to this post &lt;a href="https://askubuntu.com/questions/197613/monday-as-first-day-in-gnome-shell-instead-of-sunday"&gt;on Stack Overflow&lt;/a&gt; pretty much tells you what to do, it's only missing telling you how to double-check which file to edit, but I didn't find it until after I'd made the changes. Also this page on &lt;a href="https://linuxconfig.org/how-to-restart-gui-on-ubuntu-20-04-focal-fossa"&gt;Linux Config&lt;/a&gt; has things to try to restart the GUI without logging out, but trying Method 3 (restarting the gnome-shell) is what gave me the error, but if for some reason you really can't log out and you need the week to start on Monday right now, maybe it's something to try.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>ubuntu</category><guid>https://necromuralist.github.io/posts/changing-the-first-day-of-the-week-in-ubuntu-2004/</guid><pubDate>Thu, 13 Aug 2020 02:00:04 GMT</pubDate></item><item><title>Encrypt Dropbox Folders on Ubuntu With CryFS</title><link>https://necromuralist.github.io/posts/encrypt-dropbox-folders-on-ubuntu/</link><dc:creator>Cloistered Monkey</dc:creator><description>&lt;div id="table-of-contents" role="doc-toc"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents" role="doc-toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/encrypt-dropbox-folders-on-ubuntu/#org4845bbc"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/encrypt-dropbox-folders-on-ubuntu/#orgf464dd8"&gt;Encrypt the Folders&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/encrypt-dropbox-folders-on-ubuntu/#org51e7fb9"&gt;Install It&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/encrypt-dropbox-folders-on-ubuntu/#org6b4314a"&gt;Create the Target and Source Folders&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/encrypt-dropbox-folders-on-ubuntu/#org24eaca8"&gt;Unmount It&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/encrypt-dropbox-folders-on-ubuntu/#org1421c74"&gt;References&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org4845bbc" class="outline-2"&gt;
&lt;h2 id="org4845bbc"&gt;Introduction&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org4845bbc"&gt;
&lt;p&gt;
This is one way to encrypt the contents for cloud-synchronized folders using &lt;a href="https://www.cryfs.org/"&gt;CryFS&lt;/a&gt;. I'm going to illustrate it using the &lt;code&gt;Dropbox&lt;/code&gt; folder that the &lt;a href="https://www.dropbox.com/"&gt;dropbox client&lt;/a&gt; creates.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgf464dd8" class="outline-2"&gt;
&lt;h2 id="orgf464dd8"&gt;Encrypt the Folders&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgf464dd8"&gt;
&lt;/div&gt;
&lt;div id="outline-container-org51e7fb9" class="outline-3"&gt;
&lt;h3 id="org51e7fb9"&gt;Install It&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org51e7fb9"&gt;
&lt;p&gt;
Ubuntu currently (November 10, 2018) has &lt;code&gt;CryFS&lt;/code&gt; as part of its packages so you can install it with apt.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt install cryfs
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org6b4314a" class="outline-3"&gt;
&lt;h3 id="org6b4314a"&gt;Create the Target and Source Folders&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org6b4314a"&gt;
&lt;p&gt;
The &lt;code&gt;cryfs&lt;/code&gt; command will create the two folders and set them up for you. The syntax is &lt;code&gt;cryfs &amp;lt;target&amp;gt; &amp;lt;source&amp;gt;&lt;/code&gt;. The &lt;code&gt;target&lt;/code&gt; will contain the encrypted folders so it will go in the Dropbox folder, while the &lt;code&gt;source&lt;/code&gt; will hold the unencrypted files.
&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cryfs Dropbox/encrypted dropbox_source
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
This is the same command you would use on another computer to set-up the existing encrypted folder on your new computer. The &lt;code&gt;source&lt;/code&gt; folder can be named differently, but the &lt;code&gt;target&lt;/code&gt; folder and the password need to be the same one you used when you created it. The files in the &lt;code&gt;source&lt;/code&gt; go away when you unmount it (see &lt;a href="https://necromuralist.github.io/posts/encrypt-dropbox-folders-on-ubuntu/#org24eaca8"&gt;below&lt;/a&gt;) so you will have to re-mount it whenever you unmount it or log out or restart your computer.
&lt;/p&gt;

&lt;p&gt;
&lt;b&gt;&lt;b&gt;Note:&lt;/b&gt;&lt;/b&gt; The &lt;a href="https://www.cryfs.org/tutorial"&gt;cryfs tutorial&lt;/a&gt; has a warning that if two different computers access the mounted folder at the same time it can corrupt the files so you have to make sure to unmount it on one computer before mounting it on another. This seems like a really bad thing, but I guess you should/oughta make backups of the unencrypted stuff just in case.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org24eaca8" class="outline-3"&gt;
&lt;h3 id="org24eaca8"&gt;Unmount It&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org24eaca8"&gt;
&lt;p&gt;
The old way to unmount it was using &lt;a href="http://manpages.ubuntu.com/manpages/cosmic/man1/fusermount.1.html"&gt;fusermount&lt;/a&gt; but they've added a &lt;code&gt;cryfs-unmount&lt;/code&gt; command which you can/should use instead.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cryfs-unmount dropbox_source
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
This was the old way.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;fusermount -u dropbox_source
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Since you are doing all this within your home directory you don't need root privileges (except to install &lt;code&gt;cryfs&lt;/code&gt; with apt).
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org1421c74" class="outline-2"&gt;
&lt;h2 id="org1421c74"&gt;References&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org1421c74"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;I got this from &lt;a href="https://www.linuxbabe.com/ubuntu/encrypt-dropbox-ubuntu-16-04-17-10-desktop-server"&gt;Linux Babe&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;But the &lt;a href="https://www.cryfs.org/tutorial"&gt;CryFS Tutorial&lt;/a&gt; is pretty straight-forward, it just skips the part about installing cryfs.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>dropbox</category><category>encryption</category><category>linux</category><category>ubuntu</category><guid>https://necromuralist.github.io/posts/encrypt-dropbox-folders-on-ubuntu/</guid><pubDate>Mon, 10 Dec 2018 20:41:05 GMT</pubDate></item><item><title>Using Nvidia Drivers in Ubuntu 18.10</title><link>https://necromuralist.github.io/posts/using-nvidia-drivers-in-ubuntu-1810/</link><dc:creator>Cloistered Monkey</dc:creator><description>&lt;div id="table-of-contents" role="doc-toc"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents" role="doc-toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/using-nvidia-drivers-in-ubuntu-1810/#org7df380f"&gt;What is this about?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/using-nvidia-drivers-in-ubuntu-1810/#org2f4aa20"&gt;What didn't work?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/using-nvidia-drivers-in-ubuntu-1810/#org9576ff9"&gt;So what did work?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org7df380f" class="outline-2"&gt;
&lt;h2 id="org7df380f"&gt;What is this about?&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org7df380f"&gt;
&lt;p&gt;
I had previously found that after upgrading from Ubuntu 18.04 to 18.10 my computer would hang whenever I re-booted. I originally "solved" it by purging the nvidia drivers, but I had actually set out to try and get cuda running this weekend (figuring out the nvidia problem took a day and a half so maybe next weekend) so I wanted a way to get the drivers working. Here's how I did it.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org2f4aa20" class="outline-2"&gt;
&lt;h2 id="org2f4aa20"&gt;What didn't work?&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org2f4aa20"&gt;
&lt;/div&gt;
&lt;div id="outline-container-org9de450c" class="outline-3"&gt;
&lt;h3 id="org9de450c"&gt;Disabling the initial login&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org9de450c"&gt;
&lt;p&gt;
Since I have disk-encrpytion set up there's an initial login screen to enter the decryption passphrase. This never seemed to hang, but if you google 'disable login screen' or something similar this is what you get. Disabling it basically confirmed that it wasn't the problem. For the record, you do this by editing &lt;code&gt;/etc/default/grub&lt;/code&gt; and changing the line:
&lt;/p&gt;

&lt;pre class="example" id="org5659491"&gt;
GRUB_CMDLINE_LINUX_DEFAULT = "quiet splash"
&lt;/pre&gt;

&lt;p&gt;
To:
&lt;/p&gt;

&lt;pre class="example" id="orgcdf2f87"&gt;
GRUB_CMDLINE_LINUX_DEFAULT = ""
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org4b86bb4" class="outline-3"&gt;
&lt;h3 id="org4b86bb4"&gt;Revert the kernel and driver version&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org4b86bb4"&gt;
&lt;p&gt;
Since I had the nvidia drivers working before I upgraded to Ubuntu 18.10 I decided to try using the same driver version that I had used and running the previous kernel using the Grub Menu. No go the bogeyman.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-org9576ff9" class="outline-2"&gt;
&lt;h2 id="org9576ff9"&gt;So what did work?&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org9576ff9"&gt;
&lt;p&gt;
I don't know why other people do it, but &lt;a href="https://askubuntu.com/questions/800239/how-to-disable-lightdmdisplay-manager-on-ubuntu-16-0-4-lts"&gt;this Stack Overflow post&lt;/a&gt; tells you how to disable the GUI. It's basically a one-liner.
&lt;/p&gt;

&lt;pre class="example" id="org417c65e"&gt;
sudo systemctl set-default multi-user.target
&lt;/pre&gt;

&lt;p&gt;
This will cause the machine to boot up without the GUI running so you can bypass the user-login screen (which seems to be what is causing the problem for me) and login at the command-prompt. The post suggested using &lt;code&gt;systemctl&lt;/code&gt; to start the GUI, but that didn't work for me (Ubuntu might not be using &lt;code&gt;lightdm&lt;/code&gt; anymore, which is what the post refers to). Instead I entered &lt;code&gt;startx&lt;/code&gt; and here I am.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;lshw -c video
&lt;/pre&gt;&lt;/div&gt;

&lt;pre class="example" id="org76bc0c9"&gt;
*-display
     description: VGA compatible controller
     product: GM206 [GeForce GTX 950]
     vendor: NVIDIA Corporation
     physical id: 0
     bus info: pci@0000:01:00.0
     version: a1
     width: 64 bits
     clock: 33MHz
     capabilities: vga_controller bus_master cap_list rom
     configuration: driver=nvidia latency=0
     resources: irq:41 memory:fd000000-fdffffff memory:d0000000-dfffffff memory:ce000000-cfffffff ioport:dc00(size=128) memory:c0000-dffff
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>drivers</category><category>setup</category><category>ubuntu</category><guid>https://necromuralist.github.io/posts/using-nvidia-drivers-in-ubuntu-1810/</guid><pubDate>Sun, 28 Oct 2018 19:20:38 GMT</pubDate></item><item><title>Recovering From the Ubuntu 18.10 Upgrade</title><link>https://necromuralist.github.io/posts/recovering-from-the-ubuntu-1810-upgrade/</link><dc:creator>Cloistered Monkey</dc:creator><description>&lt;div id="table-of-contents" role="doc-toc"&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;div id="text-table-of-contents" role="doc-toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/recovering-from-the-ubuntu-1810-upgrade/#orgec28258"&gt;What is this about?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/recovering-from-the-ubuntu-1810-upgrade/#orgdf76c7f"&gt;What didn't work?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/recovering-from-the-ubuntu-1810-upgrade/#org5a9e09e"&gt;What did work?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/recovering-from-the-ubuntu-1810-upgrade/#org1cb3817"&gt;Anything Else?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://necromuralist.github.io/posts/recovering-from-the-ubuntu-1810-upgrade/#org59ec891"&gt;Update&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;
&lt;b&gt;&lt;b&gt;Note:&lt;/b&gt;&lt;/b&gt; I had it hang again on rebooting so there's an update at the end.
&lt;/p&gt;
&lt;div id="outline-container-orgec28258" class="outline-2"&gt;
&lt;h2 id="orgec28258"&gt;What is this about?&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgec28258"&gt;
&lt;p&gt;
I updated from Ubuntu 18.04 to &lt;a href="https://blog.ubuntu.com/2018/10/19/welcome-ubuntu-desktop-18-10"&gt;Ubuntu 18.10&lt;/a&gt; (Cosmic Cuttlefish) last night and upon rebooting found that I couldn't (finish rebooting, that is). In order to write this I had to recover from the problem so I don't have a screen-grab of the error, but it was basically the same one given in &lt;a href="https://askubuntu.com/questions/837143/failed-to-connect-to-lvmetad"&gt;this Stack Overflow post&lt;/a&gt;:
&lt;/p&gt;

&lt;pre class="example" id="orgaa6dd0d"&gt;
WARNING: Failed to connect to lvmetad. Falling back to device scanning.
Volume group "ubuntu-vg" not found
Cannot process volume group ubuntu-vg
WARNING: Failed to connect to lvmetad. Falling back to device scanning.
Reading all physical volumes.  This may take a while...
Found volume group "ubuntu-vg" using metadata type lvm2
WARNING: Failed to connect to lvmetad. Falling back to device scanning.
2 logical volume(s) in volume group "ubuntu-vg" now active /dev/mapper/ubuntu--vg-root: clean, 1180656/30154752 files, 16007858/120604672 blocks
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-orgdf76c7f" class="outline-2"&gt;
&lt;h2 id="orgdf76c7f"&gt;What didn't work?&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgdf76c7f"&gt;
&lt;p&gt;
If you read the Stack Overflow post I linked to above, the solution was to downgrade the kernel version using the grub loader so, following that advice, I brought up the Grub menu by holding down the shift key while the machine booted up, then tried to move the cursor down to &lt;i&gt;Advanced&lt;/i&gt; in the menu using the arrow keys but for some reason it wouldn't move. I thought maybe it was my &lt;a href="https://ultimatehackingkeyboard.com/"&gt;Ultimate Hacking Keyboard&lt;/a&gt; so I went and grabbed my &lt;a href="http://vortexgear.tw/vortex2_2.asp?kind=47&amp;amp;kind2=225&amp;amp;kind3=&amp;amp;kind4=1043"&gt;Vortex&lt;/a&gt; keyboard instead and it still wouldn't work, and at this point some people might think that it probably was not the keyboard, but nope, I went and grabbed my &lt;a href="http://redragonusa.com/products/keyboard/K552/47"&gt;Redragon&lt;/a&gt; keyboard and all of a sudden it worked. Why did my $30 keyboard work better than my $300 keyboard? And no, I don't think I paid that much when I bought the Ultimate Hacking Keyboard (but it took something like two years to ship so I probably spent more than that in lost time). Well, anyway, it turned out that I plugged the last keyboard in the left USB slot while my other keyboards were in the right USB slot and for some reason the right slot was disabled when I went into the Grub Menu. No mention of that on Stack Overflow, unfortunately.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org5a9e09e" class="outline-2"&gt;
&lt;h2 id="org5a9e09e"&gt;What did work?&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org5a9e09e"&gt;
&lt;p&gt;
While I was googling around I found &lt;a href="https://askubuntu.com/questions/969917/failed-to-connect-to-lvmetad-stuck-on-boot"&gt;this post&lt;/a&gt; on Stack Overflow where it was mentioned that the solution did mess with the kernel but it also mentions that he purged his nvidia drivers, which struck a chord with me because I've had problems with the nvidia drivers on my computer at work whenever I upgrade so I thought that maybe this might be something to check out first, before messing with the kernel. The post suggested using &lt;code&gt;ctrl-alt-f3&lt;/code&gt; to get into a terminal which didn't work for me for some reason so I used the Grub Menu instead. Here's the steps for my future self.
&lt;/p&gt;

&lt;ol class="org-ol"&gt;
&lt;li&gt;Hold the shift key down while the machine boots up&lt;/li&gt;
&lt;li&gt;In the Grub Menu use the arrow keys and return to choose the &lt;i&gt;Advanced&lt;/i&gt; option&lt;/li&gt;
&lt;li&gt;Choose the &lt;code&gt;(recovery mode)&lt;/code&gt; version of the current kernel (4.18.0)&lt;/li&gt;
&lt;li&gt;In the Recovery Menu choose the &lt;code&gt;root Drop to root shell prompt&lt;/code&gt; option (you have to hit enter again at the next prompt)&lt;/li&gt;
&lt;li&gt;The file-system for Recovery Mode is in read-only mode so mount the drive with =mount âoptions remount,rw /" (you can do this from the Recovery Menu as well, but it's an extra step either way)&lt;/li&gt;
&lt;li&gt;Purge the drivers with &lt;code&gt;apt purge nvidia-*&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Type &lt;code&gt;exit&lt;/code&gt; then back out of Recovery Mode and finish the startup&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;
I got the stuff about removing the nvidia driver from &lt;a href="https://askubuntu.com/questions/899309/ubuntu-16-04-how-to-disable-nvidia-driver-from-grub"&gt;this Stack Overflow post&lt;/a&gt;. It took a longer time than I thought it would to start up, but I'm writing this from my machine so it seems to work.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org1cb3817" class="outline-2"&gt;
&lt;h2 id="org1cb3817"&gt;Anything Else?&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org1cb3817"&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ubuntu-drivers devices
&lt;/pre&gt;&lt;/div&gt;

&lt;pre class="example"&gt;
== /sys/devices/pci0000:00/0000:00:02.0/0000:01:00.0 ==
modalias : pci:v000010DEd00001402sv00001043sd00008581bc03sc00i00
vendor   : NVIDIA Corporation
model    : GM206 [GeForce GTX 950]
driver   : nvidia-driver-390 - distro non-free recommended
driver   : xserver-xorg-video-nouveau - distro free builtin

&lt;/pre&gt;


&lt;p&gt;
This card actually tended to freeze when I used the open source video drivers that come with Ubuntu so not having the Nvidia drivers seemed like a bad idea. I'm hoping that re-installing them will fix whatever bad setup values were there so I did:
&lt;/p&gt;

&lt;pre class="example" id="org58349b3"&gt;
sudo ubuntu-drivers autoinstall
&lt;/pre&gt;

&lt;p&gt;
Cross your fingers.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org59ec891" class="outline-2"&gt;
&lt;h2 id="org59ec891"&gt;Update&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org59ec891"&gt;
&lt;p&gt;
First, I didn't mention it above (because I hadn't noticed) but the bluetooth interface wouldn't start. The GUI actually let me click on the on-switch but nothing changed and when I looked in Journalctl I could see that it was raising errors. Even &lt;i&gt;hciconfig&lt;/i&gt; couldn't bring it up. Maddeningly, there are posts out there that showed the same errors that I saw (like &lt;a href="https://www.queryxchange.com/q/3_772706/bluetooth-problem-after-upgrade-from-ubuntu-14-to-16-04/"&gt;this one&lt;/a&gt;) but not only did none of the fixes they suggested work, but once I rebooted the problem went away, so I could have tried that before troubleshooting, and avoided all the hassle (maybe). 
&lt;/p&gt;

&lt;p&gt;
Of course, every solution creates a problem, and while rebooting fixed my bluetooth interface it also revealed that I had the same problems as before (only my Redragon keyboard really works on the Grub menu and the boot hangs after the initial login to decrypt the disk). I removed the nvidia drivers again and this time I didn't reinstall them before rebooting and now it works, but now I don't know if my GUI is going to start hanging again like it used to. Oh, well, one problem at a time.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>nvidia</category><category>repair</category><category>ubuntu</category><category>upgrade</category><guid>https://necromuralist.github.io/posts/recovering-from-the-ubuntu-1810-upgrade/</guid><pubDate>Sat, 27 Oct 2018 17:40:09 GMT</pubDate></item><item><title>The Experience of Updating Ubuntu 17.04 To 17.10</title><link>https://necromuralist.github.io/posts/the-experience-of-updating-ubuntu-1704-to-1710/</link><dc:creator>Cloistered Monkey</dc:creator><description>&lt;p&gt;
I recently switched to Ubuntu 17.10 (from 17.04) and found it to be surprisingly difficult. This is meant to document what I noticed so that if I decide to upgrade another machine I'll have something to jog my memory about what it was like.
&lt;/p&gt;

&lt;div id="outline-container-orgb947205" class="outline-2"&gt;
&lt;h2 id="orgb947205"&gt;Complete Re-Install Required&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgb947205"&gt;
&lt;p&gt;
I upgraded four machines (I don't have all their details at hand - maybe I'll update this later). In each case they were running Ubuntu 17.04 so I used &lt;code&gt;do-release-upgrade&lt;/code&gt; initially. I didn't upgrade them all on the same day, but did upgrade all of them within the past week.
&lt;/p&gt;

&lt;ul class="org-ul"&gt;
&lt;li&gt;HP Z600&lt;/li&gt;
&lt;li&gt;eMachine&lt;/li&gt;
&lt;li&gt;Zareason&lt;/li&gt;
&lt;li&gt;Toshiba portege (laptop)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;
The first sign that something bad was happening was that the lock-screen appeared to break after the update so I couldn't log back in. The field where you would normally enter the password was gone so there was no way to authenticate myself. In retrospect, maybe since I did this four times I should have tried a headless install with GNU screen to at least see what was going on, but hindsight's always fifty-fifty, isn't it? My tendency to repeat my mistakes is why I'm writing this down, after all. 
&lt;/p&gt;

&lt;p&gt;
On trying to reboot I found that none of the machines would fully start. All of them got stuck on a black screen with a single white underscore in the top left corner. Unlike the other machines, the Toshiba let me enter the disk-decryption password, but then it ended up at the same black screen as the rest. Once it reached this state there was no way to get to the consoles either (e.g. using ctrl-alt-F1). So, in every case I had to boot from a thumb drive and do a fresh install.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgc743992" class="outline-2"&gt;
&lt;h2 id="orgc743992"&gt;Backwards Steps&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-orgc743992"&gt;
&lt;/div&gt;
&lt;div id="outline-container-org132858e" class="outline-3"&gt;
&lt;h3 id="org132858e"&gt;Alternate Keyboard Layouts&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-org132858e"&gt;
&lt;p&gt;
It used to be that the installer would ask you to set up a disk-encryption password before asking you for your keyboard layout, making it harder for people like me that use alternate layouts (&lt;a href="https://www.kaufmann.no/roland/dvorak/"&gt;Programmer Dvorak&lt;/a&gt; in my case). They eventually fixed that, but now it's back again, forcing you to enter the password to decrypt your drive using &lt;code&gt;qwerty&lt;/code&gt;. The initial login to decrypt the drive after you boot the computer also has no way to switch the keyboard layout, so once again you have to use &lt;code&gt;qwerty&lt;/code&gt;. On top of that, the visual keyboard is missing keys (well, it's missing the underscore, any way) which I used to use when I found myself struggling too much with &lt;code&gt;qwerty&lt;/code&gt;, so instead I have to use the physical keyboard, hunting and pecking and trying to forget where I think the keys should be. Then, once you get past that first screen, it switches back to dvorak (although the visual keyboard doesn't, for some reason) so you have to know that the user login is using a different keyboard layout from the disk decryption prompt - even though there's no way to actually check what the layout is without just trying the variations until you find the one that works.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgcfdd215" class="outline-3"&gt;
&lt;h3 id="orgcfdd215"&gt;Video Drivers&lt;/h3&gt;
&lt;div class="outline-text-3" id="text-orgcfdd215"&gt;
&lt;p&gt;
On top of the keyboard problem, the default Nouveau video drivers seem to have re-introduced an old bug that causes the GUI to freeze up periodically (on my ZaReason and HP computers, at least. I haven't seen it on the other two, but I don't use them as much, anyway). Switching to the Nvidia driver fixes the freezing problem, but it then makes the initial disk-decryption login non-functional - it seems to freeze everything so you can't do anything but restart the computer and use the Grub menu to drop into recovery mode and enter the password at the command line before resuming the startup. As a 'fix' I followed the advice from &lt;a href="https://askubuntu.com/questions/16371/how-do-i-disable-x-at-boot-time-so-that-the-system-boots-in-text-mode"&gt;this Stack Overflow answer&lt;/a&gt; and disabled the initial splash screen altogether by editing the &lt;code&gt;/etc/default/grub&lt;/code&gt; file to have this line:
&lt;/p&gt;

&lt;pre class="example" id="orgb7fb7f5"&gt;
GRUB_CMDLINE_LINUX_DEFAULT="text"
&lt;/pre&gt;

&lt;p&gt;
Then update grub (it doesn't load this file on booting up, you have to explicitly update it).
&lt;/p&gt;

&lt;pre class="example" id="orgac6d792"&gt;
sudo update-grub
&lt;/pre&gt;

&lt;p&gt;
This makes the initial boot-screen text-only, like an old-school terminal. Not fancy, but at least I don't have to remember to drop into recovery-mode every time I start the computer.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-org69df6ca" class="outline-2"&gt;
&lt;h2 id="org69df6ca"&gt;Apt-Fast Bug&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org69df6ca"&gt;
&lt;p&gt;
This is a &lt;a href="https://github.com/ilikenwf/apt-fast/issues/132"&gt;bug&lt;/a&gt; in apt-fast, not an ubuntu bug, but since apt-fast is one of the first things I usually install, I figure I should document the fix. Open up &lt;code&gt;/var/lib/dpkg/info/apt-fast.config&lt;/code&gt; (as root), jump to line 212 and change this line:
&lt;/p&gt;

&lt;pre class="example" id="orgb497d05"&gt;
if ($downloadcmd =~ /\${_MAXNUM}/){
&lt;/pre&gt;

&lt;p&gt;
to this:
&lt;/p&gt;

&lt;pre class="example" id="orgebc5c8f"&gt;
if ($downloadcmd =~ /\$\{_MAXNUM}/){
&lt;/pre&gt;

&lt;p&gt;
In case you can't see it I added a backslash (&lt;code&gt;\&lt;/code&gt;) between the &lt;code&gt;$&lt;/code&gt; and &lt;code&gt;{_MAXNUM&lt;/code&gt;.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org242e3da" class="outline-2"&gt;
&lt;h2 id="org242e3da"&gt;A Little Less Whining&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-org242e3da"&gt;
&lt;p&gt;
Although the disk-decryption login is a major negative, I must note that I kind of like the new aesthetic, I was just really, &lt;i&gt;really&lt;/i&gt;, surprised at how defective this process seemed to be, given how far along Ubuntu has come. There's still some unexpected behaviors (switching workspaces seems to drag applications with them, even though I didn't explicitly ask to, for instance, and byobu seems to ignore my alternate escape key sometimes), but I like it overall. Maybe tomorrow I'll feel different.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>ubuntu</category><category>whine</category><guid>https://necromuralist.github.io/posts/the-experience-of-updating-ubuntu-1704-to-1710/</guid><pubDate>Sat, 28 Oct 2017 20:35:05 GMT</pubDate></item></channel></rss>