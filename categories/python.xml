<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/"><channel><title>The Cloistered Monkey (Python)</title><link>https://necromuralist.github.io/</link><description></description><atom:link href="https://necromuralist.github.io/categories/python.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><lastBuildDate>Mon, 21 Mar 2016 03:45:51 GMT</lastBuildDate><generator>https://getnikola.com/</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Mock a File</title><link>https://necromuralist.github.io/posts/201208mock-file/</link><dc:creator>Cloistered Monkey</dc:creator><description>&lt;div class="document" id="mock-a-file"&gt;&lt;div class="section" id="creating-the-readable-mock"&gt;&lt;h4&gt;Creating The Readable Mock&lt;/h4&gt;To mock a file you can use &lt;cite&gt;StringIO&lt;/cite&gt; and an input string. Since the &lt;cite&gt;StringIO&lt;/cite&gt; will only traverse once (like a regular file) it might be convenient to make a mock builder.  &lt;br&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mock_open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data_string&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;&lt;br&gt;    &lt;span class="n"&gt;mock_file&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MagicMock&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;spec&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;br&gt;    &lt;span class="n"&gt;mock_file&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;return_value&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;StringIO&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data_string&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;br&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;mock_file&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="section" id="using-the-mock"&gt;&lt;h4&gt;Using the Mock&lt;/h4&gt;To use the mock you patch the built-in &lt;cite&gt;open&lt;/cite&gt; function.&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;opened&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mock_file()&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;patch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'__builtin__.open'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;opened&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;create&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;&lt;br&gt;    &lt;span class="n"&gt;run_tests_here&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class="section" id="checking-the-mock"&gt;&lt;h4&gt;Checking the Mock&lt;/h4&gt;To see if the file was opened correctly:&lt;br&gt;&lt;pre class="code python literal-block"&gt;&lt;span class="n"&gt;opened&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;assert_called_with&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r_or_w&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;To check write calls look at &lt;cite&gt;opened.write.mock_calls&lt;/cite&gt;.&lt;/div&gt;&lt;/div&gt;</description><category>Python</category><category>Software Testing</category><guid>https://necromuralist.github.io/posts/201208mock-file/</guid><pubDate>Thu, 16 Aug 2012 07:27:00 GMT</pubDate></item><item><title>A Python Implementation Of the CheckRep</title><link>https://necromuralist.github.io/posts/201208a-python-implementation-of-checkrep/</link><dc:creator>Cloistered Monkey</dc:creator><description>&lt;div class="document" id="a-python-implementation-of-the-checkrep"&gt;The method was implementated as:&lt;br&gt;&lt;pre class="literal-block"&gt;def check_representation(self):&lt;br&gt;    """&lt;br&gt;    Checks that the internal representation is correct.&lt;br&gt;&lt;br&gt;    :raise: AssertionError if an error is found.&lt;br&gt;    """&lt;br&gt;    for attribute in (self.max, self.head, self.size):&lt;br&gt;        assert attribute &amp;gt;= 0, "{0} shouldn't be negative. ({1})".format(attribute, str(self))&lt;br&gt;    assert ((self.head + self.size) % self.max == self.tail), str(self)&lt;br&gt;    return&lt;br&gt;&lt;/pre&gt;&lt;div class="section" id="notes"&gt;&lt;h4&gt;Notes&lt;/h4&gt;&lt;ul class="simple"&gt;&lt;li&gt;This is for the fixed-size queue used in udacity's &lt;em&gt;Software Testing&lt;/em&gt; class&lt;/li&gt;&lt;li&gt;Since the second assertion checks an equation where the tail can never be negative if all the left-hand terms are positive, the tail isn't checked to see if it's positive&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/div&gt;</description><category>Python</category><category>Software Testing</category><category>Udacity</category><guid>https://necromuralist.github.io/posts/201208a-python-implementation-of-checkrep/</guid><pubDate>Tue, 07 Aug 2012 09:00:00 GMT</pubDate></item></channel></rss>