<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="An experiment with org-babel's noweb-ref." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Inserting Text Between Methods in Org-Mode | The Cloistered Monkey</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/posts/org-babel-noweb-ref/" rel="canonical"><!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]-->
<link href="../../apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="../../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../../site.webmanifest" rel="manifest">
<meta content="Cloistered Monkey" name="author">
<link href="../org-babel-stderr-results/" rel="prev" title="Org-Babel Stderr Results" type="text/html">
<link href="../breakout-with-tkinter/" rel="next" title="Breakout With Tkinter" type="text/html">
<meta content="The Cloistered Monkey" property="og:site_name">
<meta content="Inserting Text Between Methods in Org-Mode" property="og:title">
<meta content="https://necromuralist.github.io/posts/org-babel-noweb-ref/" property="og:url">
<meta content="An experiment with org-babel's noweb-ref." property="og:description">
<meta content="article" property="og:type">
<meta content="2017-02-19T11:06:06-08:00" property="article:published_time">
<meta content="literate programming" property="article:tag">
<meta content="org-babel" property="article:tag">
<meta content="org-mode" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="../../"><span id="blog-title">The Cloistered Monkey</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="../../archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="../../categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="../../rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Projects</a>
<div class="dropdown-menu"><a class="dropdown-item" href="https://necromuralist.github.io/Neurotic-Networking/">Neurotic Networking</a> <a class="dropdown-item" href="../../machine-learning-projects/">Machine Learning</a> <a class="dropdown-item" href="https://necromuralist.github.io/student_intervention/">Student Intervention Project</a> <a class="dropdown-item" href="https://necromuralist.github.io/boston_housing/">Boston Housing Project</a> <a class="dropdown-item" href="https://necromuralist.github.io/data_science/">Data Science With Python</a> <a class="dropdown-item" href="https://necromuralist.github.io/Visions-Voices-Data/">Visions, Voices, Data</a></div>
</li>
</ul>
<!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Search" type="text"></div>
<!-- 
<button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-search"></span>
</button>
-->
<input name="sitesearch" type="hidden" value="https://necromuralist.github.io/"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href=".">Inserting Text Between Methods in Org-Mode</a></h1>
<div class="metadata">
<p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author"><a class="u-url" href="../../authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2017-02-19T11:06:06-08:00" itemprop="datePublished" title="2017-02-19 11:06">2017-02-19 11:06</time></a></p>
<p class="sourceline"><a class="sourcelink" href="index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org83363b1">The Tangle</a></li>
<li><a href="#orgb6d83e5">The First Class</a>
<ul>
<li><a href="#orgc827021">The Constructor</a></li>
<li><a href="#orgc71f8a9">The Call</a></li>
</ul>
</li>
<li><a href="#orga58ce95">The Main</a></li>
<li><a href="#orge652a3b">Trying it out</a></li>
<li><a href="#org0981574">Summary</a></li>
</ul>
</div>
</div>
<p>This is an attempt to get org-mode to insert text between methods in a class definition using the noweb-ref property. I think you can also do it by just tangling everything to the same file, but I like the noweb notation better.</p>
<div class="outline-2" id="outline-container-org83363b1">
<h2 id="org83363b1">The Tangle</h2>
<div class="outline-text-2" id="text-org83363b1">
<p>To keep it simple I'm just going to include a section for the class definition and a <code>main</code> section to check out the results. Note that to be able to break up the class definition I had to turn off org-mode's clean-up so all the python blocks have to be indented exactly the way they will be in the final python file.</p>
<div class="highlight">
<pre><span></span><span class="o">&lt;&lt;</span><span class="n">first</span><span class="o">-</span><span class="n">class</span><span class="o">&gt;&gt;</span>

<span class="o">&lt;&lt;</span><span class="n">main</span><span class="o">&gt;&gt;</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orgb6d83e5">
<h2 id="orgb6d83e5">The First Class</h2>
<div class="outline-text-2" id="text-orgb6d83e5">
<p>This first class won't do much, but if I understand the documentation I should be able to insert text between the parts of it and still have it work when the python gets tangled out. The org-mode source block starts like this - <code>#+BEGIN_SRC python :noweb-ref first-class</code>.</p>
</div>
<div class="outline-3" id="outline-container-orgc827021">
<h3 id="orgc827021">The Constructor</h3>
<div class="outline-text-3" id="text-orgc827021">
<div class="highlight">
<pre><span></span>   <span class="k">class</span> <span class="nc">FirstClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
       <span class="sd">"""a class that is first</span>
<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>

<span class="sd">       name: string</span>
<span class="sd">        some kind of identifier</span>
<span class="sd">       """</span>
       <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
           <span class="k">return</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgc71f8a9">
<h3 id="orgc71f8a9">The Call</h3>
<div class="outline-text-3" id="text-orgc71f8a9">
<p>The call emits the name. To concatenate this method to the previous block I'm using the same org-mode source-block header as I did with the constructor (<code>#+BEGIN_SRC python :noweb-ref first-class</code>). You could use a different name and insert another reference in the tangle but this seems more logical to me. One problem here is that python-mode (or some other mode) will interpret the methods as stand-alone functions and move them flush left. To fix this I had to turn off the automatic indentation using <code>(setq org-src-preserve-indentation t)</code>. This means that you have to keep track of the indentation yourself, regardless of where the code sits in the org-mode document (so as you create sub-sections it will look uglier and uglier in the original document, at least to me). Putting the method in a separate block also requires that you to insert an empty line before the method to keep it from being stuck to the bottom of the previous one, but it doesn't include it when it gets exported to HTML, so you can't see it in this post. In fact, I noticed afterwards that the HTML export also stripped out the indentation on the left so you can't really see what I'm talking about.</p>
<div class="highlight">
<pre><span></span>   <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="sd">"""prints the name"""</span>
       <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
       <span class="k">return</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orga58ce95">
<h2 id="orga58ce95">The Main</h2>
<div class="outline-text-2" id="text-orga58ce95">
<p>This part constructs the <code>FirstClass</code> object and calls it.</p>
<div class="highlight">
<pre><span></span>  <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
      <span class="n">thing</span> <span class="o">=</span> <span class="n">FirstClass</span><span class="p">(</span><span class="s2">"Bob"</span><span class="p">)</span>
      <span class="n">thing</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orge652a3b">
<h2 id="orge652a3b">Trying it out</h2>
<div class="outline-text-2" id="text-orge652a3b">
<div class="highlight">
<pre><span></span>  python noweb_ref.py
</pre></div>
<pre class="example">
Bob
</pre></div>
</div>
<div class="outline-2" id="outline-container-org0981574">
<h2 id="org0981574">Summary</h2>
<div class="outline-text-2" id="text-org0981574">
<p>The point of trying this out is that I want to be able to break up and document class-methods better. Unfortunately it requires you to do a little more fiddling with the white-space yourself and makes the source org-mode file a little harder to read (I think) but I'm going to try it for a little while and see if the resulting documents are worth the extra headache. Maybe I'll just have to stick with docstrings for documenting the separate methods…</p>
<p>This bit at the end makes it so the indentation is always preserved, even if the <code>init.el</code> file isn't set up that way.</p>
<div class="highlight">
<pre><span></span>  <span class="c1"># Local Variables:</span>
  <span class="c1"># org-src-preserve-indentation: t</span>
  <span class="c1"># End:</span>
</pre></div>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="../../categories/literate-programming/" rel="tag">literate programming</a></li>
<li><a class="tag p-category" href="../../categories/org-babel/" rel="tag">org-babel</a></li>
<li><a class="tag p-category" href="../../categories/org-mode/" rel="tag">org-mode</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="../org-babel-stderr-results/" rel="prev" title="Org-Babel Stderr Results">Previous post</a></li>
<li class="next"><a href="../breakout-with-tkinter/" rel="next" title="Breakout With Tkinter">Next post</a></li>
</ul>
</nav>
</aside>
</article>
<!--End of body content-->
<footer id="footer">Contents © 2021 <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="../../assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script>
</body>
</html>
