<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="A common place." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>The Cloistered Monkey</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/" rel="canonical">
<link href="index-20.html" rel="next" type="text/html"><!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
<link href="apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="site.webmanifest" rel="manifest">
<link href="posts/pytorch-and-the-unknown-cuda-error/" rel="prefetch" type="text/html">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="."><span id="blog-title">The Cloistered Monkey</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Projects</a>
<div class="dropdown-menu"><a class="dropdown-item" href="https://necromuralist.github.io/Anechoic-Echolalia/">Anechoic Echolalia</a> <a class="dropdown-item" href="https://necromuralist.github.io/Ape-Iron/">Ape Iron</a> <a class="dropdown-item" href="https://necromuralist.github.io/Homunculi-Hypergraphia/">Honumculi Hypergraphia</a> <a class="dropdown-item" href="https://necromuralist.github.io/Neurotic-Networking/">Neurotic Networking</a> <a class="dropdown-item" href="machine-learning-projects/">Machine Learning</a> <a class="dropdown-item" href="https://necromuralist.github.io/student_intervention/">Student Intervention Project</a> <a class="dropdown-item" href="https://necromuralist.github.io/boston_housing/">Boston Housing Project</a> <a class="dropdown-item" href="https://necromuralist.github.io/data_science/">Data Science With Python</a> <a class="dropdown-item" href="https://necromuralist.github.io/Visions-Voices-Data/">Visions, Voices, Data</a></div>
</li>
</ul>
<!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Search" type="text"></div>
<!-- 
<button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-search"></span>
</button>
-->
<input name="sitesearch" type="hidden" value="https://necromuralist.github.io/"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<div class="postindex">
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/pytorch-and-the-unknown-cuda-error/">PyTorch and the Unknown CUDA Error</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/pytorch-and-the-unknown-cuda-error/" rel="bookmark"><time class="published dt-published" datetime="2022-10-31T17:58:27-07:00" itemprop="datePublished" title="2022-10-31 17:58">2022-10-31 17:58</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/pytorch-and-the-unknown-cuda-error/#org0edd95b">The Problem</a></li>
<li><a href="posts/pytorch-and-the-unknown-cuda-error/#org3ff7dfd">The Symptom</a></li>
<li><a href="posts/pytorch-and-the-unknown-cuda-error/#org56848d2">The Disease and Its Cure</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org0edd95b">
<h2 id="org0edd95b">The Problem</h2>
<div class="outline-text-2" id="text-org0edd95b">
<p>I recently decided to get back into using neural networks again and tried to update my docker container to get <a href="https://www.fast.ai/">fastai</a> up and running, but couldn't get CUDA working. After a while spent trying different configurations of CUDA, pytorch, pip, conda, and on and on I eventually found out that there's some kind of problem with using CUDA after suspending and then resuming your system (at least with linux/Ubuntu). This is a documentation of that particular problem and it's fixes (fastest but not necessarily the best answer: always shutdown or reboot the machine, don't suspend and resume).</p>
</div>
</div>
<div class="outline-2" id="outline-container-org3ff7dfd">
<h2 id="org3ff7dfd">The Symptom</h2>
<div class="outline-text-2" id="text-org3ff7dfd">
<p>This is what happens if I try to use CUDA after waking the machine from a suspend.</p>
<div class="highlight">
<pre><span></span><span class="kn">import</span> <span class="nn">torch</span>

<span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span>
</pre></div>
<pre class="example">
/home/athena/.conda/envs/neurotic-fastai/lib/python3.9/site-packages/torch/cuda/__init__.py:88: UserWarning: CUDA initialization: CUDA unknown error - this may be due to an incorrectly set up environment, e.g. changing env variable CUDA_VISIBLE_DEVICES after program start. Setting the available devices to be zero. (Triggered internally at /opt/conda/conda-bld/pytorch_1666642975993/work/c10/cuda/CUDAFunctions.cpp:109.)
  return torch._C._cuda_getDeviceCount() &gt; 0
</pre>
<p>As you can see, the error message doesn't really give any useful information about what's wrong - there <i>are</i> a couple of suggestions but neither seems relevant or at least doesn't lead you to the fix.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org56848d2">
<h2 id="org56848d2">The Disease and Its Cure</h2>
<div class="outline-text-2" id="text-org56848d2">
<p>There's a post on the <a href="https://discuss.pytorch.org/t/userwarning-cuda-initialization-cuda-unknown-error-this-may-be-due-to-an-incorrectly-set-up-environment-e-g-changing-env-variable-cuda-visible-devices-after-program-start-setting-the-available-devices-to-be-zero/129335/2">pytorch discussion boards</a> about this error in which "ptrblck" says that he runs into this problem if his machine is put into the suspend state. While mentioning this he also says that restarting his machine fixes the problem, but restarting it every time seems to defeat the purpose of using suspend (and I'd have to walk to a different room to log in and decrypt the drive after restarting the machine - ugh, so much work).</p>
<p>Luckily, in a <a href="https://discuss.pytorch.org/t/userwarning-cuda-initialization-cuda-unknown-error-this-may-be-due-to-an-incorrectly-set-up-environment-e-g-changing-env-variable-cuda-visible-devices-after-program-start-setting-the-available-devices-to-be-zero/129335/5">later post</a> in the thread the same user mentions that you can also fix it by reloading the <code>nvidia_uvm</code> kernel module by entering these commands in the terminal:</p>
<div class="highlight">
<pre><span></span>sudo rmmod nvidia_uvm
sudo modprobe nvidia_uvm
</pre></div>
<p>Which seems to fix the problem for me right at the moment, without the need to restart the machine.</p>
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">())</span>
</pre></div>
<pre class="example">
False
</pre>
<p>Ummmâ€¦ oops. Well, it did sort of fix one problem - the <code>CUDA unknown error</code>, but now it's saying that CUDA isn't available on this machine. Every fix begets a new problem. Let's try it again after restarting the Jupyter kernel.</p>
<div class="highlight">
<pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="nb">print</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">())</span>
</pre></div>
<pre class="example">
True
</pre>
<p>Okay, that's better, I guess. It feels a little inelegant to have to do this, but at least it seems to work.</p>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/tangling-multiple-org-files/">Tangling Multiple Org Files</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/tangling-multiple-org-files/" rel="bookmark"><time class="published dt-published" datetime="2022-03-21T17:30:14-07:00" itemprop="datePublished" title="2022-03-21 17:30">2022-03-21 17:30</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/tangling-multiple-org-files/#org50f361c">The Steps</a>
<ul>
<li><a href="posts/tangling-multiple-org-files/#orgd741235">Create one.org</a></li>
<li><a href="posts/tangling-multiple-org-files/#org86554df">Create two.org</a></li>
<li><a href="posts/tangling-multiple-org-files/#orgbadaef8">Export one.org</a></li>
<li><a href="posts/tangling-multiple-org-files/#orga488421">Tangle one.org.org</a></li>
</ul>
</li>
<li><a href="posts/tangling-multiple-org-files/#org0a29aea">Sources</a></li>
</ul>
</div>
</div>
<p>I've been looking off and on for ways to combine separate code-blocks in org-mode into a single tangled file. I wanted to use it because I tangle code that I want to re-use out of posts but then if I want to break the posts up I need to create a separate file (tangle) for each post. I'm hopeful that this method will allow me to break up a tangle across multiple posts. I've only tried it on toy files but I want to get some initial documentation for it in place.</p>
<div class="outline-2" id="outline-container-org50f361c">
<h2 id="org50f361c">The Steps</h2>
<div class="outline-text-2" id="text-org50f361c">
<p>Let's say that there are two source org-files:</p>
<ul class="org-ul">
<li><code>one.org</code>: contains the tangle block and a source block</li>
<li><code>two.org</code>: contains another block that we want to tangle with the one in <code>one.org</code></li>
</ul>
<p>The steps are:</p>
<ol class="org-ol">
<li>Put an <code>#+INCLUDE</code> directive to include <code>two.org</code> into <code>one.org</code></li>
<li>Export <code>one.org</code> to an <code>org</code> file</li>
<li>Open the exported org file (<code>one.org.org</code>)</li>
<li>Tangle it.</li>
</ol>
</div>
<div class="outline-3" id="outline-container-orgd741235">
<h3 id="orgd741235">Create one.org</h3>
<div class="outline-text-3" id="text-orgd741235">
<p>The file <code>one.org</code> is going to have the tangle and the first source-block:</p>
<div class="highlight">
<pre><span></span>#+begin_src python :tangle ~/test.py :exports none
&lt;&lt;block-one&gt;&gt;

&lt;&lt;block-two&gt;&gt;
#+end_src
</pre></div>
<div class="highlight">
<pre><span></span>#+begin_src python :noweb-ref block-one
def one():
    print("One")
#+end_src
</pre></div>
<p>We also need to include what's in the second file (<code>two.org</code>). The code we want to include is in a section called <code>Two</code> so we can include just that section by adding a search term at the end.</p>
<div class="highlight">
<pre><span></span>#+INCLUDE: "./two.org::*Two"
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org86554df">
<h3 id="org86554df">Create two.org</h3>
<div class="outline-text-3" id="text-org86554df">
<p>In the other file add the section header to match the <code>INCLUDE</code> search term (<code>*Two</code>) and put a code block with a reference named <code>block-two</code> to match what's in the tangle block above.</p>
<div class="highlight">
<pre><span></span>* Two
#+begin_src python :noweb-ref block-two
def two():
print("Two")
#+end_src
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgbadaef8">
<h3 id="orgbadaef8">Export one.org</h3>
<div class="outline-text-3" id="text-orgbadaef8">
<p>Tangling unfortunately ignores the <code>INCLUDE</code> directive so we have to export it first to another org-file in order to get the text from <code>org.two</code> into our source file. By default, exporting to <code>org</code> is disabled so you need to enable it (e.g. starting with <code>M-x customize</code> <code>org-export-backends</code>).</p>
<p>Once it's enabled you can export <code>one.org</code> to an org-mode file using <code>C-c C-e O v</code> (the default name will be <code>one.org.org</code>).</p>
</div>
</div>
<div class="outline-3" id="outline-container-orga488421">
<h3 id="orga488421">Tangle one.org.org</h3>
<div class="outline-text-3" id="text-orga488421">
<p>The last choice when we exported the file in the previous step (<code>v</code>) will save it to a file and open it up in an emacs buffer. When the buffer is open you can then tangle it (<code>C-c C-v C-t</code>) and the output (<code>/test.py</code> from our tangle block) should contain both of our functions.</p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org0a29aea">
<h2 id="org0a29aea">Sources</h2>
<div class="outline-text-2" id="text-org0a29aea">
<p>This is where I got the information on breaking up the files. It includes some emacs-lisp to run the steps automatically (although I didn't try it):</p>
<ul class="org-ul">
<li>Multi-File Org-Babel Tangles with Include Directives [Internet]. DEV Community. [cited 2022 Mar 21]. Available from: <a href="https://dev.to/jfhbrook/multi-file-org-babel-tangles-with-include-directives-5522">https://dev.to/jfhbrook/multi-file-org-babel-tangles-with-include-directives-5522</a></li>
</ul>
<p>This is the post that mentions that exporting org-files to org-format needs to be enabled (and how to do it):</p>
<ul class="org-ul">
<li>exporting - Org mode export subtree to new org file - option missing? [Internet]. Emacs Stack Exchange. [cited 2022 Mar 21]. Available from: <a href="https://emacs.stackexchange.com/a/70453">https://emacs.stackexchange.com/a/70453</a></li>
</ul>
<p>This is the manual page explaining the search syntax (which is what the <code>#+INCLUDE</code> format uses).</p>
<ul class="org-ul">
<li>Search Options (The Org Manual) [Internet]. [cited 2022 Mar 21]. Available from: <a href="https://orgmode.org/manual/Search-Options.html">https://orgmode.org/manual/Search-Options.html</a></li>
</ul>
<p>This explains the <code>#+INCLUDE</code> directive options:</p>
<ul class="org-ul">
<li>Include Files (The Org Manual) [Internet]. [cited 2022 Mar 21]. Available from: <a href="https://orgmode.org/manual/Include-Files.html">https://orgmode.org/manual/Include-Files.html</a></li>
</ul>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/code-wars-pick-peaks/">CodeWars: Pick Peaks</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/code-wars-pick-peaks/" rel="bookmark"><time class="published dt-published" datetime="2022-02-18T17:10:32-08:00" itemprop="datePublished" title="2022-02-18 17:10">2022-02-18 17:10</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/code-wars-pick-peaks/#orgdde50ff">Beginning</a></li>
<li><a href="posts/code-wars-pick-peaks/#org672b73a">Code</a>
<ul>
<li><a href="posts/code-wars-pick-peaks/#org2596fa6">Imports</a></li>
<li><a href="posts/code-wars-pick-peaks/#org5a890e3">The Submission</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgdde50ff">
<h2 id="orgdde50ff">Beginning</h2>
<div class="outline-text-2" id="text-orgdde50ff">
<p>The problem given is to write a function that returns the location and values of local maxima within a list (array). The inputs will be (possibly empty) lists with integers. The first and last elements cannot be called peaks since we don't know what comes before the first element or after the last element.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org672b73a">
<h2 id="org672b73a">Code</h2>
<div class="outline-text-2" id="text-org672b73a"></div>
<div class="outline-3" id="outline-container-org2596fa6">
<h3 id="org2596fa6">Imports</h3>
<div class="outline-text-3" id="text-org2596fa6">
<div class="highlight">
<pre><span></span><span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="n">equal</span><span class="p">,</span> <span class="n">expect</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org5a890e3">
<h3 id="org5a890e3">The Submission</h3>
<div class="outline-text-3" id="text-org5a890e3">
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">pick_peaks</span><span class="p">(</span><span class="n">array</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">"""Find local maxima</span>

<span class="sd">    Args:</span>
<span class="sd">     array: list of integers to search</span>

<span class="sd">    Returns:</span>
<span class="sd">     pos, peaks dict of maxima</span>
<span class="sd">    """</span>
    <span class="n">output</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="p">[],</span> <span class="n">peaks</span><span class="o">=</span><span class="p">[])</span>
    <span class="n">peak</span> <span class="o">=</span> <span class="n">position</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">array</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">array</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span>
            <span class="n">position</span> <span class="o">=</span> <span class="n">index</span>
            <span class="n">peak</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">peak</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">array</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">array</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span>
            <span class="n">output</span><span class="p">[</span><span class="s2">"pos"</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
            <span class="n">output</span><span class="p">[</span><span class="s2">"peaks"</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">peak</span><span class="p">)</span>
            <span class="n">peak</span> <span class="o">=</span> <span class="n">position</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">output</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">expect</span><span class="p">(</span><span class="n">pick_peaks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">({</span><span class="s2">"pos"</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="s2">"peaks"</span><span class="p">:[</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">]}))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">pick_peaks</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">({</span><span class="s2">"pos"</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="s2">"peaks"</span><span class="p">:[</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">]}))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">pick_peaks</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">({</span><span class="s2">"pos"</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="s2">"peaks"</span><span class="p">:[</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]}))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">pick_peaks</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">({</span><span class="s2">"pos"</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="s2">"peaks"</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]}))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">pick_peaks</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">({</span><span class="s2">"pos"</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">"peaks"</span><span class="p">:[</span><span class="mi">3</span><span class="p">]}))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">pick_peaks</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">({</span><span class="s2">"pos"</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">"peaks"</span><span class="p">:[</span><span class="mi">3</span><span class="p">]}))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">pick_peaks</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">({</span><span class="s2">"pos"</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">"peaks"</span><span class="p">:[</span><span class="mi">3</span><span class="p">]}))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">pick_peaks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">({</span><span class="s2">"pos"</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span> <span class="s2">"peaks"</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]}))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">pick_peaks</span><span class="p">([</span><span class="mi">18</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">({</span><span class="s1">'pos'</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">23</span><span class="p">],</span> <span class="s1">'peaks'</span><span class="p">:</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">18</span><span class="p">]}))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">pick_peaks</span><span class="p">([]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">({</span><span class="s2">"pos"</span><span class="p">:[],</span><span class="s2">"peaks"</span><span class="p">:[]}))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">pick_peaks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">({</span><span class="s2">"pos"</span><span class="p">:[],</span><span class="s2">"peaks"</span><span class="p">:[]}))</span>
</pre></div>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/codewars-simple-pig-latin/">CodeWars: Simple Pig Latin</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/codewars-simple-pig-latin/" rel="bookmark"><time class="published dt-published" datetime="2022-02-15T18:12:05-08:00" itemprop="datePublished" title="2022-02-15 18:12">2022-02-15 18:12</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/codewars-simple-pig-latin/#org2d85a42">Description</a></li>
<li><a href="posts/codewars-simple-pig-latin/#org48c8250">Code</a>
<ul>
<li><a href="posts/codewars-simple-pig-latin/#orgadb5dc6">Imports</a></li>
<li><a href="posts/codewars-simple-pig-latin/#org2272836">Submission</a></li>
</ul>
</li>
<li><a href="posts/codewars-simple-pig-latin/#org838180c">Sources</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org2d85a42">
<h2 id="org2d85a42">Description</h2>
<div class="outline-text-2" id="text-org2d85a42">
<p>Move the first letter of each word to the end of it, then add "ay" to the end of the word. Leave punctuation marks untouched.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org48c8250">
<h2 id="org48c8250">Code</h2>
<div class="outline-text-2" id="text-org48c8250"></div>
<div class="outline-3" id="outline-container-orgadb5dc6">
<h3 id="orgadb5dc6">Imports</h3>
<div class="outline-text-3" id="text-orgadb5dc6">
<div class="highlight">
<pre><span></span><span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="n">equal</span><span class="p">,</span> <span class="n">expect</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org2272836">
<h3 id="org2272836">Submission</h3>
<div class="outline-text-3" id="text-org2272836">
<div class="highlight">
<pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="n">LETTERS</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">"[a-zA-Z]"</span><span class="p">)</span>
<span class="n">WORD_BOUNDARY</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">"\b"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">"""Convert a single word to pig-latin</span>

<span class="sd">    Args:</span>
<span class="sd">     token: string representing a single token</span>

<span class="sd">    Returns: </span>
<span class="sd">     pig-latinized word (if appropriate)</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">token</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="si">}{</span><span class="n">token</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">ay"</span>
            <span class="k">if</span> <span class="n">token</span> <span class="ow">and</span> <span class="n">LETTERS</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="k">else</span> <span class="n">token</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">pig_it</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">"""Basic pig latin converter</span>

<span class="sd">    Moves first letter of words to the end and adds 'ay' to the end</span>

<span class="sd">    Args:</span>
<span class="sd">     text: string to pig-latinize</span>

<span class="sd">    Returns:</span>
<span class="sd">     pig-latin version of text</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="s2">""</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">convert</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">WORD_BOUNDARY</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">expect</span><span class="p">(</span><span class="n">pig_it</span><span class="p">(</span><span class="s1">'Pig latin is cool'</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="s1">'igPay atinlay siay oolcay'</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">pig_it</span><span class="p">(</span><span class="s1">'This is my string'</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="s1">'hisTay siay ymay tringsay'</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">pig_it</span><span class="p">(</span><span class="s2">"Hello World !"</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="s2">"elloHay orldWay !"</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org838180c">
<h2 id="org838180c">Sources</h2>
<div class="outline-text-2" id="text-org838180c">
<ul class="org-ul">
<li><a href="https://www.codewars.com/kata/520b9d2ad5c005041100000f/train/python">CodeWars: Simple Pig Latin</a></li>
</ul>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/codewars-rgb-to-hexadecimal/">CodeWars: RGB To Hexadecimal</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/codewars-rgb-to-hexadecimal/" rel="bookmark"><time class="published dt-published" datetime="2022-02-14T20:07:51-08:00" itemprop="datePublished" title="2022-02-14 20:07">2022-02-14 20:07</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/codewars-rgb-to-hexadecimal/#org1042489">Description</a></li>
<li><a href="posts/codewars-rgb-to-hexadecimal/#org08ca73a">The Code</a>
<ul>
<li><a href="posts/codewars-rgb-to-hexadecimal/#org1b5cc92">Imports</a></li>
<li><a href="posts/codewars-rgb-to-hexadecimal/#org3aab512">Submission</a></li>
<li><a href="posts/codewars-rgb-to-hexadecimal/#org59201d4">Alternatives</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org1042489">
<h2 id="org1042489">Description</h2>
<div class="outline-text-2" id="text-org1042489">
<p>Given three arguments <code>r</code>, <code>g</code>, and <code>b</code> which are integers from 0 to 255 representing RGB values, convert them to a six digit (zero-padded) hexadecimal string. Invalid (out of range) values need to be rounded to nearest value.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org08ca73a">
<h2 id="org08ca73a">The Code</h2>
<div class="outline-text-2" id="text-org08ca73a"></div>
<div class="outline-3" id="outline-container-org1b5cc92">
<h3 id="org1b5cc92">Imports</h3>
<div class="outline-text-3" id="text-org1b5cc92">
<div class="highlight">
<pre><span></span><span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="n">equal</span><span class="p">,</span> <span class="n">expect</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org3aab512">
<h3 id="org3aab512">Submission</h3>
<div class="outline-text-3" id="text-org3aab512">
<div class="highlight">
<pre><span></span><span class="n">HEX_DIGITS</span> <span class="o">=</span> <span class="s2">"0123456789ABCDEF"</span>
<span class="n">RGB_TO_HEX</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">HEX_DIGITS</span><span class="p">)),</span> <span class="n">HEX_DIGITS</span><span class="p">))</span>
<span class="n">HEX</span> <span class="o">=</span> <span class="mi">16</span>

<span class="k">def</span> <span class="nf">rgb</span><span class="p">(</span><span class="n">r</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">"""Convert RGB to Hexadecimal</span>

<span class="sd">    If the values are out of bounds they will be set to the nearest limit</span>

<span class="sd">    e.g. -1 becomes 0 and 2919 becomes 255</span>

<span class="sd">    Non-integers will raise an error</span>

<span class="sd">    Args:</span>
<span class="sd">     r: red channel (0-255)</span>
<span class="sd">     g: green channel (0-255)</span>
<span class="sd">     b: blue channel (0-255)</span>

<span class="sd">    Returns:</span>
<span class="sd">     6-digit hexadecimal equivalent of r, g, b</span>
<span class="sd">    """</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
    <span class="n">converted</span> <span class="o">=</span> <span class="p">((</span><span class="n">RGB_TO_HEX</span><span class="p">[</span><span class="n">color</span><span class="o">//</span><span class="n">HEX</span><span class="p">],</span> <span class="n">RGB_TO_HEX</span><span class="p">[</span><span class="n">color</span> <span class="o">%</span> <span class="n">HEX</span><span class="p">])</span>
                 <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">""</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">converted</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">))</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">expect</span><span class="p">(</span><span class="n">rgb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="s2">"000000"</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">rgb</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="s2">"010203"</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">rgb</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="s2">"FFFFFF"</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">rgb</span><span class="p">(</span><span class="mi">254</span><span class="p">,</span><span class="mi">253</span><span class="p">,</span><span class="mi">252</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="s2">"FEFDFC"</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">rgb</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">275</span><span class="p">,</span><span class="mi">125</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="s2">"00FF7D"</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org59201d4">
<h3 id="org59201d4">Alternatives</h3>
<div class="outline-text-3" id="text-org59201d4">
<p>A surprising number of people used the string formatting - <code>{:02X}</code> to convert the numbers to hexadecimal. I think that's sort of the problem with these earlier puzzles - there's a big question of how much of python's built in functionality you should use. I guess since I use string formatting a lot that might make sense as a shortcut in this case.</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">rgb_2</span><span class="p">(</span><span class="n">r</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">"""Convert RGB to Hexadecimal</span>

<span class="sd">    If the values are out of bounds they will be set to the nearest limit</span>

<span class="sd">    e.g. -1 becomes 0 and 2919 becomes 255</span>

<span class="sd">    Non-integers will raise an error</span>

<span class="sd">    Args:</span>
<span class="sd">     r: red channel (0-255)</span>
<span class="sd">     g: green channel (0-255)</span>
<span class="sd">     b: blue channel (0-255)</span>

<span class="sd">    Returns:</span>
<span class="sd">     6-digit hexadecimal equivalent of r, g, b</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="s2">""</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span><span class="si">:</span><span class="s2">02X</span><span class="si">}</span><span class="s2">"</span> <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">)))</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">expect</span><span class="p">(</span><span class="n">rgb_2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="s2">"000000"</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">rgb_2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="s2">"010203"</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">rgb_2</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="s2">"FFFFFF"</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">rgb_2</span><span class="p">(</span><span class="mi">254</span><span class="p">,</span><span class="mi">253</span><span class="p">,</span><span class="mi">252</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="s2">"FEFDFC"</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">rgb_2</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">275</span><span class="p">,</span><span class="mi">125</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="s2">"00FF7D"</span><span class="p">))</span>
</pre></div>
<p>Not quite so readable, but short.</p>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/codewars-rot13/">CodeWars: Rot13</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/codewars-rot13/" rel="bookmark"><time class="published dt-published" datetime="2022-02-12T13:03:26-08:00" itemprop="datePublished" title="2022-02-12 13:03">2022-02-12 13:03</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/codewars-rot13/#org9016827">Description</a></li>
<li><a href="posts/codewars-rot13/#org138b811">The Code</a>
<ul>
<li><a href="posts/codewars-rot13/#orgadea759">Imports</a></li>
<li><a href="posts/codewars-rot13/#orgfffe53e">The Submitted Function</a></li>
<li><a href="posts/codewars-rot13/#org740e508">A Test</a></li>
</ul>
</li>
<li><a href="posts/codewars-rot13/#org65937da">Alternatives</a>
<ul>
<li><a href="posts/codewars-rot13/#org27aba37">Using the Slicing</a></li>
<li><a href="posts/codewars-rot13/#orgcfaa82e">Using translate and maketrans</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org9016827">
<h2 id="org9016827">Description</h2>
<div class="outline-text-2" id="text-org9016827">
<p>Given a string, replace each letter with the one that comes 13 letters after it in the alphabet. Ignore non-English aphabetical characters.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org138b811">
<h2 id="org138b811">The Code</h2>
<div class="outline-text-2" id="text-org138b811"></div>
<div class="outline-3" id="outline-container-orgadea759">
<h3 id="orgadea759">Imports</h3>
<div class="outline-text-3" id="text-orgadea759">
<ul class="org-ul">
<li><a href="https://docs.python.org/3/library/string.html">Python Strings</a>
<ul class="org-ul">
<li><a href="https://docs.python.org/3/library/string.html#string.ascii_lowercase">ascii_lowercase</a></li>
<li><a href="https://docs.python.org/3/library/string.html#string.ascii_lowercase">ascii_uppercase</a></li>
</ul>
</li>
</ul>
<div class="highlight">
<pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="n">ascii_lowercase</span> <span class="k">as</span> <span class="n">lowercase</span>
<span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="n">ascii_uppercase</span> <span class="k">as</span> <span class="n">uppercase</span>

<span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="n">equal</span><span class="p">,</span> <span class="n">expect</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgfffe53e">
<h3 id="orgfffe53e">The Submitted Function</h3>
<div class="outline-text-3" id="text-orgfffe53e">
<p>This is the version I submitted to CodeWars. It uses the dict <a href="https://docs.python.org/3/library/stdtypes.html#dict.update">update</a> method to build a dict (although the solutions below seem neater) and the <a href="https://docs.python.org/3/library/stdtypes.html#dict.get">get</a> method to handle the cases where the letter in the message isn't in the dictionary.</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">rot13</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">"""Implement a Caesar Cipher by shifting letters 13 places</span>

<span class="sd">    Non-english letters are left as-is</span>

<span class="sd">    Args:</span>
<span class="sd">     message: string to encode</span>

<span class="sd">    Return:</span>
<span class="sd">     the encoded version of the input string</span>
<span class="sd">    """</span>
    <span class="n">code</span> <span class="o">=</span> <span class="p">{</span><span class="n">letter</span><span class="p">:</span> <span class="n">lowercase</span><span class="p">[(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">13</span><span class="p">)</span> <span class="o">%</span> <span class="mi">26</span><span class="p">]</span> 
             <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">letter</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lowercase</span><span class="p">)}</span>
    <span class="n">code</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">letter</span><span class="p">,</span> <span class="n">uppercase</span><span class="p">[(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">13</span><span class="p">)</span> <span class="o">%</span> <span class="mi">26</span><span class="p">])</span>
                  <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">letter</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">uppercase</span><span class="p">))</span>
    <span class="k">return</span> <span class="s2">""</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="n">letter</span><span class="p">)</span> <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">message</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org740e508">
<h3 id="org740e508">A Test</h3>
<div class="outline-text-3" id="text-org740e508">
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">tester</span><span class="p">(</span><span class="n">encoder</span><span class="p">):</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"test"</span><span class="p">,</span> <span class="s2">"Test"</span><span class="p">,</span> <span class="s2">"Test5"</span><span class="p">)</span>
    <span class="n">expecteds</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"grfg"</span><span class="p">,</span> <span class="s2">"Grfg"</span><span class="p">,</span> <span class="s2">"Grfg5"</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">message</span><span class="p">,</span> <span class="n">expected</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">expecteds</span><span class="p">):</span>
        <span class="n">encoded</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="n">expect</span><span class="p">(</span><span class="n">encoded</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">expected</span><span class="p">))</span>
        <span class="n">expect</span><span class="p">(</span><span class="n">encoder</span><span class="p">(</span><span class="n">encoded</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>
    <span class="k">return</span>

<span class="n">tester</span><span class="p">(</span><span class="n">rot13</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org65937da">
<h2 id="org65937da">Alternatives</h2>
<div class="outline-text-2" id="text-org65937da">
<p>Quite a few of the other solutions (on the first page, anyway) used the built in <a href="https://docs.python.org/3/library/stdtypes.html#str.maketrans">str.maketrans</a> and <a href="https://docs.python.org/3/library/stdtypes.html#str.translate">str.translate</a> methods (they complement each other). I didn't see anything in the documentation about how defaults are handled so I'd have to look into it more. The <a href="https://www.codewars.com/kata/reviews/545683f329ccbfe984000087/groups/545747a40a80d2f02800014a">top answer</a> also used slicing instead of modulo (<code>lower[13:] + lower[:13])</code> which might be better. The comments mention that the top answer actually won't work anymore since the <code>maketrans</code> and <code>translate</code> functions got moved out of <code>string</code> (which is where it's importing it from).</p>
<p>The top solutions seem to have a mix of current python and deprecated python (python 2?) so you'd have to be careful in using any of them.</p>
</div>
<div class="outline-3" id="outline-container-org27aba37">
<h3 id="org27aba37">Using the Slicing</h3>
<div class="outline-text-3" id="text-org27aba37">
<p>If you were use slicing instead of the modulo I think it might look like this (from here on out I'm going to declare the code-books outside the function the way I would normally do it, I kind of didn't really think about it when submitting the solution above so I'll leave it as is).</p>
<div class="highlight">
<pre><span></span><span class="n">CODE</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">lowercase</span> <span class="o">+</span> <span class="n">uppercase</span><span class="p">,</span>
                <span class="n">lowercase</span><span class="p">[</span><span class="mi">13</span><span class="p">:]</span> <span class="o">+</span> <span class="n">lowercase</span><span class="p">[:</span><span class="mi">13</span><span class="p">]</span> <span class="o">+</span>
                <span class="n">uppercase</span><span class="p">[</span><span class="mi">13</span><span class="p">:]</span> <span class="o">+</span> <span class="n">uppercase</span><span class="p">[:</span><span class="mi">13</span><span class="p">]))</span>

<span class="k">def</span> <span class="nf">rot13_2</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">"""Implement a Caesar Cipher by shifting letters 13 places</span>

<span class="sd">    Non-english letters are left as-is</span>

<span class="sd">    Args:</span>
<span class="sd">     message: string to encode</span>

<span class="sd">    Return:</span>
<span class="sd">     the encoded version of the input string</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="s2">""</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">CODE</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="n">letter</span><span class="p">)</span> <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">message</span><span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">tester</span><span class="p">(</span><span class="n">rot13_2</span><span class="p">)</span>
</pre></div>
<p>This is more compact, although I'm not sure that the slicing is as immediately obvious as the use of the modulo is.</p>
</div>
</div>
<div class="outline-3" id="outline-container-orgcfaa82e">
<h3 id="orgcfaa82e">Using translate and maketrans</h3>
<div class="outline-text-3" id="text-orgcfaa82e">
<p>Here's a version using the built-in <code>maketrans</code> and <code>translate</code> functions.</p>
<div class="highlight">
<pre><span></span><span class="n">CODE</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="n">lowercase</span> <span class="o">+</span> <span class="n">uppercase</span><span class="p">,</span>
                     <span class="n">lowercase</span><span class="p">[</span><span class="mi">13</span><span class="p">:]</span> <span class="o">+</span> <span class="n">lowercase</span><span class="p">[:</span><span class="mi">13</span><span class="p">]</span> <span class="o">+</span>
                     <span class="n">uppercase</span><span class="p">[</span><span class="mi">13</span><span class="p">:]</span> <span class="o">+</span> <span class="n">uppercase</span><span class="p">[:</span><span class="mi">13</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">rot13_3</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">"""Implement a Caesar Cipher by shifting letters 13 places</span>

<span class="sd">    Non-english letters are left as-is</span>

<span class="sd">    Args:</span>
<span class="sd">     message: string to encode</span>

<span class="sd">    Return:</span>
<span class="sd">     the encoded version of the input string</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">message</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">CODE</span><span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">tester</span><span class="p">(</span><span class="n">rot13_3</span><span class="p">)</span>
<span class="n">coded</span> <span class="o">=</span> <span class="n">rot13_3</span><span class="p">(</span><span class="s2">"I have been to paradise 3 times, but I have never been to me. "</span>
                <span class="s2">"Oh, the humanity!"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">coded</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rot13_3</span><span class="p">(</span><span class="n">coded</span><span class="p">))</span>
</pre></div>
<pre class="example">
V unir orra gb cnenqvfr 3 gvzrf, ohg V unir arire orra gb zr. Bu, gur uhznavgl!
I have been to paradise 3 times, but I have never been to me. Oh, the humanity!
</pre>
<p>It kind of seems too much to use translate for this exercise, but it does feel cleaner than the dictionary, so I'll have to keep it in mind for the future.</p>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/codewars-calculating-with-functions/">CodeWars: Calculating With Functions</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/codewars-calculating-with-functions/" rel="bookmark"><time class="published dt-published" datetime="2022-02-10T17:52:52-08:00" itemprop="datePublished" title="2022-02-10 17:52">2022-02-10 17:52</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/codewars-calculating-with-functions/#orgd2c92a4">The Problem</a></li>
<li><a href="posts/codewars-calculating-with-functions/#orged047f5">The Solution</a>
<ul>
<li><a href="posts/codewars-calculating-with-functions/#org44e2fc0">The Tests</a></li>
</ul>
</li>
<li><a href="posts/codewars-calculating-with-functions/#orge683379">Alternatives</a></li>
<li><a href="posts/codewars-calculating-with-functions/#org008359d">A Hybrid</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgd2c92a4">
<h2 id="orgd2c92a4">The Problem</h2>
<div class="outline-text-2" id="text-orgd2c92a4">
<p>Write functions that calculate integer arithmetic. For example.</p>
<div class="highlight">
<pre><span></span><span class="n">seven</span><span class="p">(</span><span class="n">times</span><span class="p">(</span><span class="n">five</span><span class="p">()))</span>
</pre></div>
<p>Should return thirty-five. Every number has a function and there are four operation-functions:</p>
<ul class="org-ul">
<li><code>plus</code></li>
<li><code>minus</code></li>
<li><code>times</code></li>
<li><code>divided_by</code></li>
</ul>
<p>All operations should return integers, not floats.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orged047f5">
<h2 id="orged047f5">The Solution</h2>
<div class="outline-text-2" id="text-orged047f5">
<div class="highlight">
<pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="k">def</span> <span class="nf">digit</span><span class="p">(</span><span class="n">operation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""A base function to define a digit</span>

<span class="sd">    Args:</span>
<span class="sd">     operation: a function that expects an integer argument when called</span>
<span class="sd">     integer: an integer to return if no operation is passed in</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">operation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">operation</span><span class="p">(</span><span class="n">integer</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">integer</span>

<span class="c1"># the digits</span>
<span class="n">zero</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">one</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">two</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">three</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">four</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">five</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">six</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">seven</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">eight</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">nine</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="c1"># the operations</span>
<span class="k">def</span> <span class="nf">plus</span><span class="p">(</span><span class="n">right</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">left</span><span class="p">:</span> <span class="n">left</span> <span class="o">+</span> <span class="n">right</span>

<span class="k">def</span> <span class="nf">minus</span><span class="p">(</span><span class="n">right</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">left</span><span class="p">:</span> <span class="n">left</span> <span class="o">-</span> <span class="n">right</span>

<span class="k">def</span> <span class="nf">times</span><span class="p">(</span><span class="n">right</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">left</span><span class="p">:</span> <span class="n">left</span> <span class="o">*</span> <span class="n">right</span>

<span class="k">def</span> <span class="nf">divided_by</span><span class="p">(</span><span class="n">right</span><span class="p">):</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">left</span><span class="p">:</span> <span class="n">left</span> <span class="o">//</span> <span class="n">right</span>
</pre></div>
</div>
<div class="outline-3" id="outline-container-org44e2fc0">
<h3 id="org44e2fc0">The Tests</h3>
<div class="outline-text-3" id="text-org44e2fc0">
<div class="highlight">
<pre><span></span><span class="n">expect</span><span class="p">(</span><span class="n">seven</span><span class="p">(</span><span class="n">times</span><span class="p">(</span><span class="n">five</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">four</span><span class="p">(</span><span class="n">plus</span><span class="p">(</span><span class="n">nine</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">eight</span><span class="p">(</span><span class="n">minus</span><span class="p">(</span><span class="n">three</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">six</span><span class="p">(</span><span class="n">divided_by</span><span class="p">(</span><span class="n">two</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orge683379">
<h2 id="orge683379">Alternatives</h2>
<div class="outline-text-2" id="text-orge683379">
<p>There are several variations on the theme. One that I thought was similar in spirit to what I did but better was <a href="https://www.codewars.com/kata/reviews/5b0ce29de86c548f16000e76/groups/5c92714817647a0001bac149">this one</a>. Instead of separate operation and integer they use a default function that only returns what gets passed to it. So the definitions look like this.</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">identity</span><span class="p">(</span><span class="n">integer</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">integer</span>

<span class="k">def</span> <span class="nf">zero</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">one</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">two</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">three</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">four</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">five</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">six</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">seven</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">eight</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">nine</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">seven</span><span class="p">(</span><span class="n">times</span><span class="p">(</span><span class="n">five</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">four</span><span class="p">(</span><span class="n">plus</span><span class="p">(</span><span class="n">nine</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">eight</span><span class="p">(</span><span class="n">minus</span><span class="p">(</span><span class="n">three</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">six</span><span class="p">(</span><span class="n">divided_by</span><span class="p">(</span><span class="n">two</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org008359d">
<h2 id="org008359d">A Hybrid</h2>
<div class="outline-text-2" id="text-org008359d">
<p>To add a little of what the other solution is doingâ€¦</p>
<div class="highlight">
<pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="k">def</span> <span class="nf">identity</span><span class="p">(</span><span class="n">integer</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">"""A pass-through function</span>

<span class="sd">    Args:</span>
<span class="sd">     integer: a digit input</span>

<span class="sd">    Returns:</span>
<span class="sd">     the integer given</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">integer</span>

<span class="k">def</span> <span class="nf">digit</span><span class="p">(</span><span class="n">operation</span><span class="o">=</span><span class="n">identity</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""A base function to define a digit</span>

<span class="sd">    Args:</span>
<span class="sd">     operation: a function that expects an integer argument when called</span>
<span class="sd">     integer: an integer to return if no operation is passed in</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">operation</span><span class="p">(</span><span class="n">integer</span><span class="p">)</span>

<span class="c1"># the digits</span>
<span class="n">zero</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">one</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">two</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">three</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">four</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">five</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">six</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">seven</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">eight</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">nine</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="c1"># the operations</span>
<span class="c1"># this is a style some people used. I'm not sure I like it.</span>
<span class="n">plus</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">right</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">left</span><span class="p">:</span> <span class="n">left</span> <span class="o">+</span> <span class="n">right</span>
<span class="n">minus</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">right</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">left</span><span class="p">:</span> <span class="n">left</span> <span class="o">-</span> <span class="n">right</span>

<span class="c1"># alternatively you could just do this</span>
<span class="k">def</span> <span class="nf">times</span><span class="p">(</span><span class="n">right</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span> <span class="k">return</span> <span class="k">lambda</span> <span class="n">left</span><span class="p">:</span> <span class="n">left</span> <span class="o">*</span> <span class="n">right</span>
<span class="k">def</span> <span class="nf">divided_by</span><span class="p">(</span><span class="n">right</span><span class="p">):</span> <span class="k">return</span> <span class="k">lambda</span> <span class="n">left</span><span class="p">:</span> <span class="n">left</span> <span class="o">//</span> <span class="n">right</span>

<span class="n">expect</span><span class="p">(</span><span class="n">seven</span><span class="p">(</span><span class="n">times</span><span class="p">(</span><span class="n">five</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">four</span><span class="p">(</span><span class="n">plus</span><span class="p">(</span><span class="n">nine</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">eight</span><span class="p">(</span><span class="n">minus</span><span class="p">(</span><span class="n">three</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">six</span><span class="p">(</span><span class="n">divided_by</span><span class="p">(</span><span class="n">two</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/coding-train-starfield/">Coding Train Starfield</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/coding-train-starfield/" rel="bookmark"><time class="published dt-published" datetime="2022-02-10T15:19:02-08:00" itemprop="datePublished" title="2022-02-10 15:19">2022-02-10 15:19</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/coding-train-starfield/#orgbc50a66">The Starfield</a></li>
<li><a href="posts/coding-train-starfield/#org64007f4">The Main Sketch</a>
<ul>
<li><a href="posts/coding-train-starfield/#orgead4526">The Setup Function</a></li>
<li><a href="posts/coding-train-starfield/#orgc073e18">Draw</a></li>
</ul>
</li>
<li><a href="posts/coding-train-starfield/#org807dccc">The Star Class</a>
<ul>
<li><a href="posts/coding-train-starfield/#org3c28959">The Update</a></li>
<li><a href="posts/coding-train-starfield/#org973af2c">The Show Function</a></li>
</ul>
</li>
<li><a href="posts/coding-train-starfield/#org49956eb">Attaching the Sketch</a></li>
<li><a href="posts/coding-train-starfield/#orga11097f">Source</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgbc50a66">
<h2 id="orgbc50a66">The Starfield</h2>
<div class="outline-text-2" id="text-orgbc50a66">
<p>This is another <a href="https://p5js.org/">p5.js</a> hello-world, this time taken from Daniel Schiffman's <a href="https://thecodingtrain.com/CodingChallenges/001-starfield.html">Starfield in Processing</a> coding challenge. It's a rough version of traveling through the stars at warp speed. He managed to do it in about 15 minutes, if I remember correctly. It starts static but if you move your mouse back and forth horizontally it adjusts the speed.</p>
<script language="javascript" src="posts/coding-train-starfield/starfield.js" type="text/javascript"></script>
<div id="schiffman-starfield"></div>
</div>
</div>
<div class="outline-2" id="outline-container-org64007f4">
<h2 id="org64007f4">The Main Sketch</h2>
<div class="outline-text-2" id="text-org64007f4">
<p>The most basic processing/p5 sketch uses two functions <code>setup</code> to initially set up your canvas and <code>draw</code> to update the frames over time. This function creates our canvas and star objects in the <code>setup</code> and then calculates a <code>speed</code> based on the mouse position of the user in order to update the stars. It gets passed a p5 element, called p, in order to get access to the p5.js code.</p>
<div class="highlight">
<pre><span></span><span class="cm">/** The main sketch</span>
<span class="cm"> * this gets passed to p5 so it defines the setup and draw functions</span>
<span class="cm"> * that p5 expects</span>
<span class="cm">*/</span><span class="w"></span>
<span class="kd">let</span><span class="w"> </span><span class="nx">starfield_sketch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">star_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">800</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">parent_div_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"schiffman-starfield"</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="nx">p</span><span class="p">.</span><span class="nx">BLACK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="nx">p</span><span class="p">.</span><span class="nx">WHITE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">255</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="nx">p</span><span class="p">.</span><span class="nx">ALPHA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<div class="outline-3" id="outline-container-orgead4526">
<h3 id="orgead4526">The Setup Function</h3>
<div class="outline-text-3" id="text-orgead4526">
<p>Not too much voodoo here, other than the use of the <a href="https://api.jquery.com/outerWidth/">JQuery outerWidth</a> method which gets the width of the DIV that we're using to hold the sketch and uses it as the width for the canvas.</p>
<div class="highlight">
<pre><span></span><span class="nx">p</span><span class="p">.</span><span class="nx">setup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">p</span><span class="p">.</span><span class="nx">stars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span><span class="w"></span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">canvas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">createCanvas</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">"#"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">parent_div_id</span><span class="p">).</span><span class="nx">outerWidth</span><span class="p">(</span><span class="kc">true</span><span class="p">),</span><span class="w"> </span><span class="mf">800</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">star_count</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">stars</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Star</span><span class="p">(</span><span class="nx">p</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// end setup</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgc073e18">
<h3 id="orgc073e18">Draw</h3>
<div class="outline-text-3" id="text-orgc073e18">
<p>Again, not too fancy. The draw function:</p>
<ul class="org-ul">
<li>Sets the background to black to wipe out our previous drawing</li>
<li>gets the "speed" of the stars using the x-position of the mouse and mapping this location from 0 to the width of the canvas to a smaller range from 0 to 50</li>
<li>Translate the (0, 0) of the coordinate system from the top left of the canvas to the middle so our stars emerge from the center instead of the top left</li>
<li>update all the stars with the speed and re-draw them</li>
</ul>
<div class="highlight">
<pre><span></span><span class="w">  </span><span class="nx">p</span><span class="p">.</span><span class="nx">draw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">background</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">BLACK</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">ALPHA</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="nx">speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">mouseX</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">50</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">translate</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="o">/</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">height</span><span class="o">/</span><span class="mf">2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">stars</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">      </span><span class="nx">p</span><span class="p">.</span><span class="nx">stars</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">update</span><span class="p">(</span><span class="nx">speed</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="nx">p</span><span class="p">.</span><span class="nx">stars</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">show</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="c1">//end draw</span><span class="w"></span>
<span class="p">};</span><span class="w"> </span><span class="c1">//end starfield_sketch</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org807dccc">
<h2 id="org807dccc">The Star Class</h2>
<div class="outline-text-2" id="text-org807dccc">
<p>The <code>Star</code> stores the position of a "star" and updates it based on the speed that it's given. Our initial constructor sets up the coordinates of the star using random values.</p>
<div class="highlight">
<pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">Star</span><span class="p">(</span><span class="nx">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="o">-</span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="o">-</span><span class="nx">p</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<div class="outline-3" id="outline-container-org3c28959">
<h3 id="org3c28959">The Update</h3>
<div class="outline-text-3" id="text-org3c28959">
<p>Most of the time the update reduces the <code>z</code> value by the current speed, but since we don't want the stars to go off the canvas and disappear, if it gets too small we re-randomize the position of the star.</p>
<div class="highlight">
<pre><span></span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">speed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">speed</span><span class="w"></span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="o">-</span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="o">-</span><span class="nx">p</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">//end update</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org973af2c">
<h3 id="org973af2c">The Show Function</h3>
<div class="outline-text-3" id="text-org973af2c">
<p>The <code>show</code> function is where most of the work is done. It calculates the proprotions of x and y to z and then maps that to the width and height of the canvas and then draws an ellipse. To get the radius of the ellipse we map the current z-value using an inverted target of 16, 0. This means that as z gets smaller our radius gets bigger.</p>
<div class="highlight">
<pre><span></span><span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">show</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">WHITE</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">x_now</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="o">/</span><span class="k">this</span><span class="p">.</span><span class="nx">z</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">y_now</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="o">/</span><span class="k">this</span><span class="p">.</span><span class="nx">z</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">radius</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">z</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span><span class="w"> </span><span class="mf">16</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">ellipse</span><span class="p">(</span><span class="nx">x_now</span><span class="p">,</span><span class="w"> </span><span class="nx">y_now</span><span class="p">,</span><span class="w"> </span><span class="nx">radius</span><span class="p">,</span><span class="w"> </span><span class="nx">radius</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">stroke</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">WHITE</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="c1">// end show</span><span class="w"></span>
<span class="p">};</span><span class="w"> </span><span class="c1">//end class Star</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org49956eb">
<h2 id="org49956eb">Attaching the Sketch</h2>
<div class="outline-text-2" id="text-org49956eb">
<p>This next bit attaches our sketch to a specific DIV defined in the HTML. You don't have to do this, you could just use the parts as universal functions like the examples show, but if you have more than one sketch on a page sometimes things get funky so I prefer this pattern to keep everything in place.</p>
<div class="highlight">
<pre><span></span><span class="c1">// Attach the starfield_sketch function at the top to the div with ID</span><span class="w"></span>
<span class="c1">// schiffman-starfield</span><span class="w"></span>
<span class="nx">sketch_container</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">p5</span><span class="p">(</span><span class="nx">starfield_sketch</span><span class="p">,</span><span class="w"> </span><span class="s1">'schiffman-starfield'</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orga11097f">
<h2 id="orga11097f">Source</h2>
<div class="outline-text-2" id="text-orga11097f">
<ul class="org-ul">
<li>Starfield in Processing [Internet]. The Coding Train. 2016 [cited 2022 Feb 10]. Available from: <a href="https://thecodingtrain.com/CodingChallenges/001-starfield.html">https://thecodingtrain.com/CodingChallenges/001-starfield.html</a></li>
</ul>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/codewars-vowel-count/">CodeWars: Vowel Count</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/codewars-vowel-count/" rel="bookmark"><time class="published dt-published" datetime="2022-02-09T13:42:40-08:00" itemprop="datePublished" title="2022-02-09 13:42">2022-02-09 13:42</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/codewars-vowel-count/#org644aaca">The Problem</a></li>
<li><a href="posts/codewars-vowel-count/#org7dc6755">The Solution</a>
<ul>
<li><a href="posts/codewars-vowel-count/#org870e2e4">The Tests</a></li>
<li><a href="posts/codewars-vowel-count/#org8ceda09">The Function</a></li>
</ul>
</li>
<li><a href="posts/codewars-vowel-count/#orgaede425">Alternatives</a></li>
<li><a href="posts/codewars-vowel-count/#orgc56237e">End</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org644aaca">
<h2 id="org644aaca">The Problem</h2>
<div class="outline-text-2" id="text-org644aaca">
<p>Given a string, count the number of vowels in it. The vowels are "aeiou" and the letters will be lower-cased.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org7dc6755">
<h2 id="org7dc6755">The Solution</h2>
<div class="outline-text-2" id="text-org7dc6755"></div>
<div class="outline-3" id="outline-container-org870e2e4">
<h3 id="org870e2e4">The Tests</h3>
<div class="outline-text-3" id="text-org870e2e4">
<div class="highlight">
<pre><span></span><span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="n">equal</span><span class="p">,</span> <span class="n">expect</span>

<span class="n">expect</span><span class="p">(</span><span class="n">vowel_count</span><span class="p">(</span><span class="s2">"a"</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">vowel_count</span><span class="p">(</span><span class="s2">"rmnl"</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">vowel_count</span><span class="p">(</span><span class="s2">"a mouse is not a house"</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org8ceda09">
<h3 id="org8ceda09">The Function</h3>
<div class="outline-text-3" id="text-org8ceda09">
<div class="highlight">
<pre><span></span><span class="n">VOWELS</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="s2">"aeiou"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">vowel_count</span><span class="p">(</span><span class="n">letters</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">"""Counts the number of vowels in the input</span>

<span class="sd">    Args:</span>
<span class="sd">     letters: lower-cased string to check for vowels</span>

<span class="sd">    Returns:</span>
<span class="sd">     count of vowels in the letters</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">letters</span> <span class="k">if</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">VOWELS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgaede425">
<h2 id="orgaede425">Alternatives</h2>
<div class="outline-text-2" id="text-orgaede425">
<p><a href="https://www.codewars.com/kata/reviews/54ff37ee355cfd937000105c/groups/54ff8310c50295aa890004d3">One solution</a> used regular expressions and the <code>findall</code> method. This seems better in a generalizable sense, but I think that the <code>findall</code> will build a list rather than a generator so might not be as efficient space-wise, and is probably slower. Others used the python string method - <code>count</code>. I think this problem is so easy that there's really not a lot of stuff you can do that doesn't overcomplicate things.</p>
<p>Anyway, day one.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgc56237e">
<h2 id="orgc56237e">End</h2>
<div class="outline-text-2" id="text-orgc56237e">
<ul class="org-ul">
<li><a href="https://www.codewars.com/kata/54ff3102c1bad923760001f3">CodeWars Vowel Count</a>: One of the beginner's kata.</li>
</ul>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/mozilla-madness-resist-fingerprinting/">Mozilla Madness: Resist Fingerprinting!</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/mozilla-madness-resist-fingerprinting/" rel="bookmark"><time class="published dt-published" datetime="2021-12-23T13:54:12-08:00" itemprop="datePublished" title="2021-12-23 13:54">2021-12-23 13:54</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/mozilla-madness-resist-fingerprinting/#orge59654c">The Short Version For My Future Self</a></li>
<li><a href="posts/mozilla-madness-resist-fingerprinting/#org2170595">Back To the Story: It Was a Dark and Rainy Day</a></li>
<li><a href="posts/mozilla-madness-resist-fingerprinting/#org7eefe30">Start With the Nuclear Option</a></li>
<li><a href="posts/mozilla-madness-resist-fingerprinting/#org22e8d8c">The Slow Crawl Back</a></li>
<li><a href="posts/mozilla-madness-resist-fingerprinting/#orgef66adc">Is It a Bug?</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orge59654c">
<h2 id="orge59654c">The Short Version For My Future Self</h2>
<div class="outline-text-2" id="text-orge59654c">
<p>Although some sites tell you to set Firefox's <code>privacy.resistFingerprinting</code> option to true, it breaks altair's interaction and some other sites that use the canvas. It's probably better not to use that option, but if you do either:</p>
<ul class="org-ul">
<li>Install the <a href="https://addons.mozilla.org/en-US/firefox/addon/toggle-resist-fingerprinting/">Toggle Resist Fingerprinting</a> extension and turn it off when things break (or just keep turning it off in <code>about:config</code>).</li>
<li>Or set <code>privacy.resistFingerprinting.autoDeclineNoUserInputCanvasPrompts</code> to False and accept the popup requests for the page you want to use.</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org2170595">
<h2 id="org2170595">Back To the Story: It Was a Dark and Rainy Day</h2>
<div class="outline-text-2" id="text-org2170595">
<p>I decided to give <a href="https://altair-viz.github.io/">altair</a>, the python data visualization library a try yesterday, just to see what it looked like. I ran their "hello, world" example and managed to get a plot.</p>
<object data="posts/mozilla-madness-resist-fingerprinting/test-bar-plot.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>Nothing fancy. If you move your cursor over the bars you might get a tool-tip giving you the width of the bar. If you do then you don't have the problem I ran into yesterday when I was trying it out. The image itself came out clear enough, but I couldn't figure out how to make the tool-tips work. I got desperate enough to try and read the documentation but it seems to be split between examples and API descriptions with little more in the way of explanatory documentation that would help to figure out how it was supposed to work. There are a lot of examples, though, so I decided to see if they would help, but then when I was looking at their <a href="https://altair-viz.github.io/gallery/scatter_tooltips.html">Scatter Plot with Tool-tips</a> example I noticed that their plots didn't have tool-tips either, which seemed suspicious. Was their library that broken? Was the internet?</p>
<p>I took a look at the JavaScript console and that's when I saw these messages.</p>
<p><img alt="nil" src="posts/mozilla-madness-resist-fingerprinting/blocked-canvas-data.png"></p>
<p>It looked like it might be important, but when I went searching for the message I couldn't find anything relevant. At least not at first.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org7eefe30">
<h2 id="org7eefe30">Start With the Nuclear Option</h2>
<div class="outline-text-2" id="text-org7eefe30">
<p>My first thought was that they had somehow made altair Chromium-only so I installed <a href="https://brave.com/">brave</a> and, sure enough, the tool-tips worked when I switched browsers. So my initial conclusion was that I'd have to switch browsers if I decided to use altair. But then it occurred to me that I'd had problems in the past with some sites and anti-tracking options turned on in firefox so maybe it had something to do with that or one of the extensions. The question was, what setting was it or what extension? I eventually decided it was too much work to figure out so I first tried to use <a href="https://support.mozilla.org/en-US/kb/diagnose-firefox-issues-using-troubleshoot-mode">Troubleshoot Mode</a> to disable all the extensions, and when that didn't work, I did a <a href="https://support.mozilla.org/en-US/kb/refresh-firefox-reset-add-ons-and-settings">refresh</a> and wiped out all the customizations I'd done to firefox. Amazingly, this worked, but now I had to go about setting Firefox up again while avoiding whatever I did that broke altair.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org22e8d8c">
<h2 id="org22e8d8c">The Slow Crawl Back</h2>
<div class="outline-text-2" id="text-org22e8d8c">
<p>I decided to follow the advice on the <a href="https://restoreprivacy.com/firefox-privacy/">restoreprivacy.com</a> page, just because it came up on the first page of my search results and it seemed to touch most of the bases that I'd run before this episode. As I did a step in the setup I would check back with the altair plot to make sure that the tool-tip was still working until, eventually, I came to the setting that broke it - <code>privacy.resistFingerprinting</code>.</p>
<p><img alt="nil" src="posts/mozilla-madness-resist-fingerprinting/resist-fingerprinting.png"></p>
<p>When I set it to true the tool-tips would break and when I set it to false they would work again. So, then what? I didn't want to disable fingerprint protection, so I thought I'd do a little more searching and see if there was another way.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgef66adc">
<h2 id="orgef66adc">Is It a Bug?</h2>
<div class="outline-text-2" id="text-orgef66adc">
<p>I decided to do a search on <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox">Bugzilla</a> and found what seemed like a relevant bug: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1631673">WhatsApp Web images broken if you flip `privacy.resistFingerprinting` due to canvas prompts without user interaction</a>. The discussion is about What's App and also mentions Instagram and Twitter, and although they are focused on images, the actual error seemed close enough to what I was seeing that it seemed like it might be the same or a similar thing. But the bug was opened two years ago, so if it is a bug it doesn't seem to be something they're eager to fix. Then I ran across this bug: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1376865">Do not display Canvas Prompt unless triggered by user input</a> which discusses changing the default behavior to not prompt the user for permission to use the canvas. Now that I'm describing it I'm not sure how I came to this next step based on that bug, but for some reason I went looking in <code>about:config</code> again and noticed that right under <code>resistFingerprinting</code> was <code>resistFingerprinting.autoDeclineNoUserInputCanvasPrompts</code>:</p>
<p><img alt="nil" src="posts/mozilla-madness-resist-fingerprinting/auto-decline.png"></p>
<p>This option is set to True by default and seemed to be what they were talking about in the bug so I turned it off and went back to the altair page and this time when I put my cursor over the plot a popup came up asking me for permission.</p>
<p><img alt="nil" src="posts/mozilla-madness-resist-fingerprinting/allow-dialog.png"></p>
<p>Once allowed it, it worked, even with <code>resistFingerprinting</code> set to true. So, if I understand what the bug reports were saying, what was causing the problem is that firefox is getting a request for the canvas but it decides that it isn't the user initiating it, so it needs extra permission but by default the box to ask for permission is turned off and the request is declined without the user (me) getting any feedback. This <i>seemed</i> like a bug.</p>
<p>As I was thinking about this I remembered that a couple of days ago I went to the kindle cloud reader and one of the books wouldn't render. I went back and played with turning <code>resistFingerprinting</code> on and off before trying to load the ebook and this <i>was</i> apparently the culprit so it isn't just altair that's affected for me.</p>
<p>So it's a bug, right? It seemed like one, but there were already reports of this phenomena for other sites going back years so they appear to have done it on purpose. I was trying to figure out whether it was something that should be reported or not when I came upon this bug: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1666160">Users enable `privacy.resistFingerprinting` and then are surprised when it causes problems</a>.</p>
<p><img alt="nil" src="posts/mozilla-madness-resist-fingerprinting/surprise-bug.png"></p>
<p>Despite the fact that I've seen multiple sites saying to enable this "feature" maybe it isn't really a good idea after all. In the near-term I installed the <a href="https://addons.mozilla.org/en-US/firefox/addon/toggle-resist-fingerprinting/">Toggle Resist Fingerprinting</a> extension and use it to turn <code>resistFingerprinting</code> on and off. To be honest, I'm not convinced that it really matters, I just got sucked into a trail of sites making conflicting assertions about what to do and convinced myself that I cared. At least I can read kindle books in the browser again.</p>
</div>
</div>
</div>
</article>
</div>
<ul class="pager postindexpager clearfix">
<li class="next"><a href="index-20.html" rel="next">Older posts</a></li>
</ul>
<!--End of body content-->
<footer id="footer">Contents Â© 2023 <a href="mailto:cloisteredmonkey.jmark@slmail.me">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script>
</body>
</html>
