<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>The Cloistered Monkey (Posts about Windows)</title><link>https://necromuralist.github.io/</link><description></description><atom:link href="https://necromuralist.github.io/categories/windows.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents Â© 2019 &lt;a href="mailto:necromuralist@protonmail.com"&gt;Cloistered Monkey&lt;/a&gt; </copyright><lastBuildDate>Wed, 02 Jan 2019 00:34:08 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Getting Wireless Information From Netsh</title><link>https://necromuralist.github.io/posts/201209getting-wireless-information-from-netsh/</link><dc:creator>Cloistered Monkey</dc:creator><description>&lt;div class="document" id="getting-wireless-information-from-netsh"&gt;&lt;a class="reference external" href="http://support.microsoft.com/kb/242468"&gt;netsh&lt;/a&gt; is a command-line utility to configure a Windows machine from the command-line. Here I'm going to show the commands to get information about the wireless interface.&lt;br&gt;&lt;div class="section" id="the-base-query-command"&gt;&lt;h4&gt;The Base Query Command&lt;/h4&gt;The command takes the form:&lt;br&gt;&lt;pre class="literal-block"&gt;netsh wlan show &amp;lt;what&amp;gt;&lt;br&gt;&lt;/pre&gt;&lt;div class="section" id="the-whats"&gt;&lt;h5&gt;The Whats&lt;/h5&gt;&lt;cite&gt;all&lt;/cite&gt;:&lt;br&gt;&lt;pre class="literal-block"&gt;netsh wlan show all&lt;br&gt;&lt;/pre&gt;Shows all the available information concatenated together.&lt;br&gt;&lt;cite&gt;drivers&lt;/cite&gt;:&lt;br&gt;&lt;pre class="literal-block"&gt;netsh wlan show drivers&lt;br&gt;&lt;/pre&gt;Shows driver information for the interface.&lt;br&gt;&lt;cite&gt;interface&lt;/cite&gt;:&lt;br&gt;&lt;pre class="literal-block"&gt;netsh wlan show interface&lt;br&gt;&lt;/pre&gt;Shows the interface information. Sample output:&lt;br&gt;&lt;pre class="literal-block"&gt;There is 1 interface on the system:&lt;br&gt;&lt;br&gt;    Name                   : Wireless Network Connection&lt;br&gt;    Description            : Intel(R) Centrino(R) Wireless-N 100&lt;br&gt;    GUID                   : 580dc1eb-f5cd-4eb9-8483-cff1a9e2f0f8&lt;br&gt;    Physical address       : 78:92:9c:8d:e1:5e&lt;br&gt;    State                  : connected&lt;br&gt;    SSID                   : allionstaff&lt;br&gt;    BSSID                  : 18:33:9d:f9:ad:10&lt;br&gt;    Network type           : Infrastructure&lt;br&gt;    Radio type             : 802.11g&lt;br&gt;    Authentication         : WPA2-Personal&lt;br&gt;    Cipher                 : CCMP&lt;br&gt;    Connection mode        : Auto Connect&lt;br&gt;    Channel                : 6&lt;br&gt;    Receive rate (Mbps)    : 72&lt;br&gt;    Transmit rate (Mbps)   : 72&lt;br&gt;    Signal                 : 99%&lt;br&gt;    Profile                : allionstaff&lt;br&gt;&lt;br&gt;    Hosted network status  : Not started&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="section" id="getting-the-ip-address"&gt;&lt;h4&gt;Getting The IP Address&lt;/h4&gt;To get the IP address you need to use a different subset (not &lt;cite&gt;wlan&lt;/cite&gt;):&lt;br&gt;&lt;pre class="literal-block"&gt;netsh interface ipv4 show addresses&lt;br&gt;&lt;/pre&gt;Sample output:&lt;br&gt;&lt;pre class="literal-block"&gt;Configuration for interface "Wireless Network Connection 3"&lt;br&gt;    DHCP enabled:                         Yes&lt;br&gt;    InterfaceMetric:                      5&lt;br&gt;&lt;br&gt;Configuration for interface "Wireless Network Connection 2"&lt;br&gt;    DHCP enabled:                         Yes&lt;br&gt;    InterfaceMetric:                      5&lt;br&gt;&lt;br&gt;Configuration for interface "Wireless Network Connection"&lt;br&gt;    DHCP enabled:                         Yes&lt;br&gt;    IP Address:                           192.168.2.84&lt;br&gt;    Subnet Prefix:                        192.168.2.0/24 (mask 255.255.255.0)&lt;br&gt;    Default Gateway:                      192.168.2.1&lt;br&gt;    Gateway Metric:                       0&lt;br&gt;    InterfaceMetric:                      25&lt;br&gt;&lt;br&gt;Configuration for interface "Local Area Connection"&lt;br&gt;    DHCP enabled:                         No&lt;br&gt;    IP Address:                           192.168.10.63&lt;br&gt;    Subnet Prefix:                        192.168.10.0/24 (mask 255.255.255.0)&lt;br&gt;    Default Gateway:                      192.168.10.1&lt;br&gt;    Gateway Metric:                       256&lt;br&gt;    InterfaceMetric:                      10&lt;br&gt;&lt;br&gt;Configuration for interface "Loopback Pseudo-Interface 1"&lt;br&gt;    DHCP enabled:                         No&lt;br&gt;    IP Address:                           127.0.0.1&lt;br&gt;    Subnet Prefix:                        127.0.0.0/8 (mask 255.0.0.0)&lt;br&gt;    InterfaceMetric:                      50&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</description><category>Windows</category><guid>https://necromuralist.github.io/posts/201209getting-wireless-information-from-netsh/</guid><pubDate>Fri, 07 Sep 2012 09:20:00 GMT</pubDate></item><item><title>Using WMIC to Enable and Disable The Wireless Network Adapter</title><link>https://necromuralist.github.io/posts/201209using-wmic-to-enable-and-disable_6/</link><dc:creator>Cloistered Monkey</dc:creator><description>&lt;div class="document" id="using-wmic-to-enable-and-disable-the-wireless-network-adapter"&gt;&lt;div class="section" id="the-utility"&gt;&lt;h4&gt;The Utility&lt;/h4&gt;&lt;em&gt;WMIC&lt;/em&gt; is the &lt;a class="reference external" href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa394531(v=vs.85).aspx"&gt;Windows Management Interface Command-line Utility&lt;/a&gt; a command-line interface to the WMI libraries. Here I'm going to focus on enabling and disabling the wireless interface.&lt;br&gt;&lt;strong&gt;Note:&lt;/strong&gt; Since these are &lt;em&gt;DOS&lt;/em&gt; commands they are case-insensitive (even inside quotes) so the mixed cases are only used to make it easier to read.&lt;/div&gt;&lt;div class="section" id="the-library"&gt;&lt;h4&gt;The Library&lt;/h4&gt;To enable and disable the interface you use the &lt;a class="reference external" href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa394216(v=vs.85).aspx"&gt;Win32_NetworkAdapter&lt;/a&gt; class.&lt;/div&gt;&lt;div class="section" id="the-interface"&gt;&lt;h4&gt;The Interface&lt;/h4&gt;To get the interface name you can list the interfaces:&lt;br&gt;&lt;pre class="literal-block"&gt;wmic path Win32_NetworkAdapter&lt;br&gt;&lt;/pre&gt;But this will dump a mess of lines so here we'll assume you just know it's &lt;em&gt;Wireless Network Connection&lt;/em&gt;  (if you click on the wireless icon on the TaskBar you'll see that this is the name above the list of visible access points). This value is used for the &lt;em&gt;NetConnectionID&lt;/em&gt; in the command.&lt;/div&gt;&lt;div class="section" id="to-dump-interface-information"&gt;&lt;h4&gt;To Dump Interface Information&lt;/h4&gt;If you want to dump all the Information:&lt;br&gt;&lt;pre class="literal-block"&gt;wmic path Win32_NetworkAdapter where NetConnectionID="Wireless Network Connection"&lt;br&gt;&lt;/pre&gt;If you want to get a single item (e.g. MAC Address):&lt;br&gt;&lt;pre class="literal-block"&gt;wmic path Win32_NetworkAdapter where NetConnectionID="Wireless Network Connection" get MacAddress&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class="section" id="to-enable-the-interface"&gt;&lt;h4&gt;To Enable the Interface&lt;/h4&gt;Call the &lt;cite&gt;enable&lt;/cite&gt; method:&lt;br&gt;&lt;pre class="literal-block"&gt;wmic path Win32_NetworkAdapter where NetConnectionID="Wireless Network Connection" call enable&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class="section" id="to-disable-the-interface"&gt;&lt;h4&gt;To Disable The Interface&lt;/h4&gt;Call the &lt;cite&gt;disable&lt;/cite&gt; method:&lt;br&gt;&lt;pre class="literal-block"&gt;wmic path Win32_NetworkAdapter where NetConnectionID="Wireless Network Connection" call disable&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class="section" id="errors"&gt;&lt;h4&gt;Errors&lt;/h4&gt;&lt;div class="section" id="call-errors"&gt;&lt;h5&gt;Call Errors&lt;/h5&gt;A successful change of the interface:&lt;br&gt;&lt;pre class="literal-block"&gt;Executing (\\IGOR\root\cimv2:Win32_NetworkAdapter.DeviceID="11")-&amp;gt;enable()&lt;br&gt;Method execution successful.&lt;br&gt;Out Parameters:&lt;br&gt;instance of __PARAMETERS&lt;br&gt;{&lt;br&gt;        ReturnValue = 0;&lt;br&gt;};&lt;br&gt;&lt;/pre&gt;An unsuccessful one will have a non-zero ReturnValue and message.&lt;/div&gt;&lt;div class="section" id="interface-name-errors"&gt;&lt;h5&gt;Interface Name Errors&lt;/h5&gt;If you use an invalid name you'll see:&lt;br&gt;&lt;pre class="literal-block"&gt;No Instance(s) Available.&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="section" id="maddening-variations"&gt;&lt;h4&gt;Maddening Variations&lt;/h4&gt;&lt;div class="section" id="cygwin"&gt;&lt;h5&gt;Cygwin&lt;/h5&gt;For unknown reasons, if you use a single pair of quotes in the command, you get the error:&lt;br&gt;&lt;pre class="literal-block"&gt;Node - IGOR&lt;br&gt;ERROR:&lt;br&gt;Description = Invalid query&lt;br&gt;&lt;/pre&gt;Where &lt;em&gt;IGOR&lt;/em&gt; is the name of the computer. To fix this you need to nest another pair of quotation marks inside the first. For example:&lt;br&gt;&lt;pre class="literal-block"&gt;wmic path win32_networkadapter where NetConnectionID="'Wireless networK connection'" get Macaddress&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class="section" id="non-interactive-ssh"&gt;&lt;h5&gt;Non-Interactive SSH&lt;/h5&gt;If you pass in the command as a string to an SSH Connection (e.g. in Paramiko), you need to put quotes around the whole thing and escape the nested quotation marks:&lt;br&gt;&lt;pre class="literal-block"&gt;'wmic path win32_networkadapter where NetConnectionID="\'Wireless networK connection\'" get Macaddress'&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</description><category>Windows</category><guid>https://necromuralist.github.io/posts/201209using-wmic-to-enable-and-disable_6/</guid><pubDate>Fri, 07 Sep 2012 09:20:00 GMT</pubDate></item></channel></rss>