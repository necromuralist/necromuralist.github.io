<html><body><div class="document" id="a-python-implementation-of-the-fixed-size-queue"><pre class="code python literal-block"><span class="sd">"""<br>A homogeneous fixed-size queue.<br>"""</span><br><br><span class="kn">from</span> <span class="nn">array</span> <span class="kn">import</span> <span class="n">array</span><br><br><span class="k">class</span> <span class="nc">FixedsizeQueue</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span><br>    <span class="sd">"""<br>    A fixed size queue is a homogeneous FIFO queue that can't grow.<br>    """</span><br>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_size</span><span class="p">,</span> <span class="n">typecode</span><span class="o">=</span><span class="s">'i'</span><span class="p">):</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="mi">0</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="mi">0</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">tail</span> <span class="o">=</span> <span class="mi">0</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">typecode</span> <span class="o">=</span> <span class="n">typecode</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">max_size</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="bp">None</span><br>        <span class="k">return</span><br><br>    <span class="nd">@property</span><br>    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span><br>        <span class="sd">"""<br>        :return: an array of size self.max, type self.typecode<br>        """</span><br>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span><br>            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">typecode</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">)])</span><br>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><br><br>    <span class="k">def</span> <span class="nf">enqueue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span><br>        <span class="sd">"""<br>        :param:<br><br>         - `item`: the item to add to the queue<br><br>        :return: True if added, False if full<br>        """</span><br>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">:</span><br>            <span class="k">return</span> <span class="bp">False</span><br><br>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><br><br>        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+=</span> <span class="mi">1</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">tail</span> <span class="o">+=</span> <span class="mi">1</span><br><br>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tail</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">:</span><br>            <span class="bp">self</span><span class="o">.</span><span class="n">tail</span> <span class="o">=</span> <span class="mi">0</span><br>        <span class="k">return</span> <span class="bp">True</span><br><br>    <span class="k">def</span> <span class="nf">dequeue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span><br>        <span class="sd">"""<br>        :return: oldest item or None<br>        """</span><br>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span><br>            <span class="k">return</span><br>        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">]</span><br><br>        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">-=</span> <span class="mi">1</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">+=</span> <span class="mi">1</span><br><br>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">:</span><br>            <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="mi">0</span><br>        <span class="k">return</span> <span class="n">item</span><br><br>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span><br>        <span class="sd">"""<br>        :postcondition: head, tail and size reset to 0<br>        """</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="mi">0</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">tail</span> <span class="o">=</span> <span class="mi">0</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="mi">0</span><br>        <span class="k">return</span><br><br>    <span class="k">def</span> <span class="nf">empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span><br>        <span class="sd">"""<br>        :return: True if the queue is empty.<br>        """</span><br>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><br><br>    <span class="k">def</span> <span class="nf">full</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span><br>        <span class="sd">"""<br>        :return: True if the queue is full.<br>        """</span><br>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><br><span class="c"># end class FixedsizeQueue</span><br></pre></div></body></html>