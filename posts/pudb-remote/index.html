<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Using the python-urwid debugger over telnet." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>PuDB Remote | The Cloistered Monkey</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/posts/pudb-remote/" rel="canonical"><!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]-->
<link href="../../apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="../../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../../site.webmanifest" rel="manifest">
<meta content="Cloistered Monkey" name="author">
<link href="../emacs-artifact-on-kubuntu/" rel="prev" title="Emacs Scrollbar Artifact on Kubuntu" type="text/html">
<link href="../mozilla-madness-resist-fingerprinting/" rel="next" title="Mozilla Madness: Resist Fingerprinting!" type="text/html">
<meta content="The Cloistered Monkey" property="og:site_name">
<meta content="PuDB Remote" property="og:title">
<meta content="https://necromuralist.github.io/posts/pudb-remote/" property="og:url">
<meta content="Using the python-urwid debugger over telnet." property="og:description">
<meta content="article" property="og:type">
<meta content="2021-11-17T18:29:13-08:00" property="article:published_time">
<meta content="debugging" property="article:tag">
<meta content="pudb" property="article:tag">
<meta content="python" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="../../"><span id="blog-title">The Cloistered Monkey</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="../../archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="../../categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="../../rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Projects</a>
<div class="dropdown-menu"><a class="dropdown-item" href="https://necromuralist.github.io/Anechoic-Echolalia/">Anechoic Echolalia</a> <a class="dropdown-item" href="https://necromuralist.github.io/Ape-Iron/">Ape Iron</a> <a class="dropdown-item" href="https://necromuralist.github.io/Homunculi-Hypergraphia/">Honumculi Hypergraphia</a> <a class="dropdown-item" href="https://necromuralist.github.io/Neurotic-Networking/">Neurotic Networking</a> <a class="dropdown-item" href="../../machine-learning-projects/">Machine Learning</a> <a class="dropdown-item" href="https://necromuralist.github.io/student_intervention/">Student Intervention Project</a> <a class="dropdown-item" href="https://necromuralist.github.io/boston_housing/">Boston Housing Project</a> <a class="dropdown-item" href="https://necromuralist.github.io/data_science/">Data Science With Python</a> <a class="dropdown-item" href="https://necromuralist.github.io/Visions-Voices-Data/">Visions, Voices, Data</a></div>
</li>
</ul>
<!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Search" type="text"></div>
<!-- 
<button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-search"></span>
</button>
-->
<input name="sitesearch" type="hidden" value="https://necromuralist.github.io/"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href=".">PuDB Remote</a></h1>
<div class="metadata">
<p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author"><a class="u-url" href="../../authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2021-11-17T18:29:13-08:00" itemprop="datePublished" title="2021-11-17 18:29">2021-11-17 18:29</time></a></p>
<p class="sourceline"><a class="sourcelink" href="index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org724cd7d">In the Beginning</a></li>
<li><a href="#orgcda43b5">Short Version</a></li>
<li><a href="#org1c0e96f">Okay, So Now Why Would You Do This?</a></li>
<li><a href="#orgd21e824">Dead Ends</a>
<ul>
<li><a href="#orgdf8a889">Another Screen</a></li>
<li><a href="#org3ad59ea"><code>term_size</code></a></li>
</ul>
</li>
<li><a href="#orgc3b9c53">Telnet</a></li>
<li><a href="#org9ac8f3e">But It's Not Fixed?</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org724cd7d">
<h2 id="org724cd7d">In the Beginning</h2>
<div class="outline-text-2" id="text-org724cd7d">
<p>This is a post on using <a href="https://documen.tician.de/pudb/index.html">PuDB</a> via telnet.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgcda43b5">
<h2 id="orgcda43b5">Short Version</h2>
<div class="outline-text-2" id="text-orgcda43b5">
<p>In case I forgot what to do and just want to read this to remember.</p>
<ol class="org-ol">
<li>In the screen where you are going to run telnet, run <code>tput cols</code> and <code>tput lines</code> to find out the number of columns and lines that the screen is using.</li>
<li>In the code where you want the break, instead of the usual <code>import pudb; pudb.set_trace()</code> use:</li>
</ol>
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">pudb.remote</span> <span class="kn">import</span> <span class="n">set_trace</span>
<span class="n">set_trace</span><span class="p">(</span><span class="n">term_size</span><span class="o">=</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">lines</span><span class="p">))</span>
</pre></div>
<p>When the code hits the breakpoint it will start up a telnet service and you can log into it from the other screen:</p>
<div class="highlight">
<pre><span></span>telnet 127.0.0.1 6899
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org1c0e96f">
<h2 id="org1c0e96f">Okay, So Now Why Would You Do This?</h2>
<div class="outline-text-2" id="text-org1c0e96f">
<p>I was trying to build one of my sites that uses <a href="https://nikola.readthedocs.io/en/latest/">nikola</a> and this strange error came out saying that one of the shortcodes was getting the "site" argument multiple times. I had no idea what was going on and nikola doesn't pre-define the arguments to the shortcode-plugins (it parses the text and then passes the arguments along using the <code>*args</code> <code>**kwargs</code> convention) which makes it flexible, but figuring out a problem with the arguments is pretty tough, so I decided to turn to my old standby <code>PuDB</code>, which I've been using for so many years now, and is my favorite of the python debuggers I've tried.</p>
<p>I did my usual thing and found the line in the <code>nikola</code> code that was raising the error and inserted a breakpoint further up in the code.</p>
<div class="highlight">
<pre><span></span><span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">"lancelot"</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pudb</span>
    <span class="n">pudb</span><span class="o">.</span><span class="n">set_trace</span><span class="p">()</span>
</pre></div>
<p>I figured the problem was with my shortcode, named <code>lancelot</code>, and the conditional allowed me to skip all the other shortcodes being used. But then, when I ran the build (<code>nikola build -v2</code>)… disaster.</p>
<p><img alt="nil" src="pudb-broken.png"></p>
<p>For some reason it wouldn't use the entire screen, making it impossible (or at least really hard) to read some of the variables that I wanted to check - and even worse, when I tried to open up the ipython terminal in it I got an error message.</p>
<p><img alt="nil" src="pudb-ui-exception.png"></p>
<p>The error-message is one of those error-after-the-error messages that you sometimes run into. It was trying to notify me of an error by popping up some kind of dialog but then the dialog wouldn't open so it told me about the dialog error and didn't get around to telling me what the original error was. In any case, something was broken, so I had to resort to desperate measures - I went to read the documentation.</p>
<p>Surprisingly, <a href="https://documen.tician.de/pudb/index.html">there actually is some</a> (there wasn't really much when I first started using it).</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgd21e824">
<h2 id="orgd21e824">Dead Ends</h2>
<div class="outline-text-2" id="text-orgd21e824">
<p>The first couple of things I tried seemed promising, but they didn't work.</p>
</div>
<div class="outline-3" id="outline-container-orgdf8a889">
<h3 id="orgdf8a889">Another Screen</h3>
<div class="outline-text-3" id="text-orgdf8a889">
<p>There wasn't anything about re-sizing the window, but it did mention that you can have the output come out in a different terminal from the one where you run the code, so I gave it a go. I made a different screen and got its file-path using the <code>tty</code> command (<code>/dev/pts/6</code> in this case). Then I set an environment variable to hold the file-path in the screen where I was running the code (<code>set -x PUDB_TTY /dev/pts/6</code>). This caused <code>PuDB</code> to pipe the output to the next screen - and it <i>did</i> work to send the first PuDB output to the other screen, and it <i>did</i> use the whole window, but then it quit instead of letting me use the debugger. Not <i>quite</i> what I wanted, so I unset the environment variable and moved on.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org3ad59ea">
<h3 id="org3ad59ea"><code>term_size</code></h3>
<div class="outline-text-3" id="text-org3ad59ea">
<p>The documentation also showed how to use <code>PuDB</code> as a remote debugger, and in the example they passed in the argument <code>term_size</code> to <code>set_trace</code> so I thought, since the functions have the same name, that the <code>set_trace</code> I was using would take the same arguments. So I tried it.</p>
<div class="highlight">
<pre><span></span><span class="kn">import</span> <span class="nn">pudb</span>
<span class="n">pudb</span><span class="o">.</span><span class="n">set_trace</span><span class="p">(</span><span class="n">term_size</span><span class="o">=</span><span class="p">(</span><span class="mi">236</span><span class="p">,</span> <span class="mi">61</span><span class="p">))</span>
</pre></div>
<p>Using the values that I had gotten from <a href="https://linux.die.net/man/1/tput">tput</a> using <code>tput cols</code> and <code>tput lines</code>. But that just raised an <code>ArgumentError</code>. The functions have the same name, but not the same arguments.</p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgc3b9c53">
<h2 id="orgc3b9c53">Telnet</h2>
<div class="outline-text-2" id="text-orgc3b9c53">
<p>So then I decided to try their remote version. It doesn't really make sense to me that it would work better than the regular version, but I didn't see any other choice. So instead of the usual code to insert a breakpoint I used:</p>
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">pudb.remote</span> <span class="kn">import</span> <span class="n">set_trace</span>
<span class="n">set_trace</span><span class="p">(</span><span class="n">term_size</span><span class="o">=</span><span class="p">(</span><span class="mi">236</span><span class="p">,</span> <span class="mi">61</span><span class="p">))</span>
</pre></div>
<p>When I ran the build it stopped and told me to telnet into the localhost address at port 6899.</p>
<p><img alt="nil" src="please-telnet.png"></p>
<p>So I changed into the other screen and ran telnet.</p>
<div class="highlight">
<pre><span></span>telnet 127.0.0.1 6899
</pre></div>
<p>And what do you know.</p>
<p><img alt="nil" src="pudb-fixed.png"></p>
<p>This turns out to not be a complete fix. Hitting <code>!</code> to get to the <code>ipython</code> terminal froze <code>PuDB</code>, but this was enough for me to inspect the variables and realize that I just needed to move one of the parameters in the definition of my shortcode method and it worked.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org9ac8f3e">
<h2 id="org9ac8f3e">But It's Not Fixed?</h2>
<div class="outline-text-2" id="text-org9ac8f3e">
<p>Well, if this were a more intense debug I really would want the <code>ipython~/~ptipython</code> terminal, but since this is the first time I've tried to run <code>PuDB</code> under <code>KUbuntu's</code> <code>Konsole</code> instead of the <code>GNOME</code> terminal I'm hoping that just switching back to the other terminal will be enough - I'll have to test that once I'm more motivated.</p>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="../../categories/debugging/" rel="tag">debugging</a></li>
<li><a class="tag p-category" href="../../categories/pudb/" rel="tag">pudb</a></li>
<li><a class="tag p-category" href="../../categories/python/" rel="tag">python</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="../emacs-artifact-on-kubuntu/" rel="prev" title="Emacs Scrollbar Artifact on Kubuntu">Previous post</a></li>
<li class="next"><a href="../mozilla-madness-resist-fingerprinting/" rel="next" title="Mozilla Madness: Resist Fingerprinting!">Next post</a></li>
</ul>
</nav>
</aside>
</article>
<!--End of body content-->
<footer id="footer">Contents © 2023 <a href="mailto:cloisteredmonkey.jmark@slmail.me">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="../../assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script>
</body>
</html>
