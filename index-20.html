<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="A common place." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>The Cloistered Monkey (old posts, page 20) | The Cloistered Monkey</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/index-20.html" rel="canonical">
<link href="index-21.html" rel="prev" type="text/html">
<link href="index-19.html" rel="next" type="text/html"><!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
<link href="apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="site.webmanifest" rel="manifest">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="."><span id="blog-title">The Cloistered Monkey</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="pages/">Pages</a></li>
<li class="nav-item"><a class="nav-link" href="archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Projects</a>
<div class="dropdown-menu"><a class="dropdown-item" href="https://necromuralist.github.io/Ape-Iron/">Ape Iron</a> <a class="dropdown-item" href="https://necromuralist.github.io/Beach-Pig-Thigh/">Beach Pig Rump & Thigh</a> <a class="dropdown-item" href="https://necromuralist.github.io/Bowling-For-Data/">Bowling For Data</a> <a class="dropdown-item" href="https://necromuralist.github.io/Give-The-Fish/">Give the Fish</a> <a class="dropdown-item" href="https://necromuralist.github.io/Neurotic-Networking/">Neurotic Networking</a> <a class="dropdown-item" href="https://necromuralist.github.io/Terribilis-Ludum/">Terribilis Ludum</a> <a class="dropdown-item" href="https://necromuralist.github.io/Visions-Voices-Data/">Visions, Voices, Data</a></div>
</li>
</ul>
<!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Search" type="text"></div>
<!-- 
<button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-search"></span>
</button>
-->
<input name="sitesearch" type="hidden" value="https://necromuralist.github.io/"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<div class="postindex">
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/codewars-calculating-with-functions/">CodeWars: Calculating With Functions</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/codewars-calculating-with-functions/" rel="bookmark"><time class="published dt-published" datetime="2022-02-10T17:52:52-08:00" itemprop="datePublished" title="2022-02-10 17:52">2022-02-10 17:52</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="posts/codewars-calculating-with-functions/#orge5ca94c">The Problem</a></li>
<li><a href="posts/codewars-calculating-with-functions/#org15121c4">The Solution</a>
<ul>
<li><a href="posts/codewars-calculating-with-functions/#org9c7089a">The Tests</a></li>
</ul>
</li>
<li><a href="posts/codewars-calculating-with-functions/#orgf4c8164">Alternatives</a></li>
<li><a href="posts/codewars-calculating-with-functions/#org9f12b12">A Hybrid</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orge5ca94c">
<h2 id="orge5ca94c">The Problem</h2>
<div class="outline-text-2" id="text-orge5ca94c">
<p>Write functions that calculate integer arithmetic. For example.</p>
<div class="highlight">
<pre><span></span><span class="n">seven</span><span class="p">(</span><span class="n">times</span><span class="p">(</span><span class="n">five</span><span class="p">()))</span>
</pre></div>
<p>Should return thirty-five. Every number has a function and there are four operation-functions:</p>
<ul class="org-ul">
<li><code>plus</code></li>
<li><code>minus</code></li>
<li><code>times</code></li>
<li><code>divided_by</code></li>
</ul>
<p>All operations should return integers, not floats.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org15121c4">
<h2 id="org15121c4">The Solution</h2>
<div class="outline-text-2" id="text-org15121c4">
<div class="highlight">
<pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="k">def</span> <span class="nf">digit</span><span class="p">(</span><span class="n">operation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""A base function to define a digit</span>

<span class="sd">    Args:</span>
<span class="sd">     operation: a function that expects an integer argument when called</span>
<span class="sd">     integer: an integer to return if no operation is passed in</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">operation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">operation</span><span class="p">(</span><span class="n">integer</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">integer</span>

<span class="c1"># the digits</span>
<span class="n">zero</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">one</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">two</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">three</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">four</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">five</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">six</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">seven</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">eight</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">nine</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="c1"># the operations</span>
<span class="k">def</span> <span class="nf">plus</span><span class="p">(</span><span class="n">right</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">left</span><span class="p">:</span> <span class="n">left</span> <span class="o">+</span> <span class="n">right</span>

<span class="k">def</span> <span class="nf">minus</span><span class="p">(</span><span class="n">right</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">left</span><span class="p">:</span> <span class="n">left</span> <span class="o">-</span> <span class="n">right</span>

<span class="k">def</span> <span class="nf">times</span><span class="p">(</span><span class="n">right</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">left</span><span class="p">:</span> <span class="n">left</span> <span class="o">*</span> <span class="n">right</span>

<span class="k">def</span> <span class="nf">divided_by</span><span class="p">(</span><span class="n">right</span><span class="p">):</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">left</span><span class="p">:</span> <span class="n">left</span> <span class="o">//</span> <span class="n">right</span>
</pre></div>
</div>
<div class="outline-3" id="outline-container-org9c7089a">
<h3 id="org9c7089a">The Tests</h3>
<div class="outline-text-3" id="text-org9c7089a">
<div class="highlight">
<pre><span></span><span class="n">expect</span><span class="p">(</span><span class="n">seven</span><span class="p">(</span><span class="n">times</span><span class="p">(</span><span class="n">five</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">four</span><span class="p">(</span><span class="n">plus</span><span class="p">(</span><span class="n">nine</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">eight</span><span class="p">(</span><span class="n">minus</span><span class="p">(</span><span class="n">three</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">six</span><span class="p">(</span><span class="n">divided_by</span><span class="p">(</span><span class="n">two</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgf4c8164">
<h2 id="orgf4c8164">Alternatives</h2>
<div class="outline-text-2" id="text-orgf4c8164">
<p>There are several variations on the theme. One that I thought was similar in spirit to what I did but better was <a href="https://www.codewars.com/kata/reviews/5b0ce29de86c548f16000e76/groups/5c92714817647a0001bac149">this one</a>. Instead of separate operation and integer they use a default function that only returns what gets passed to it. So the definitions look like this.</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">identity</span><span class="p">(</span><span class="n">integer</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">integer</span>

<span class="k">def</span> <span class="nf">zero</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">one</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">two</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">three</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">four</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">five</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">six</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">seven</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">eight</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">nine</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">identity</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">seven</span><span class="p">(</span><span class="n">times</span><span class="p">(</span><span class="n">five</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">four</span><span class="p">(</span><span class="n">plus</span><span class="p">(</span><span class="n">nine</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">eight</span><span class="p">(</span><span class="n">minus</span><span class="p">(</span><span class="n">three</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">six</span><span class="p">(</span><span class="n">divided_by</span><span class="p">(</span><span class="n">two</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org9f12b12">
<h2 id="org9f12b12">A Hybrid</h2>
<div class="outline-text-2" id="text-org9f12b12">
<p>To add a little of what the other solution is doing…</p>
<div class="highlight">
<pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="k">def</span> <span class="nf">identity</span><span class="p">(</span><span class="n">integer</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""A pass-through function</span>

<span class="sd">    Args:</span>
<span class="sd">     integer: a digit input</span>

<span class="sd">    Returns:</span>
<span class="sd">     the integer given</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">integer</span>

<span class="k">def</span> <span class="nf">digit</span><span class="p">(</span><span class="n">operation</span><span class="o">=</span><span class="n">identity</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""A base function to define a digit</span>

<span class="sd">    Args:</span>
<span class="sd">     operation: a function that expects an integer argument when called</span>
<span class="sd">     integer: an integer to return if no operation is passed in</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">operation</span><span class="p">(</span><span class="n">integer</span><span class="p">)</span>

<span class="c1"># the digits</span>
<span class="n">zero</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">one</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">two</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">three</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">four</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">five</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">six</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">seven</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">eight</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">nine</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="c1"># the operations</span>
<span class="c1"># this is a style some people used. I'm not sure I like it.</span>
<span class="n">plus</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">right</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">left</span><span class="p">:</span> <span class="n">left</span> <span class="o">+</span> <span class="n">right</span>
<span class="n">minus</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">right</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">left</span><span class="p">:</span> <span class="n">left</span> <span class="o">-</span> <span class="n">right</span>

<span class="c1"># alternatively you could just do this</span>
<span class="k">def</span> <span class="nf">times</span><span class="p">(</span><span class="n">right</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span> <span class="k">return</span> <span class="k">lambda</span> <span class="n">left</span><span class="p">:</span> <span class="n">left</span> <span class="o">*</span> <span class="n">right</span>
<span class="k">def</span> <span class="nf">divided_by</span><span class="p">(</span><span class="n">right</span><span class="p">):</span> <span class="k">return</span> <span class="k">lambda</span> <span class="n">left</span><span class="p">:</span> <span class="n">left</span> <span class="o">//</span> <span class="n">right</span>

<span class="n">expect</span><span class="p">(</span><span class="n">seven</span><span class="p">(</span><span class="n">times</span><span class="p">(</span><span class="n">five</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">four</span><span class="p">(</span><span class="n">plus</span><span class="p">(</span><span class="n">nine</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">eight</span><span class="p">(</span><span class="n">minus</span><span class="p">(</span><span class="n">three</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">six</span><span class="p">(</span><span class="n">divided_by</span><span class="p">(</span><span class="n">two</span><span class="p">())))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/coding-train-starfield/">Coding Train Starfield</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/coding-train-starfield/" rel="bookmark"><time class="published dt-published" datetime="2022-02-10T15:19:02-08:00" itemprop="datePublished" title="2022-02-10 15:19">2022-02-10 15:19</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="posts/coding-train-starfield/#org46211f6">The Starfield</a></li>
<li><a href="posts/coding-train-starfield/#org2e5ce7d">The Main Sketch</a>
<ul>
<li><a href="posts/coding-train-starfield/#org7a09101">The Setup Function</a></li>
<li><a href="posts/coding-train-starfield/#org8744ea5">Draw</a></li>
</ul>
</li>
<li><a href="posts/coding-train-starfield/#orgb8e515a">The Star Class</a>
<ul>
<li><a href="posts/coding-train-starfield/#org4a394f5">The Update</a></li>
<li><a href="posts/coding-train-starfield/#org1b13171">The Show Function</a></li>
</ul>
</li>
<li><a href="posts/coding-train-starfield/#orgec606ae">Attaching the Sketch</a></li>
<li><a href="posts/coding-train-starfield/#orge1b836d">Source</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org46211f6">
<h2 id="org46211f6">The Starfield</h2>
<div class="outline-text-2" id="text-org46211f6">
<p>This is another <a href="https://p5js.org/">p5.js</a> hello-world, this time taken from Daniel Schiffman's <a href="https://thecodingtrain.com/CodingChallenges/001-starfield.html">Starfield in Processing</a> coding challenge. It's a rough version of traveling through the stars at warp speed. He managed to do it in about 15 minutes, if I remember correctly. It starts static but if you move your mouse back and forth horizontally it adjusts the speed.</p>
<script language="javascript" src="posts/coding-train-starfield/starfield.js" type="text/javascript"></script>
<div id="schiffman-starfield"></div>
</div>
</div>
<div class="outline-2" id="outline-container-org2e5ce7d">
<h2 id="org2e5ce7d">The Main Sketch</h2>
<div class="outline-text-2" id="text-org2e5ce7d">
<p>The most basic processing/p5 sketch uses two functions <code>setup</code> to initially set up your canvas and <code>draw</code> to update the frames over time. This function creates our canvas and star objects in the <code>setup</code> and then calculates a <code>speed</code> based on the mouse position of the user in order to update the stars. It gets passed a p5 element, called p, in order to get access to the p5.js code.</p>
<div class="highlight">
<pre><span></span><span class="cm">/** The main sketch</span>
<span class="cm"> * this gets passed to p5 so it defines the setup and draw functions</span>
<span class="cm"> * that p5 expects</span>
<span class="cm">*/</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">starfield_sketch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">star_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">800</span><span class="p">;</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">parent_div_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"schiffman-starfield"</span><span class="p">;</span>
<span class="w">  </span><span class="nx">p</span><span class="p">.</span><span class="nx">BLACK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="nx">p</span><span class="p">.</span><span class="nx">WHITE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">255</span><span class="p">;</span>
<span class="w">  </span><span class="nx">p</span><span class="p">.</span><span class="nx">ALPHA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100</span><span class="p">;</span>
</pre></div>
</div>
<div class="outline-3" id="outline-container-org7a09101">
<h3 id="org7a09101">The Setup Function</h3>
<div class="outline-text-3" id="text-org7a09101">
<p>Not too much voodoo here, other than the use of the <a href="https://api.jquery.com/outerWidth/">JQuery outerWidth</a> method which gets the width of the DIV that we're using to hold the sketch and uses it as the width for the canvas.</p>
<div class="highlight">
<pre><span></span><span class="nx">p</span><span class="p">.</span><span class="nx">setup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">p</span><span class="p">.</span><span class="nx">stars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">canvas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">createCanvas</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">"#"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">parent_div_id</span><span class="p">).</span><span class="nx">outerWidth</span><span class="p">(</span><span class="kc">true</span><span class="p">),</span><span class="w"> </span><span class="mf">800</span><span class="p">);</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">star_count</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">stars</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Star</span><span class="p">(</span><span class="nx">p</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="c1">// end setup</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org8744ea5">
<h3 id="org8744ea5">Draw</h3>
<div class="outline-text-3" id="text-org8744ea5">
<p>Again, not too fancy. The draw function:</p>
<ul class="org-ul">
<li>Sets the background to black to wipe out our previous drawing</li>
<li>gets the "speed" of the stars using the x-position of the mouse and mapping this location from 0 to the width of the canvas to a smaller range from 0 to 50</li>
<li>Translate the (0, 0) of the coordinate system from the top left of the canvas to the middle so our stars emerge from the center instead of the top left</li>
<li>update all the stars with the speed and re-draw them</li>
</ul>
<div class="highlight">
<pre><span></span><span class="w">  </span><span class="nx">p</span><span class="p">.</span><span class="nx">draw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">background</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">BLACK</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">ALPHA</span><span class="p">);</span>
<span class="w">    </span><span class="nx">speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">mouseX</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">50</span><span class="p">);</span>
<span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">translate</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="o">/</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">height</span><span class="o">/</span><span class="mf">2</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">stars</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">){</span>
<span class="w">      </span><span class="nx">p</span><span class="p">.</span><span class="nx">stars</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">update</span><span class="p">(</span><span class="nx">speed</span><span class="p">);</span>
<span class="w">      </span><span class="nx">p</span><span class="p">.</span><span class="nx">stars</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">show</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="c1">//end draw</span>
<span class="p">};</span><span class="w"> </span><span class="c1">//end starfield_sketch</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgb8e515a">
<h2 id="orgb8e515a">The Star Class</h2>
<div class="outline-text-2" id="text-orgb8e515a">
<p>The <code>Star</code> stores the position of a "star" and updates it based on the speed that it's given. Our initial constructor sets up the coordinates of the star using random values.</p>
<div class="highlight">
<pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">Star</span><span class="p">(</span><span class="nx">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="o">-</span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="p">);</span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="o">-</span><span class="nx">p</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="p">);</span>
</pre></div>
</div>
<div class="outline-3" id="outline-container-org4a394f5">
<h3 id="org4a394f5">The Update</h3>
<div class="outline-text-3" id="text-org4a394f5">
<p>Most of the time the update reduces the <code>z</code> value by the current speed, but since we don't want the stars to go off the canvas and disappear, if it gets too small we re-randomize the position of the star.</p>
<div class="highlight">
<pre><span></span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">speed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">speed</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="o">-</span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="o">-</span><span class="nx">p</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="c1">//end update</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org1b13171">
<h3 id="org1b13171">The Show Function</h3>
<div class="outline-text-3" id="text-org1b13171">
<p>The <code>show</code> function is where most of the work is done. It calculates the proprotions of x and y to z and then maps that to the width and height of the canvas and then draws an ellipse. To get the radius of the ellipse we map the current z-value using an inverted target of 16, 0. This means that as z gets smaller our radius gets bigger.</p>
<div class="highlight">
<pre><span></span><span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">show</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">WHITE</span><span class="p">);</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">x_now</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="o">/</span><span class="k">this</span><span class="p">.</span><span class="nx">z</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="p">);</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">y_now</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="o">/</span><span class="k">this</span><span class="p">.</span><span class="nx">z</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>

<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">radius</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">z</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span><span class="w"> </span><span class="mf">16</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
<span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">ellipse</span><span class="p">(</span><span class="nx">x_now</span><span class="p">,</span><span class="w"> </span><span class="nx">y_now</span><span class="p">,</span><span class="w"> </span><span class="nx">radius</span><span class="p">,</span><span class="w"> </span><span class="nx">radius</span><span class="p">);</span>

<span class="w">    </span><span class="nx">p</span><span class="p">.</span><span class="nx">stroke</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">WHITE</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="c1">// end show</span>
<span class="p">};</span><span class="w"> </span><span class="c1">//end class Star</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgec606ae">
<h2 id="orgec606ae">Attaching the Sketch</h2>
<div class="outline-text-2" id="text-orgec606ae">
<p>This next bit attaches our sketch to a specific DIV defined in the HTML. You don't have to do this, you could just use the parts as universal functions like the examples show, but if you have more than one sketch on a page sometimes things get funky so I prefer this pattern to keep everything in place.</p>
<div class="highlight">
<pre><span></span><span class="c1">// Attach the starfield_sketch function at the top to the div with ID</span>
<span class="c1">// schiffman-starfield</span>
<span class="nx">sketch_container</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">p5</span><span class="p">(</span><span class="nx">starfield_sketch</span><span class="p">,</span><span class="w"> </span><span class="s1">'schiffman-starfield'</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orge1b836d">
<h2 id="orge1b836d">Source</h2>
<div class="outline-text-2" id="text-orge1b836d">
<ul class="org-ul">
<li>Starfield in Processing [Internet]. The Coding Train. 2016 [cited 2022 Feb 10]. Available from: <a href="https://thecodingtrain.com/CodingChallenges/001-starfield.html">https://thecodingtrain.com/CodingChallenges/001-starfield.html</a></li>
</ul>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/codewars-vowel-count/">CodeWars: Vowel Count</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/codewars-vowel-count/" rel="bookmark"><time class="published dt-published" datetime="2022-02-09T13:42:40-08:00" itemprop="datePublished" title="2022-02-09 13:42">2022-02-09 13:42</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="posts/codewars-vowel-count/#org2374e15">The Problem</a></li>
<li><a href="posts/codewars-vowel-count/#orgd262022">The Solution</a>
<ul>
<li><a href="posts/codewars-vowel-count/#org26f5c11">The Tests</a></li>
<li><a href="posts/codewars-vowel-count/#org76003fe">The Function</a></li>
</ul>
</li>
<li><a href="posts/codewars-vowel-count/#org03c7bef">Alternatives</a></li>
<li><a href="posts/codewars-vowel-count/#org2838af5">End</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org2374e15">
<h2 id="org2374e15">The Problem</h2>
<div class="outline-text-2" id="text-org2374e15">
<p>Given a string, count the number of vowels in it. The vowels are "aeiou" and the letters will be lower-cased.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgd262022">
<h2 id="orgd262022">The Solution</h2>
<div class="outline-text-2" id="text-orgd262022"></div>
<div class="outline-3" id="outline-container-org26f5c11">
<h3 id="org26f5c11">The Tests</h3>
<div class="outline-text-3" id="text-org26f5c11">
<div class="highlight">
<pre><span></span><span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="n">equal</span><span class="p">,</span> <span class="n">expect</span>

<span class="n">expect</span><span class="p">(</span><span class="n">vowel_count</span><span class="p">(</span><span class="s2">"a"</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">vowel_count</span><span class="p">(</span><span class="s2">"rmnl"</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">vowel_count</span><span class="p">(</span><span class="s2">"a mouse is not a house"</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org76003fe">
<h3 id="org76003fe">The Function</h3>
<div class="outline-text-3" id="text-org76003fe">
<div class="highlight">
<pre><span></span><span class="n">VOWELS</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="s2">"aeiou"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">vowel_count</span><span class="p">(</span><span class="n">letters</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Counts the number of vowels in the input</span>

<span class="sd">    Args:</span>
<span class="sd">     letters: lower-cased string to check for vowels</span>

<span class="sd">    Returns:</span>
<span class="sd">     count of vowels in the letters</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">letters</span> <span class="k">if</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">VOWELS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org03c7bef">
<h2 id="org03c7bef">Alternatives</h2>
<div class="outline-text-2" id="text-org03c7bef">
<p><a href="https://www.codewars.com/kata/reviews/54ff37ee355cfd937000105c/groups/54ff8310c50295aa890004d3">One solution</a> used regular expressions and the <code>findall</code> method. This seems better in a generalizable sense, but I think that the <code>findall</code> will build a list rather than a generator so might not be as efficient space-wise, and is probably slower. Others used the python string method - <code>count</code>. I think this problem is so easy that there's really not a lot of stuff you can do that doesn't overcomplicate things.</p>
<p>Anyway, day one.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org2838af5">
<h2 id="org2838af5">End</h2>
<div class="outline-text-2" id="text-org2838af5">
<ul class="org-ul">
<li><a href="https://www.codewars.com/kata/54ff3102c1bad923760001f3">CodeWars Vowel Count</a>: One of the beginner's kata.</li>
</ul>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/mozilla-madness-resist-fingerprinting/">Mozilla Madness: Resist Fingerprinting!</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/mozilla-madness-resist-fingerprinting/" rel="bookmark"><time class="published dt-published" datetime="2021-12-23T13:54:12-08:00" itemprop="datePublished" title="2021-12-23 13:54">2021-12-23 13:54</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="posts/mozilla-madness-resist-fingerprinting/#org733ff63">The Short Version For My Future Self</a></li>
<li><a href="posts/mozilla-madness-resist-fingerprinting/#org7212e3b">Back To the Story: It Was a Dark and Rainy Day</a></li>
<li><a href="posts/mozilla-madness-resist-fingerprinting/#org3d48a41">Start With the Nuclear Option</a></li>
<li><a href="posts/mozilla-madness-resist-fingerprinting/#orgbf9f27f">The Slow Crawl Back</a></li>
<li><a href="posts/mozilla-madness-resist-fingerprinting/#orgb9119f9">Is It a Bug?</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org733ff63">
<h2 id="org733ff63">The Short Version For My Future Self</h2>
<div class="outline-text-2" id="text-org733ff63">
<p>Although some sites tell you to set Firefox's <code>privacy.resistFingerprinting</code> option to true, it breaks altair's interaction and some other sites that use the canvas. It's probably better not to use that option, but if you do either:</p>
<ul class="org-ul">
<li>Install the <a href="https://addons.mozilla.org/en-US/firefox/addon/toggle-resist-fingerprinting/">Toggle Resist Fingerprinting</a> extension and turn it off when things break (or just keep turning it off in <code>about:config</code>).</li>
<li>Or set <code>privacy.resistFingerprinting.autoDeclineNoUserInputCanvasPrompts</code> to False and accept the popup requests for the page you want to use.</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org7212e3b">
<h2 id="org7212e3b">Back To the Story: It Was a Dark and Rainy Day</h2>
<div class="outline-text-2" id="text-org7212e3b">
<p>I decided to give <a href="https://altair-viz.github.io/">altair</a>, the python data visualization library a try yesterday, just to see what it looked like. I ran their "hello, world" example and managed to get a plot.</p>
<object data="posts/mozilla-madness-resist-fingerprinting/test-bar-plot.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>Nothing fancy. If you move your cursor over the bars you might get a tool-tip giving you the width of the bar. If you do then you don't have the problem I ran into yesterday when I was trying it out. The image itself came out clear enough, but I couldn't figure out how to make the tool-tips work. I got desperate enough to try and read the documentation but it seems to be split between examples and API descriptions with little more in the way of explanatory documentation that would help to figure out how it was supposed to work. There are a lot of examples, though, so I decided to see if they would help, but then when I was looking at their <a href="https://altair-viz.github.io/gallery/scatter_tooltips.html">Scatter Plot with Tool-tips</a> example I noticed that their plots didn't have tool-tips either, which seemed suspicious. Was their library that broken? Was the internet?</p>
<p>I took a look at the JavaScript console and that's when I saw these messages.</p>
<p><img alt="nil" src="posts/mozilla-madness-resist-fingerprinting/blocked-canvas-data.png"></p>
<p>It looked like it might be important, but when I went searching for the message I couldn't find anything relevant. At least not at first.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org3d48a41">
<h2 id="org3d48a41">Start With the Nuclear Option</h2>
<div class="outline-text-2" id="text-org3d48a41">
<p>My first thought was that they had somehow made altair Chromium-only so I installed <a href="https://brave.com/">brave</a> and, sure enough, the tool-tips worked when I switched browsers. So my initial conclusion was that I'd have to switch browsers if I decided to use altair. But then it occurred to me that I'd had problems in the past with some sites and anti-tracking options turned on in firefox so maybe it had something to do with that or one of the extensions. The question was, what setting was it or what extension? I eventually decided it was too much work to figure out so I first tried to use <a href="https://support.mozilla.org/en-US/kb/diagnose-firefox-issues-using-troubleshoot-mode">Troubleshoot Mode</a> to disable all the extensions, and when that didn't work, I did a <a href="https://support.mozilla.org/en-US/kb/refresh-firefox-reset-add-ons-and-settings">refresh</a> and wiped out all the customizations I'd done to firefox. Amazingly, this worked, but now I had to go about setting Firefox up again while avoiding whatever I did that broke altair.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgbf9f27f">
<h2 id="orgbf9f27f">The Slow Crawl Back</h2>
<div class="outline-text-2" id="text-orgbf9f27f">
<p>I decided to follow the advice on the <a href="https://restoreprivacy.com/firefox-privacy/">restoreprivacy.com</a> page, just because it came up on the first page of my search results and it seemed to touch most of the bases that I'd run before this episode. As I did a step in the setup I would check back with the altair plot to make sure that the tool-tip was still working until, eventually, I came to the setting that broke it - <code>privacy.resistFingerprinting</code>.</p>
<p><img alt="nil" src="posts/mozilla-madness-resist-fingerprinting/resist-fingerprinting.png"></p>
<p>When I set it to true the tool-tips would break and when I set it to false they would work again. So, then what? I didn't want to disable fingerprint protection, so I thought I'd do a little more searching and see if there was another way.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgb9119f9">
<h2 id="orgb9119f9">Is It a Bug?</h2>
<div class="outline-text-2" id="text-orgb9119f9">
<p>I decided to do a search on <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox">Bugzilla</a> and found what seemed like a relevant bug: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1631673">WhatsApp Web images broken if you flip `privacy.resistFingerprinting` due to canvas prompts without user interaction</a>. The discussion is about What's App and also mentions Instagram and Twitter, and although they are focused on images, the actual error seemed close enough to what I was seeing that it seemed like it might be the same or a similar thing. But the bug was opened two years ago, so if it is a bug it doesn't seem to be something they're eager to fix. Then I ran across this bug: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1376865">Do not display Canvas Prompt unless triggered by user input</a> which discusses changing the default behavior to not prompt the user for permission to use the canvas. Now that I'm describing it I'm not sure how I came to this next step based on that bug, but for some reason I went looking in <code>about:config</code> again and noticed that right under <code>resistFingerprinting</code> was <code>resistFingerprinting.autoDeclineNoUserInputCanvasPrompts</code>:</p>
<p><img alt="nil" src="posts/mozilla-madness-resist-fingerprinting/auto-decline.png"></p>
<p>This option is set to True by default and seemed to be what they were talking about in the bug so I turned it off and went back to the altair page and this time when I put my cursor over the plot a popup came up asking me for permission.</p>
<p><img alt="nil" src="posts/mozilla-madness-resist-fingerprinting/allow-dialog.png"></p>
<p>Once allowed it, it worked, even with <code>resistFingerprinting</code> set to true. So, if I understand what the bug reports were saying, what was causing the problem is that firefox is getting a request for the canvas but it decides that it isn't the user initiating it, so it needs extra permission but by default the box to ask for permission is turned off and the request is declined without the user (me) getting any feedback. This <i>seemed</i> like a bug.</p>
<p>As I was thinking about this I remembered that a couple of days ago I went to the kindle cloud reader and one of the books wouldn't render. I went back and played with turning <code>resistFingerprinting</code> on and off before trying to load the ebook and this <i>was</i> apparently the culprit so it isn't just altair that's affected for me.</p>
<p>So it's a bug, right? It seemed like one, but there were already reports of this phenomena for other sites going back years so they appear to have done it on purpose. I was trying to figure out whether it was something that should be reported or not when I came upon this bug: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1666160">Users enable `privacy.resistFingerprinting` and then are surprised when it causes problems</a>.</p>
<p><img alt="nil" src="posts/mozilla-madness-resist-fingerprinting/surprise-bug.png"></p>
<p>Despite the fact that I've seen multiple sites saying to enable this "feature" maybe it isn't really a good idea after all. In the near-term I installed the <a href="https://addons.mozilla.org/en-US/firefox/addon/toggle-resist-fingerprinting/">Toggle Resist Fingerprinting</a> extension and use it to turn <code>resistFingerprinting</code> on and off. To be honest, I'm not convinced that it really matters, I just got sucked into a trail of sites making conflicting assertions about what to do and convinced myself that I cared. At least I can read kindle books in the browser again.</p>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/cuda-conda-dockerugh/">Cuda, Conda, Docker...ugh</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/cuda-conda-dockerugh/" rel="bookmark"><time class="published dt-published" datetime="2021-12-06T18:04:16-08:00" itemprop="datePublished" title="2021-12-06 18:04">2021-12-06 18:04</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div class="outline-2" id="outline-container-org9d35f4c">
<h2 id="org9d35f4c">The Beginning</h2>
<div class="outline-text-2" id="text-org9d35f4c">
<p>I haven't been doing anything with pytorch recently so I decided to restart by setting up a docker container on my machine with a beefier nvidia card than the machine I had been using. I've learned a little bit more about docker since I built my earlier container so I decided to update the image and found it both easier and harder than I remember it being. It went easier because I knew more or less what I had to do so I knew what to look up. Harder because there's some workarounds that you have to work with that weren't there before, and I decided to stick with <code>conda</code>, which seems to add an extra layer of difficulty compared to pip and virtualenv when you use docker. But, anyway, enough with the whining, here's the stuff.</p>
<p><b>Note:</b> I'm doing this on Ubuntu 21.10.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org5e1af0a">
<h2 id="org5e1af0a">Nvidia-Container-Toolkit and Ubuntu</h2>
<div class="outline-text-2" id="text-org5e1af0a">
<p>The first thing you should do is install the <a href="https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/install-guide.html#docker">nvidia-container-toolkit</a>. The instructions say to add the repository this way:</p>
<div class="highlight">
<pre><span></span>distribution=$(. /etc/os-release;echo $ID$VERSION_ID) \
   &amp;& curl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | sudo apt-key add - \
   &amp;& curl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list | sudo tee /etc/apt/sources.list.d/nvidia-docker.list
</pre></div>
<p>This introduces two problems for me. The first is that this assumes you use bash, but I'm using fish so the command doesn't work. This is no big deal since I just looking in the <code>/etc/os-release</code> file to get the <code>ID</code> and <code>VERSION_ID</code> and wrote it out.</p>
<div class="highlight">
<pre><span></span>curl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | sudo apt-key add -
curl -s -L https://nvidia.github.io/nvidia-docker/ubuntu21.10/nvidia-docker.list | sudo tee /etc/apt/sources.list.d/nvidia-docker.list
</pre></div>
<p>But then this introduces the second problem - the second curl fails with the message:</p>
<div class="highlight">
<pre><span></span>Unsupported distribution!
Check https://nvidia.github.io/nvidia-docker
</pre></div>
<p>It turns out there's an <a href="https://github.com/NVIDIA/nvidia-docker/issues/1574">open bug report</a> on GitHub, with a comment that only Long-Term-Support versions are supported. The commenter suggested using 18.04 for some reason, but I went with 20.04 and it seemed to work.</p>
<div class="highlight">
<pre><span></span>curl -s -L https://nvidia.github.io/nvidia-docker/ubuntu20.04/nvidia-docker.list | sudo tee /etc/apt/sources.list.d/nvidia-docker.list

sudo apt update
sudo apt install nvidia-container-toolkit
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org6415ea6">
<h2 id="org6415ea6">The Cuda Image</h2>
<div class="outline-text-2" id="text-org6415ea6">
<p>Now that I was setup to run the container I ran a test.</p>
<div class="highlight">
<pre><span></span>docker run --rm --gpus all nvidia/cuda:11.4.2-cudnn8-devel nvidia-smi
</pre></div>
<p>Which gave me an error, something like <code>Error response from daemon</code> (I don't remember exactly), which turns out to be the result of a pretty major flaw right now (as noted on the <a href="https://github.com/NVIDIA/libnvidia-container/issues/111">github issue for it</a>). One of the commenters <a href="https://github.com/NVIDIA/libnvidia-container/issues/111#issuecomment-932742403">posted a work-around for it</a> which seems to work.</p>
</div>
<div class="outline-3" id="outline-container-org4c4afbc">
<h3 id="org4c4afbc">Edit /etc/nvidia-container-runtime/config.toml</h3>
<div class="outline-text-3" id="text-org4c4afbc">
<p>In the file there's a line:</p>
<div class="highlight">
<pre><span></span>#no-cgroups = false
</pre></div>
<p>Uncomment it and set it to true.</p>
<div class="highlight">
<pre><span></span>no-cgroups = true
</pre></div>
<p>Okay, easy-peasy. All fixed, then, right? Well, doing this fix means that you now have to pass in more flags when you run the container. First you need to check what you have.</p>
<div class="highlight">
<pre><span></span>ls /dev | grep nvidia
</pre></div>
<p>Then when you run the container you need to pass in most of those things as <code>--device</code> arguments.</p>
<div class="highlight">
<pre><span></span>docker run --rm --gpus all --device /dev/nvidia0 --device /dev/nvidiactl --device /dev/nvidia-modeset --device /dev/nvidia-uvm nvidia/cuda:11.4.2-cudnn8-devel nvidia-smi
</pre></div>
<p>You might not need to actually look in <code>/dev</code> first. I had to because the post on github was referring to a <code>/dev/nvidia1</code> device, but I don't have one. This appears to work, although it's a bit unwieldy.</p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org4ce0c40">
<h2 id="org4ce0c40">Now for Conda</h2>
<div class="outline-text-2" id="text-org4ce0c40">
<p>This next bit probably shouldn't be registered as a problem, but the last time I tried to run pytorch in docker there was some kind of bug when I installed it with <code>pip</code> that went away when I installed it with <code>conda</code> so I decided to stick with cuda, but I also wanted to try and set it up the way I do with virtualenv - cached by docker and run non-root. This turns out to be much harder to do than with virtualenv for some reason. I looked through some posts on StackOverflow and elsewhere and didn't really see any good solutions, but <a href="https://towardsdatascience.com/conda-pip-and-docker-ftw-d64fe638dc45">this one on Toward Data Science</a> got close enough. The way that post suggests is to change the shell that docker uses to <code>bash</code> and moving the <code>miniconda</code> install path into the home directory of the user that you want to run it.</p>
<p>I won't bother with all of the <code>Dockerfile</code>, but the basic changes are:</p>
<p>Change the shell.</p>
<div class="highlight">
<pre><span></span>SHELL [ "/bin/bash", "--login", "-c" ]
</pre></div>
<p>Switch to the user (assuming you added the user and home directory earlier in the docker file) and add an environment file to store the directory in (I don't think you need to use <code>ENV</code> but the post used it. I'll try <code>ARG</code> later).</p>
<div class="highlight">
<pre><span></span>USER ${USER_NAME}
WORKDIR ${USER_HOME}

ENV CONDA_DIR=${USER_HOME}/miniconda3
</pre></div>
<p>Then install miniconda.</p>
<div class="highlight">
<pre><span></span>ARG MINICONDA_URL="https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh"
ARG SHA256SUM="1ea2f885b4dbc3098662845560bc64271eb17085387a70c2ba3f29fff6f8d52f"
ARG CONDA_VERSION=py39_4.10.3
RUN --mount=type=cache,target=/root/.cache \
    wget "${MINICONDA_URL}" --output-document miniconda.sh --quiet --force-directories --directory-prefix ${CONDA_DIR} &amp;& \
    echo "${SHA256SUM} miniconda.sh" &gt; shasum &amp;& \
    sha256sum --check --status shasum &amp;& \
    /bin/bash miniconda.sh -b -p ${CONDA_DIR} &amp;& \
    rm miniconda.sh shasum

ENV PATH=$CONDA_DIR/bin:$PATH
</pre></div>
<p>Update conda.</p>
<div class="highlight">
<pre><span></span>RUN echo ". $CONDA_DIR/etc/profile.d/conda.sh" &gt;&gt; ~/.profile &amp;& \
    conda init bash &amp;& \
    conda update -n base -c defaults conda
</pre></div>
<p>Install the packages. This is where I added the caching to try and reduce the re-downloading of files. I don't really know if this helps a lot, to be truthful, but it's nice to have new things.</p>
<div class="highlight">
<pre><span></span>RUN --mount=type=cache,target=/root/.cache \
    conda install pytorch torchvision torchaudio cudatoolkit --channel pytorch --yes
</pre></div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/pudb-remote/">PuDB Remote</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/pudb-remote/" rel="bookmark"><time class="published dt-published" datetime="2021-11-17T18:29:13-08:00" itemprop="datePublished" title="2021-11-17 18:29">2021-11-17 18:29</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="posts/pudb-remote/#org045ad11">In the Beginning</a></li>
<li><a href="posts/pudb-remote/#org4d8cb6a">Short Version</a></li>
<li><a href="posts/pudb-remote/#org0703d20">Okay, So Now Why Would You Do This?</a></li>
<li><a href="posts/pudb-remote/#org4bf7248">Dead Ends</a>
<ul>
<li><a href="posts/pudb-remote/#orgcdef4e4">Another Screen</a></li>
<li><a href="posts/pudb-remote/#orgb8aa7f2"><code>term_size</code></a></li>
</ul>
</li>
<li><a href="posts/pudb-remote/#orgaa02e07">Telnet</a></li>
<li><a href="posts/pudb-remote/#orgeaf4ba5">But It's Not Fixed?</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org045ad11">
<h2 id="org045ad11">In the Beginning</h2>
<div class="outline-text-2" id="text-org045ad11">
<p>This is a post on using <a href="https://documen.tician.de/pudb/index.html">PuDB</a> via telnet.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org4d8cb6a">
<h2 id="org4d8cb6a">Short Version</h2>
<div class="outline-text-2" id="text-org4d8cb6a">
<p>In case I forgot what to do and just want to read this to remember.</p>
<ol class="org-ol">
<li>In the screen where you are going to run telnet, run <code>tput cols</code> and <code>tput lines</code> to find out the number of columns and lines that the screen is using.</li>
<li>In the code where you want the break, instead of the usual <code>import pudb; pudb.set_trace()</code> use:</li>
</ol>
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">pudb.remote</span> <span class="kn">import</span> <span class="n">set_trace</span>
<span class="n">set_trace</span><span class="p">(</span><span class="n">term_size</span><span class="o">=</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">lines</span><span class="p">))</span>
</pre></div>
<p>When the code hits the breakpoint it will start up a telnet service and you can log into it from the other screen:</p>
<div class="highlight">
<pre><span></span>telnet 127.0.0.1 6899
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org0703d20">
<h2 id="org0703d20">Okay, So Now Why Would You Do This?</h2>
<div class="outline-text-2" id="text-org0703d20">
<p>I was trying to build one of my sites that uses <a href="https://nikola.readthedocs.io/en/latest/">nikola</a> and this strange error came out saying that one of the shortcodes was getting the "site" argument multiple times. I had no idea what was going on and nikola doesn't pre-define the arguments to the shortcode-plugins (it parses the text and then passes the arguments along using the <code>*args</code> <code>**kwargs</code> convention) which makes it flexible, but figuring out a problem with the arguments is pretty tough, so I decided to turn to my old standby <code>PuDB</code>, which I've been using for so many years now, and is my favorite of the python debuggers I've tried.</p>
<p>I did my usual thing and found the line in the <code>nikola</code> code that was raising the error and inserted a breakpoint further up in the code.</p>
<div class="highlight">
<pre><span></span><span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">"lancelot"</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pudb</span>
    <span class="n">pudb</span><span class="o">.</span><span class="n">set_trace</span><span class="p">()</span>
</pre></div>
<p>I figured the problem was with my shortcode, named <code>lancelot</code>, and the conditional allowed me to skip all the other shortcodes being used. But then, when I ran the build (<code>nikola build -v2</code>)… disaster.</p>
<p><img alt="nil" src="posts/pudb-remote/pudb-broken.png"></p>
<p>For some reason it wouldn't use the entire screen, making it impossible (or at least really hard) to read some of the variables that I wanted to check - and even worse, when I tried to open up the ipython terminal in it I got an error message.</p>
<p><img alt="nil" src="posts/pudb-remote/pudb-ui-exception.png"></p>
<p>The error-message is one of those error-after-the-error messages that you sometimes run into. It was trying to notify me of an error by popping up some kind of dialog but then the dialog wouldn't open so it told me about the dialog error and didn't get around to telling me what the original error was. In any case, something was broken, so I had to resort to desperate measures - I went to read the documentation.</p>
<p>Surprisingly, <a href="https://documen.tician.de/pudb/index.html">there actually is some</a> (there wasn't really much when I first started using it).</p>
</div>
</div>
<div class="outline-2" id="outline-container-org4bf7248">
<h2 id="org4bf7248">Dead Ends</h2>
<div class="outline-text-2" id="text-org4bf7248">
<p>The first couple of things I tried seemed promising, but they didn't work.</p>
</div>
<div class="outline-3" id="outline-container-orgcdef4e4">
<h3 id="orgcdef4e4">Another Screen</h3>
<div class="outline-text-3" id="text-orgcdef4e4">
<p>There wasn't anything about re-sizing the window, but it did mention that you can have the output come out in a different terminal from the one where you run the code, so I gave it a go. I made a different screen and got its file-path using the <code>tty</code> command (<code>/dev/pts/6</code> in this case). Then I set an environment variable to hold the file-path in the screen where I was running the code (<code>set -x PUDB_TTY /dev/pts/6</code>). This caused <code>PuDB</code> to pipe the output to the next screen - and it <i>did</i> work to send the first PuDB output to the other screen, and it <i>did</i> use the whole window, but then it quit instead of letting me use the debugger. Not <i>quite</i> what I wanted, so I unset the environment variable and moved on.</p>
</div>
</div>
<div class="outline-3" id="outline-container-orgb8aa7f2">
<h3 id="orgb8aa7f2"><code>term_size</code></h3>
<div class="outline-text-3" id="text-orgb8aa7f2">
<p>The documentation also showed how to use <code>PuDB</code> as a remote debugger, and in the example they passed in the argument <code>term_size</code> to <code>set_trace</code> so I thought, since the functions have the same name, that the <code>set_trace</code> I was using would take the same arguments. So I tried it.</p>
<div class="highlight">
<pre><span></span><span class="kn">import</span> <span class="nn">pudb</span>
<span class="n">pudb</span><span class="o">.</span><span class="n">set_trace</span><span class="p">(</span><span class="n">term_size</span><span class="o">=</span><span class="p">(</span><span class="mi">236</span><span class="p">,</span> <span class="mi">61</span><span class="p">))</span>
</pre></div>
<p>Using the values that I had gotten from <a href="https://linux.die.net/man/1/tput">tput</a> using <code>tput cols</code> and <code>tput lines</code>. But that just raised an <code>ArgumentError</code>. The functions have the same name, but not the same arguments.</p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgaa02e07">
<h2 id="orgaa02e07">Telnet</h2>
<div class="outline-text-2" id="text-orgaa02e07">
<p>So then I decided to try their remote version. It doesn't really make sense to me that it would work better than the regular version, but I didn't see any other choice. So instead of the usual code to insert a breakpoint I used:</p>
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">pudb.remote</span> <span class="kn">import</span> <span class="n">set_trace</span>
<span class="n">set_trace</span><span class="p">(</span><span class="n">term_size</span><span class="o">=</span><span class="p">(</span><span class="mi">236</span><span class="p">,</span> <span class="mi">61</span><span class="p">))</span>
</pre></div>
<p>When I ran the build it stopped and told me to telnet into the localhost address at port 6899.</p>
<p><img alt="nil" src="posts/pudb-remote/please-telnet.png"></p>
<p>So I changed into the other screen and ran telnet.</p>
<div class="highlight">
<pre><span></span>telnet 127.0.0.1 6899
</pre></div>
<p>And what do you know.</p>
<p><img alt="nil" src="posts/pudb-remote/pudb-fixed.png"></p>
<p>This turns out to not be a complete fix. Hitting <code>!</code> to get to the <code>ipython</code> terminal froze <code>PuDB</code>, but this was enough for me to inspect the variables and realize that I just needed to move one of the parameters in the definition of my shortcode method and it worked.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgeaf4ba5">
<h2 id="orgeaf4ba5">But It's Not Fixed?</h2>
<div class="outline-text-2" id="text-orgeaf4ba5">
<p>Well, if this were a more intense debug I really would want the <code>ipython~/~ptipython</code> terminal, but since this is the first time I've tried to run <code>PuDB</code> under <code>KUbuntu's</code> <code>Konsole</code> instead of the <code>GNOME</code> terminal I'm hoping that just switching back to the other terminal will be enough - I'll have to test that once I'm more motivated.</p>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/emacs-artifact-on-kubuntu/">Emacs Scrollbar Artifact on Kubuntu</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/emacs-artifact-on-kubuntu/" rel="bookmark"><time class="published dt-published" datetime="2021-10-03T13:58:02-07:00" itemprop="datePublished" title="2021-10-03 13:58">2021-10-03 13:58</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="posts/emacs-artifact-on-kubuntu/#org7dd5f43">What's this then?</a></li>
<li><a href="posts/emacs-artifact-on-kubuntu/#orge7eae49">The Cause</a></li>
<li><a href="posts/emacs-artifact-on-kubuntu/#org4a5eafa">The Fix</a></li>
<li><a href="posts/emacs-artifact-on-kubuntu/#org8d08c14">The Source</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org7dd5f43">
<h2 id="org7dd5f43">What's this then?</h2>
<div class="outline-text-2" id="text-org7dd5f43">
<p>I switch back and forth between Kubuntu and Ubuntu (Ubuntu seems to work better, but I like the aesthetics of Kubuntu) and one of the problems I had was that when I launched emacs in Kubuntu it had a permanent scrollbar in the center of the window that blocked out whatever text was there.</p>
<p><img alt="nil" src="posts/emacs-artifact-on-kubuntu/emacs-scrol-artifact.png"></p>
<p>It's more of an annoyance than anything else but since it doesn't happen on Ubuntu I figured I'd try and fix it. It took me a couple of different searches to find the answer so I thought I'd document it in case I need to remember this later.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orge7eae49">
<h2 id="orge7eae49">The Cause</h2>
<div class="outline-text-2" id="text-orge7eae49">
<p>This is the desktop that's causing the problem:</p>
<p><img alt="nil" src="posts/emacs-artifact-on-kubuntu/kubuntu-version.png"></p>
<p>It turns out that it's because my monitors are of different resolutions and in order to be able to read anything on the higher-resolution monitor I had to set the display scale to 200%, but this causes a problem with the scaling of the widgets (at least that's what it said on the <a href="https://www.reddit.com/r/emacs/comments/am64y8/bug_with_scrollbar_on_ubuntu_1804/">reddit</a> post where I found the solution).</p>
</div>
</div>
<div class="outline-2" id="outline-container-org4a5eafa">
<h2 id="org4a5eafa">The Fix</h2>
<div class="outline-text-2" id="text-org4a5eafa">
<p>The fix for me was to edit the <code>~/.local/share/applications/emacs.desktop</code> file so that the EXEC line read:</p>
<pre class="example" id="orgae1defd">
Exec= /usr/bin/env GDK_SCALE= emacs
</pre>
<p>Once this was in place the artifact went away.</p>
<p><img alt="nil" src="posts/emacs-artifact-on-kubuntu/emacs-no-artifact.png"></p>
</div>
</div>
<div class="outline-2" id="outline-container-org8d08c14">
<h2 id="org8d08c14">The Source</h2>
<div class="outline-text-2" id="text-org8d08c14">
<p>I linked to it above, but this is the reddit post where I found the fix:</p>
<ul class="org-ul">
<li><a href="https://www.reddit.com/r/emacs/comments/am64y8/bug_with_scrollbar_on_ubuntu_1804/">https://www.reddit.com/r/emacs/comments/am64y8/bug_with_scrollbar_on_ubuntu_1804/</a></li>
</ul>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/building-fastais-documentation/">Building fastai's Documentation</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/building-fastais-documentation/" rel="bookmark"><time class="published dt-published" datetime="2021-05-29T12:31:38-07:00" itemprop="datePublished" title="2021-05-29 12:31">2021-05-29 12:31</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="posts/building-fastais-documentation/#org9491473">What is this about?</a></li>
<li><a href="posts/building-fastais-documentation/#org44a5f20">What happened?</a>
<ul>
<li><a href="posts/building-fastais-documentation/#orgc7dae8c">The Repository</a></li>
<li><a href="posts/building-fastais-documentation/#orgd6a2e7e">Jekyll and Hide</a>
<ul>
<li><a href="posts/building-fastais-documentation/#org6508db0">All You Need</a></li>
</ul>
</li>
<li><a href="posts/building-fastais-documentation/#orgf8ec69a">Fixing the Imports</a>
<ul>
<li><a href="posts/building-fastais-documentation/#org4f1e46b">Installing fastai</a></li>
<li><a href="posts/building-fastais-documentation/#orgaee2852">Installing Flask Compress</a></li>
<li><a href="posts/building-fastais-documentation/#orgb65dbb9">Install Azureml-core</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="posts/building-fastais-documentation/#org05a639f">In A Nutshell</a>
<ul>
<li>
<ul>
<li><a href="posts/building-fastais-documentation/#org1152441">The Minimum to Get the Documentation</a></li>
<li><a href="posts/building-fastais-documentation/#orga6b4260">To Fix All the Errors</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org9491473">
<h2 id="org9491473">What is this about?</h2>
<div class="outline-text-2" id="text-org9491473">
<p>I've decided to try and build as much of the documentation that I use all the time on my local system, not just so that I'll have it if my internet connection goes down but also so that I won't be distracted by what's happening on the web. This is about building <a href="https://docs.fast.ai/">fastai's documentation</a>, which was a little trickier than I thought it would be so I decided it would be worth it to make a note for the future.</p>
<p>You can skip to the <a href="posts/building-fastais-documentation/#org05a639f">In A Nutshell</a> section of the post to get a summary of the steps without all the exposition that the middle section has.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org44a5f20">
<h2 id="org44a5f20">What happened?</h2>
<div class="outline-text-2" id="text-org44a5f20"></div>
<div class="outline-3" id="outline-container-orgc7dae8c">
<h3 id="orgc7dae8c">The Repository</h3>
<div class="outline-text-3" id="text-orgc7dae8c">
<p>The first thing I did was clone the <a href="https://github.com/fastai/fastai">fastai git repository</a> from github. If you inspect it there's a folder called <code>docs_src</code> which seemed to logically mean that that's where the source files for the documentation are but when you go in there you won't find an <code>index.html</code> file, which seemed peculiar. There's a <code>Makefile</code> at the root of the repository so I inspected it and found that there's a rule:</p>
<pre class="example" id="org4772c87">
docs: $(SRC)
        rsync -a docs_src/ docs
        nbdev_build_docs
</pre>
<p>So I tried a naive <code>make docs</code> but of course it failed because there's nothing called <code>nbdev_build_docs</code>, so I searched online and found out that <a href="https://nbdev.fast.ai/">nbdev</a> is a fastai project to make jupyter notebooks into a <a href="https://www.wikiwand.com/en/Literate_programming">Literate Programming</a> system and that <code>nbdev_build_docs</code> is one of their command-line commands, so I installed it through pip:</p>
<pre class="example" id="orge2bbb3f">
pip install nbdev
</pre>
<p>And re-ran the make command, which did nothing because the <code>rsync</code> command had already created the <code>docs</code> folder and for some reason this made the <code>nbdev_build_docs</code> command not work. So I removed the <code>docs</code> folder and re-ran it, which produced a big dump of errors because in converting the notebooks <code>nbdev</code> was importing a bunch of python code that wasn't installed. Interestingly, at this point the <code>docs</code> folder actually has enough to run the site, despite all the error-messages, but if you just try to load the files into a browser you can see that it's kind of broken, so then I went looking for what was going on.</p>
</div>
</div>
<div class="outline-3" id="outline-container-orgd6a2e7e">
<h3 id="orgd6a2e7e">Jekyll and Hide</h3>
<div class="outline-text-3" id="text-orgd6a2e7e">
<p>For some reason I couldn't find anything in the documentation on building it, but searching for <i>"fastai build documentation"</i> brought an <a href="https://fastai1.fast.ai/gen_doc_main.html">outdated page</a> that tells you how to build the documentation but was written for the prior version of fastai (v1) so much of it doesn't make sense for v2 (e.g. it refers to a non-existent <code>tools</code> folder), which I didn't figure out at first because the sites for v1 and v2 don't really identify their version, except in the URL for the old site.</p>
</div>
<div class="outline-4" id="outline-container-org6508db0">
<h4 id="org6508db0">All You Need</h4>
<div class="outline-text-4" id="text-org6508db0">
<p>Reading that documentation it turns out that they're using <a href="https://jekyllrb.com/">Jekyll</a>, so if you <a href="https://jekyllrb.com/docs/installation/">install it</a> you just need to run Jekyll in the <code>docs</code> folder.</p>
<pre class="example" id="org207e2bc">
cd docs
bundle exec jekyll serve
</pre>
<p>And the site is ready to read at <code>http://localhost:4000</code> and at this point you're good to go - but, of course, I didn't realize that and tried to fix the error messages first, which is what the rest of this post is about.</p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgf8ec69a">
<h3 id="orgf8ec69a">Fixing the Imports</h3>
<div class="outline-text-3" id="text-orgf8ec69a">
<p>There's three things you need to do to fix the imports:</p>
<ul class="org-ul">
<li>install fastai and any dependencies</li>
<li>install <a href="https://github.com/colour-science/flask-compress"><code>flask_compress</code></a></li>
<li>install <a href="https://github.com/Azure/azure-sdk-for-python"><code>azureml-core</code></a></li>
</ul>
</div>
<div class="outline-4" id="outline-container-org4f1e46b">
<h4 id="org4f1e46b">Installing fastai</h4>
<div class="outline-text-4" id="text-org4f1e46b">
<p><a href="https://fastai1.fast.ai/gen_doc_main.html#step-2-setup">The old documentation</a> recommended installing it in development mode. I don't know if that's strictly necessary, but it fixed a lot of things so it seems like a good idea.</p>
<p>In the root of the fastai repository run pip.</p>
<pre class="example" id="org901a8e7">
pip install -e ".[dev]"
</pre>
<p>This installs a lot of stuff so you might want to go get a cup of coffee (or maybe a cocktail) at this point while it does its thing. The <code>settings.ini</code> file lists the <code>dev_requirements</code> and the regular requirements if you want to see what needs to be installed in either case.</p>
</div>
</div>
<div class="outline-4" id="outline-container-orgaee2852">
<h4 id="orgaee2852">Installing Flask Compress</h4>
<div class="outline-text-4" id="text-orgaee2852">
<p>This is pretty straight-forward, just use pip.</p>
<pre class="example" id="org96bf8fc">
pip install flask-compress
</pre></div>
</div>
<div class="outline-4" id="outline-container-orgb65dbb9">
<h4 id="orgb65dbb9">Install Azureml-core</h4>
<div class="outline-text-4" id="text-orgb65dbb9"></div>
<ul class="org-ul">
<li><a id="org7988ccb"></a>The Problem<br>
<div class="outline-text-5" id="text-org7988ccb">
<p>This wasn't quite so straight-forward, which is why I put it in a separate section. If you try to install it in Ubuntu 21.04 (or 20.04, etc.) you will get a big blob of error messages ending in this.</p>
<pre class="example" id="org5ec37ab">
ERROR: Command errored out with exit status 1: /home/hades/.virtualenvs/fastai-clean/bin/python -u -c 'import io, os, sys, setuptools, tokenize; sys.argv[0] = '"'"'/tmp/pip-install-srnkqokl/ruamel-yaml_803314568
e8f4fa49015a45528d277b2/setup.py'"'"'; __file__='"'"'/tmp/pip-install-srnkqokl/ruamel-yaml_803314568e8f4fa49015a45528d277b2/setup.py'"'"';f = getattr(tokenize, '"'"'open'"'"', open)(__file__) if os.path.exists(_
_file__) else io.StringIO('"'"'from setuptools import setup; setup()'"'"');code = f.read().replace('"'"'\r\n'"'"', '"'"'\n'"'"');f.close();exec(compile(code, __file__, '"'"'exec'"'"'))' install --record /tmp/pip
-record-yfvqflby/install-record.txt --single-version-externally-managed --compile --install-headers /home/hades/.virtualenvs/fastai-clean/include/site/python3.9/ruamel.yaml Check the logs for full command output
</pre>
<p>Which isn't really all that helpful. Scrolling up, it looks like the problem was with something called <a href="https://yaml.readthedocs.io/en/latest/">ruamel.yaml</a>, so investigating this seemed like a place to start, but, of course, the error messages are completely inscrutable now that I haven't programmed in C for so many years so I decided to search the web instead of trying to debug it directly, figuring that someone else must have had this problem.</p>
<p>This lead to a long search through various posts, but what it turned out to be was that both ruamel.yaml and azureml-core don't support python 3.9 yet (there are some <a href="https://github.com/Azure/MachineLearningNotebooks/issues?q=is%3Aissue+is%3Aopen+3.9">bug reports on GitHub</a> for it already) so you can't install it with the version that currently ships with Ubuntu (3.9.5) or anything above python 3.8.</p>
</div>
</li>
<li><a id="org2119dda"></a>The Fix<br>
<div class="outline-text-5" id="text-org2119dda">
<p>The fix I decided to use was to install <a href="https://github.com/pyenv/pyenv">pyenv</a> using their <a href="https://github.com/pyenv/pyenv-installer">installer</a>. Once you run the installer and follow the rest of their <a href="https://github.com/pyenv/pyenv#installation">installation instructiors</a> it's fairly straightforward to set up so I won't go into it.</p>
<p>I decided to use python 3.8.10 so to install it you do this:</p>
<pre class="example" id="org6a9fb3d">
pyenv install 3.8.10
</pre>
<p>The only thing that didn't work for me was their <code>pyenv which</code> function which is supposed to show you the location of the python installation. The command might work but I couldn't figure out the arguments to use (updating the example they gave didn't work for me). It turned out the python binary was at:</p>
<pre class="example" id="org159973f">
~/.pyenv/versions/3.8.10/bin/python
</pre>
<p>pyenv has it's own system for creating a virtual environment, but since I'm already using virtualfish and didn't want to try and troubleshoot yet another method I created a virtual environment the way I usually do it.</p>
<pre class="example" id="orgbbf6891">
~/.pyenv/versions/3.8.10/bin/python -m venv fastai-doc
</pre>
<p>At this point I activated the new virtual environment and had to re-do previous installation steps (for <code>fastai</code> and <code>flask_compress</code>) as well as the azure-ml installation.</p>
<pre class="example" id="orga6a7329">
pip install -e ".[dev]"
pip install flask-compress azureml-core
</pre>
<p>The installation of fastai installs <code>nbdev</code> as one of the requirements so that didn't have to be re-done. And now I built the documentation and ran the jekyll server. Easy-peasy.</p>
<pre class="example" id="orgfceb95e">
make docs
cd docs
bundle exec jekyll serve
</pre></div>
</li>
</ul>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org05a639f">
<h2 id="org05a639f">In A Nutshell</h2>
<div class="outline-text-2" id="text-org05a639f"></div>
<div class="outline-4" id="outline-container-org1152441">
<h4 id="org1152441">The Minimum to Get the Documentation</h4>
<div class="outline-text-4" id="text-org1152441">
<ul class="org-ul">
<li>Clone the <a href="https://github.com/fastai/fastai">fastai git repository</a> from github</li>
<li>Install <a href="https://jekyllrb.com/">jekyll</a> and <a href="https://nbdev.fast.ai/">nbdev</a></li>
<li>Change into the root of the fastai repository you cloned</li>
<li>Run <code>make docs</code> and ignore the error-messages</li>
<li>Change into the <code>docs</code> folder that was created and run the jekyll server (<code>bundle exec jekyll serve</code>)</li>
</ul>
</div>
</div>
<div class="outline-4" id="outline-container-orga6b4260">
<h4 id="orga6b4260">To Fix All the Errors</h4>
<div class="outline-text-4" id="text-orga6b4260">
<p>This isn't really necessary to get the documentation, but I think it's better, since you don't have to ignore all the error messages.</p>
<ul class="org-ul">
<li>Clone the <a href="https://github.com/fastai/fastai">fastai git repository</a> from github</li>
<li>Install <a href="https://jekyllrb.com/">jekyll</a></li>
<li>Get python 3.8 working (I used pyenv)</li>
<li>Use pip to install fastai in development mode</li>
<li>Use pip to install <code>flask_compress</code> and <code>azureml-core</code></li>
<li>Change into the root of the fastai repository you cloned</li>
<li>Run <code>make docs</code></li>
<li>Change into the <code>docs</code> folder that was created and run the jekyll server (<code>bundle exec jekyll serve</code>)</li>
</ul>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/coding-strip/">Coding Strip</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/coding-strip/" rel="bookmark"><time class="published dt-published" datetime="2021-01-27T16:46:53-08:00" itemprop="datePublished" title="2021-01-27 16:46">2021-01-27 16:46</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div class="outline-2" id="outline-container-org0b674d6">
<h2 id="org0b674d6">Abstract</h2>
<div class="outline-text-2" id="text-org0b674d6">
<p>Programming is difficult for some people to learn because the concepts are abstract and while there have been efforts to make them more concrete, efforts that focused either on telling stories (e.g. picture books and adventure comics) or transforming the code into something more tangible (e.g. manipulating physical blocks or using graphic representations to create programs) but these prior works didn't make the step from the concrete systems they created to actual code so this team created and tested a system (Coding Strips) to develop comics that could be directly tied to real code.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org77db82e">
<h2 id="org77db82e">Cite</h2>
<div class="outline-text-2" id="text-org77db82e">
<ul class="org-ul">
<li>Suh S, Lee M, Xia G. Coding strip: A pedagogical tool for teaching and learning programming concepts through comics. In2020 IEEE Symposium on Visual Languages and Human-Centric Computing (VL/HCC) 2020 Aug 10 (pp. 1-10). IEEE.</li>
</ul>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/coding-comics-recursion/">Coding Comics: Recursion</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author"><a href="authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="posts/coding-comics-recursion/" rel="bookmark"><time class="published dt-published" datetime="2021-01-27T15:59:39-08:00" itemprop="datePublished" title="2021-01-27 15:59">2021-01-27 15:59</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="posts/coding-comics-recursion/#orgc1fc527">What Is This?</a></li>
<li><a href="posts/coding-comics-recursion/#orgd895bf7">The Comic</a></li>
<li><a href="posts/coding-comics-recursion/#org70129f3">In English-Ish</a>
<ul>
<li><a href="posts/coding-comics-recursion/#orgaa67ef2">Forward</a></li>
<li><a href="posts/coding-comics-recursion/#orgb53929d">Base Case</a></li>
<li><a href="posts/coding-comics-recursion/#org49adc22">Backwards</a></li>
</ul>
</li>
<li><a href="posts/coding-comics-recursion/#org902e7c7">The Code</a>
<ul>
<li><a href="posts/coding-comics-recursion/#org8de4ec2">A Person</a></li>
<li><a href="posts/coding-comics-recursion/#org2c36412">The Recursion</a></li>
<li><a href="posts/coding-comics-recursion/#orgfdded43">Check If It Works</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgc1fc527">
<h2 id="orgc1fc527">What Is This?</h2>
<div class="outline-text-2" id="text-orgc1fc527">
<p>This is a re-working of the <a href="posts/coding-strip/">Coding Strip</a> Recursion example. Not because I can do it better, but because I've never done one before so stealing their idea seems like an easier way to start. In the original they had a comic showing a character who wants to buy a ticket but there's a long line so she asks the person in front of her how many people are in front of him, and he asks the person in front of him, and so on. They then followed up the comics with some code that translated the comic to a concrete function.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgd895bf7">
<h2 id="orgd895bf7">The Comic</h2>
<div class="outline-text-2" id="text-orgd895bf7">
<p>(Coming Soon)</p>
</div>
</div>
<div class="outline-2" id="outline-container-org70129f3">
<h2 id="org70129f3">In English-Ish</h2>
<div class="outline-text-2" id="text-org70129f3"></div>
<div class="outline-3" id="outline-container-orgaa67ef2">
<h3 id="orgaa67ef2">Forward</h3>
<div class="outline-text-3" id="text-orgaa67ef2">
<p>To find the length of the line, each person asks the person in front how many people are in front of them.</p>
</div>
</div>
<div class="outline-3" id="outline-container-orgb53929d">
<h3 id="orgb53929d">Base Case</h3>
<div class="outline-text-3" id="text-orgb53929d">
<p>When the person at the front of the line is reached, he reports that there's no one in front of him (zero).</p>
</div>
</div>
<div class="outline-3" id="outline-container-org49adc22">
<h3 id="org49adc22">Backwards</h3>
<div class="outline-text-3" id="text-org49adc22">
<p>Once the front of the line is reached, each person then relays back how many people the person in front reports and adds one to include the person who reported the count until the back of the line is reached.</p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org902e7c7">
<h2 id="org902e7c7">The Code</h2>
<div class="outline-text-2" id="text-org902e7c7">
<p>Here's some code to illustrate the idea of asking the person in front of you how many people are in front of them and having that question propagate forward and then have the answer propagate back.</p>
</div>
<div class="outline-3" id="outline-container-org8de4ec2">
<h3 id="org8de4ec2">A Person</h3>
<div class="outline-text-3" id="text-org8de4ec2">
<p>I originally thought of using a list, but then you'd have to criple the length method… so I'm making a linked list of a sorts, where each person knows the person in front of them.</p>
<div class="highlight">
<pre><span></span><span class="k">class</span> <span class="nc">Person</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""A person in line</span>
<span class="sd">    """</span>
    <span class="n">person_in_front</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org2c36412">
<h3 id="org2c36412">The Recursion</h3>
<div class="outline-text-3" id="text-org2c36412">
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">hey_fella_how_many_people_are_in_front_of_me</span><span class="p">(</span><span class="n">fella</span><span class="p">:</span> <span class="n">Person</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Finds out how many people are in front of current person</span>

<span class="sd">    Args:</span>
<span class="sd">     fella: the current person being asked</span>

<span class="sd">    Returns:</span>
<span class="sd">     Number of people in front (including last person)</span>
<span class="sd">    """</span>
    <span class="n">COUNT_THIS_FELLA</span> <span class="o">=</span> <span class="mi">1</span>    
    <span class="k">if</span> <span class="n">fella</span><span class="o">.</span><span class="n">person_in_front</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">COUNT_THIS_FELLA</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">hey_fella_how_many_people_are_in_front_of_me</span><span class="p">(</span><span class="n">fella</span><span class="o">.</span><span class="n">person_in_front</span><span class="p">)</span>
            <span class="o">+</span> <span class="n">COUNT_THIS_FELLA</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgfdded43">
<h3 id="orgfdded43">Check If It Works</h3>
<div class="outline-text-3" id="text-orgfdded43">
<p>Now I'll create a line of unknown length so we can check it.</p>
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="n">ascii_letters</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="n">waiting</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">line_of_people</span><span class="p">(</span><span class="n">people</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Person</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Builds the lengthless line</span>

<span class="sd">    Args:</span>
<span class="sd">     people: how many people to queue up</span>

<span class="sd">    Returns:</span>
<span class="sd">     line of people</span>
<span class="sd">    """</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">this_person</span> <span class="o">=</span> <span class="n">Person</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">waiting</span><span class="p">):</span>
        <span class="n">this_person</span><span class="o">.</span><span class="n">person_in_front</span> <span class="o">=</span> <span class="n">Person</span><span class="p">()</span>
        <span class="n">this_person</span> <span class="o">=</span> <span class="n">this_person</span><span class="o">.</span><span class="n">person_in_front</span>
    <span class="k">return</span> <span class="n">line</span>

<span class="n">in_line</span> <span class="o">=</span> <span class="n">line_of_people</span><span class="p">(</span><span class="n">waiting</span><span class="p">)</span>
</pre></div>
<p>So at this point we have a line of people of unknown length. Each person only knows the existence of the person in front of them so there's no way to get the length of the line directly, but we can use the recursive function to find out how many people there are.</p>
<div class="highlight">
<pre><span></span><span class="n">reported</span> <span class="o">=</span> <span class="n">hey_fella_how_many_people_are_in_front_of_me</span><span class="p">(</span><span class="n">in_line</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected: </span><span class="si">{</span><span class="n">waiting</span><span class="si">}</span><span class="s2">, Actual: </span><span class="si">{</span><span class="n">reported</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">waiting</span> <span class="o">==</span> <span class="n">reported</span>
</pre></div>
<pre class="example">
Expected: 539, Actual: 539
</pre>
<p>Seems to be working.</p>
</div>
</div>
</div>
</div>
</article>
</div>
<ul class="pager postindexpager clearfix">
<li class="previous"><a href="index-21.html" rel="prev">Newer posts</a></li>
<li class="next"><a href="index-19.html" rel="next">Older posts</a></li>
</ul>
<!--End of body content-->
<footer id="footer">Scribbled by the <a href="mailto:cloisteredmonkey.jmark@slmail.me">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a>
<div id="license" xmlns:cc="http://creativecommons.org/ns#">This work is licensed under <a href="http://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" rel="license noopener noreferrer" style="display:inline-block;" target="_blank">CC BY 4.0 <img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"></a></div>
</footer>
</div>
</div>
<script src="assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script>
</body>
</html>
