<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Ubuntu 23.04 (Lunar Lobster) kernel panic." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Kernel Panic At the Lunar Lobster | The Cloistered Monkey</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/posts/kernel-panic-at-the-lunar-lobster/" rel="canonical"><!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]-->
<link href="../../apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="../../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../../site.webmanifest" rel="manifest">
<meta content="Cloistered Monkey" name="author">
<link href="../converting-a-date-to-day-of-the-year-in-python/" rel="prev" title="Converting A Date To Day of the Year In Python" type="text/html">
<link href="../python-311-and-emacs-jupyter-symbols-variable-is-void-error/" rel="next" title="Ubuntu 22.04, Python 3.11 and the &quot;emacs-jupyter Symbol's variable is void&quot; Error" type="text/html">
<meta content="The Cloistered Monkey" property="og:site_name">
<meta content="Kernel Panic At the Lunar Lobster" property="og:title">
<meta content="https://necromuralist.github.io/posts/kernel-panic-at-the-lunar-lobster/" property="og:url">
<meta content="Ubuntu 23.04 (Lunar Lobster) kernel panic." property="og:description">
<meta content="article" property="og:type">
<meta content="2023-05-03T16:20:07-07:00" property="article:published_time">
<meta content="nvidia" property="article:tag">
<meta content="ubuntu" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="../../"><span id="blog-title">The Cloistered Monkey</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="../../pages/">Pages</a></li>
<li class="nav-item"><a class="nav-link" href="../../archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="../../categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="../../rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Projects</a>
<div class="dropdown-menu"><a class="dropdown-item" href="https://necromuralist.github.io/Ape-Iron/">Ape Iron</a> <a class="dropdown-item" href="https://necromuralist.github.io/Beach-Pig-Thigh/">Beach Pig Thigh & Rump</a> <a class="dropdown-item" href="https://necromuralist.github.io/Bowling-For-Data/">Bowling For Data</a> <a class="dropdown-item" href="https://necromuralist.github.io/Neurotic-Networking/">Neurotic Networking</a> <a class="dropdown-item" href="https://necromuralist.github.io/Visions-Voices-Data/">Visions, Voices, Data</a></div>
</li>
</ul>
<!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Search" type="text"></div>
<!-- 
<button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-search"></span>
</button>
-->
<input name="sitesearch" type="hidden" value="https://necromuralist.github.io/"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href=".">Kernel Panic At the Lunar Lobster</a></h1>
<div class="metadata">
<p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author"><a class="u-url" href="../../authors/cloistered-monkey/">Cloistered Monkey</a></span></p>
<p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2023-05-03T16:20:07-07:00" itemprop="datePublished" title="2023-05-03 16:20">2023-05-03 16:20</time></a></p>
<p class="sourceline"><a class="sourcelink" href="index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org6ff5e6c">What Is This About?</a></li>
<li><a href="#orgc40f585">First Get It Working</a></li>
<li><a href="#org7483335">Not a Solution But A Finger Pointing</a></li>
<li><a href="#orge0ce278">Blame It On the Drivers</a></li>
<li><a href="#org5ec4d17">From Nouveau To Nvidia</a></li>
<li><a href="#org4fd4280">And the End</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org6ff5e6c">
<h2 id="org6ff5e6c">What Is This About?</h2>
<div class="outline-text-2" id="text-org6ff5e6c">
<p>I got a notification yesterday (May 3, 2023) that there's a new version of Ubuntu out (<i>Lunar Lobster - 23.04</i>) so I ran <code>do-release-upgrade</code> while watching a video (<a href="https://en.wikipedia.org/wiki/An_Honest_Liar?useskin=vector">An Honest Liar</a>) about James Randi. At the end of the upgrade there was some kind of error message about not being able to configure the Linux headers, which in retrospect should have worried me, but I was distracted so I just dismissed it. Then today when I booted up the computer I got an error message saying <code>Kernel Panic - Not syncing: VFS: Unable to mount root fs on unknown-block (0,0)</code>. I managed to get it working (eventually) but now that Ubuntu's been around long enough and search engines seem to be choked with outdated answers I thought I'd document what I did in case it happens on another update.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgc40f585">
<h2 id="orgc40f585">First Get It Working</h2>
<div class="outline-text-2" id="text-orgc40f585">
<p>The first thing I tried was to follow the answers on <a href="https://askubuntu.com/questions/41930/kernel-panic-not-syncing-vfs-unable-to-mount-root-fs-on-unknown-block0-0">this Stackoverflow page</a>. The only thing this did was get my computer up and running again - which is, I suppose a big thing, not to be minimized, but there's a lot of stuff on that page and the only relevant parts were:</p>
<ol class="org-ol">
<li>Reboot</li>
<li>At the menu that comes up choose "Advanced Options for Ubuntu"</li>
<li>Pick a prior version of the Linux kernel (5.19.26 in my case) and let it finish starting up.</li>
</ol>
</div>
</div>
<div class="outline-2" id="outline-container-org7483335">
<h2 id="org7483335">Not a Solution But A Finger Pointing</h2>
<div class="outline-text-2" id="text-org7483335">
<p>The first thing I tried from that page was from <a href="https://askubuntu.com/a/939883">this answer</a>:</p>
<div class="highlight">
<pre><span></span>sudo dpkg --configure -a
</pre></div>
<p>This gave me <code>error processing package linux-image-6.2.0-generic (--configure)</code>. So I searched some more and tried the suggestion from <a href="https://askubuntu.com/a/517882">this askubuntu answer</a>:</p>
<div class="highlight">
<pre><span></span>sudo dpkg --purge linux-image-6.2.0-20-generic
</pre></div>
<p>This gives an error along the lines of "<code>dependency problems, not purging</code>". Oi. So then I tried:</p>
<div class="highlight">
<pre><span></span>sudo apt autoremove
</pre></div>
<p>This gave me another error:</p>
<p><img alt="Purge Error" src="purge-error.webp"></p>
<p>This time in the error message it said to check out <code>/var/lib/dkms/nvidia/510.108.03/build/make.log</code> which turned out not to have any useful information (to me, anyway) but it did tell me that there was something going on with my nvidia drivers that was causing the configuration of the new Linux kernel to fail.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orge0ce278">
<h2 id="orge0ce278">Blame It On the Drivers</h2>
<div class="outline-text-2" id="text-orge0ce278">
<p><i>"Something going on with my nvidia drivers"</i> being a little too vague for me to troubleshoot, I decided to go the brute force way and uninstall the nvidia-drivers. This actually proved a little harder than I thought it would be (which seems to always be the case, maybe I'm too optimistic about this kind of stuff). Every time I tried to run</p>
<div class="highlight">
<pre><span></span>sudo apt remove nvidia-driver-510
</pre></div>
<p><code>apt</code> would try and configure the Linux kernel and run into the same error that I had before and exit without uninstalling the driver. Some kind of chicken and the egg thing. So then I tried <code>dpkg</code> instead of <code>apt</code> first:</p>
<div class="highlight">
<pre><span></span>sudo dpkg --purge nvidia-driver-510
sudo apt autoremove
</pre></div>
<p><code>dpkg</code> managed to uninstall the driver and running <code>apt autoremove</code> not only cleaned out the unused packages but also triggered the kernel configuration and this time… no errors.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org5ec4d17">
<h2 id="org5ec4d17">From Nouveau To Nvidia</h2>
<div class="outline-text-2" id="text-org5ec4d17">
<p>After a reboot it started up okay and this time <code>uname -r</code> showed that I was using the newer kernel (<code>6.2.0-20-generic</code>). Yay. But now when I tried to re-install the nvidia drivers neither <code>ubuntu-drivers</code> nor <code>apt</code> seemed to know that they existed. It turns out that updating the ubuntu installation removes the proprietary drivers from the apt sources. So I launched the "Software & Updates" GUI.</p>
<p><img alt="Software &amp; Updates" src="software-updates.webp"></p>
<p>And checked the "Proprietary drivers for devices (restricted)" button.</p>
<p><img alt="Proprietary Drivers" src="proprietary-drivers.webp"></p>
<p>I chose to update the apt listing when I closed the GUI and then installed the drivers at the command line:</p>
<div class="highlight">
<pre><span></span>sudo ubuntu-drivers install
</pre></div>
<p>And then, after another reboot, now it works (I checked with <code>nvidia-smi</code>).</p>
</div>
</div>
<div class="outline-2" id="outline-container-org4fd4280">
<h2 id="org4fd4280">And the End</h2>
<div class="outline-text-2" id="text-org4fd4280">
<p>I haven't run any tests other than using the system but this seems to have fixed the problem. Well, the problem with the kernel, updating also broke all my python virtual environments, but, oh, well, better than a kernel panic, I suppose.</p>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="../../categories/nvidia/" rel="tag">nvidia</a></li>
<li><a class="tag p-category" href="../../categories/ubuntu/" rel="tag">ubuntu</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="../converting-a-date-to-day-of-the-year-in-python/" rel="prev" title="Converting A Date To Day of the Year In Python">Previous post</a></li>
<li class="next"><a href="../python-311-and-emacs-jupyter-symbols-variable-is-void-error/" rel="next" title="Ubuntu 22.04, Python 3.11 and the &quot;emacs-jupyter Symbol's variable is void&quot; Error">Next post</a></li>
</ul>
</nav>
</aside>
</article>
<!--End of body content-->
<footer id="footer">Contents © 2023 <a href="mailto:cloisteredmonkey.jmark@slmail.me">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="../../assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script>
</body>
</html>
