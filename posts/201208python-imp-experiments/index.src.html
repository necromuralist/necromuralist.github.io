<html><body><div class="document" id="python-imp-experiments">   <p>The importing of classes using <cite>imp</cite> was tested with:</p><pre class="code python literal-block"><br><span class="kn">from</span> <span class="nn">unittest</span> <span class="kn">import</span> <span class="n">TestCase</span><br><br><span class="kn">import</span> <span class="nn">os</span><br><span class="kn">import</span> <span class="nn">imp</span><br><span class="kn">import</span> <span class="nn">importer</span><br><br><span class="k">class</span> <span class="nc">TestSource</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span><br>    <span class="k">def</span> <span class="nf">test_import</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span><br>        <span class="sd">"""<br>        module `source` contains class `SourceCase` with attribute cow set to 'pie'<br>        """</span><br>        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span><br>        <span class="n">f</span><span class="p">,</span> <span class="n">package</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">find_module</span><span class="p">(</span><span class="s">"source"</span><span class="p">,</span> <span class="p">[</span><span class="n">path</span><span class="p">])</span><br>        <span class="n">source</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">load_module</span><span class="p">(</span><span class="s">'source'</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">package</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span><br>        <span class="n">SourceCase</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="s">"SourceCase"</span><span class="p">)</span><br>        <span class="n">case_o</span> <span class="o">=</span> <span class="n">SourceCase</span><span class="p">()</span><br>        <span class="n">expected</span> <span class="o">=</span> <span class="n">importer</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">SourceCase</span><span class="p">()</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expected</span><span class="o">.</span><span class="n">cow</span><span class="p">,</span> <span class="n">case_o</span><span class="o">.</span><span class="n">cow</span><span class="p">)</span><br><br>        <span class="c"># this won't work - using imp gets source.SourceCase, but import gets importer.source.SourceCase</span><br>        <span class="c">#self.assertIsInstance(case_o, source.SourceCase)</span><br>        <span class="k">return</span><br><br>    <span class="k">def</span> <span class="nf">test_subdirectory_import</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span><br>        <span class="sd">"""<br>        module `subsource` contains a class Subsource with attribute `apropos` set to 'nothing'<br>        """</span><br>        <span class="n">top</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span><br>        <span class="n">f</span><span class="p">,</span> <span class="n">package_path</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">find_module</span><span class="p">(</span><span class="s">"subdir"</span><span class="p">,</span> <span class="p">[</span><span class="n">top</span><span class="p">])</span><br>        <span class="n">f</span><span class="p">,</span> <span class="n">mod_path</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">find_module</span><span class="p">(</span><span class="s">'subsource'</span><span class="p">,</span> <span class="p">[</span><span class="n">package_path</span><span class="p">])</span><br>        <span class="n">subsource</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">load_module</span><span class="p">(</span><span class="s">'subdir.subsource'</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">mod_path</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span><br>        <span class="n">Subsource</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">subsource</span><span class="p">,</span> <span class="s">"Subsource"</span><span class="p">)</span><br>        <span class="n">source_obj</span> <span class="o">=</span> <span class="n">Subsource</span><span class="p">()</span><br>        <span class="n">expected</span> <span class="o">=</span> <span class="n">importer</span><span class="o">.</span><span class="n">subdir</span><span class="o">.</span><span class="n">subsource</span><span class="o">.</span><span class="n">Subsource</span><span class="p">()</span><br>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expected</span><span class="o">.</span><span class="n">apropos</span><span class="p">,</span> <span class="n">source_obj</span><span class="o">.</span><span class="n">apropos</span><span class="p">)</span><br>        <span class="k">return</span><br><span class="c"># end class TestSource</span><br></pre></div></body></html>